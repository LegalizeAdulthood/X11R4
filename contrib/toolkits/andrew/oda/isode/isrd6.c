/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISRD6 */
# line 5 "isrd6.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */

#define TK_TKI_TKERR
#define TK_TKI_APIRT

#include <odatk.h>

#undef TK_TKI_TKERR
#undef TK_TKI_APIRT

#define TK_IMPL_ISRD

#include <isrd.h>

#undef TK_IMPL_ISRD

#define PEPYPARM struct isode2toolkit_t *

INT_type dummy;


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	parse_ISRD6_Presentation__Style__Descriptor (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
struct isode2toolkit_t *  parm;
{
# line 79 "isrd6.py"
    

    CHAR_type *PresentStyleIDChars;
    STRING_type PresentStyleIDString;

    CHAR_type *CommentChars;
    INT_type CommentLength;
    STRING_type CommentString;

    CHAR_type *NameChars;
    INT_type NameLength;
    STRING_type NameString;


    int p0_count = 0;
    register PE p0;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Presentation-Style-Descriptor");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Presentation-Style-Descriptor bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Presentation-Style-Descriptor bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    {
# line 96 "isrd6.py"

    parm->constituent = MakeStyle( parm->document, PRESENTATION_STYLE);
    if ( parm->constituent == ERROR_CONSTITUENT ) {
	dummy = TKERR_StartErrMsg();
	dummy = TKERR_Format("[parse_ISRD6_Presentation__Style__Descriptor]: can not make style");
	dummy = TKERR_EndErrMsg();
	return( NOTOK );
    }
    }
    if ((p0 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Presentation-Style-Descriptor bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    if (p0 = set_find (pe, PE_CLASS_APPL, 5)) {
#ifdef DEBUG
        (void) testdebug (p0, "style-identifier");
#endif

        if (parse_ISRD3_Style__Identifier (p0, 0, NULLIP, &(PresentStyleIDChars ), NullParm) == NOTOK)
            return NOTOK;
        {
# line 112 "isrd6.py"

	    PresentStyleIDString = Chars2String(PresentStyleIDChars);
	    if ( PresentStyleIDString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Presentation__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    if ( SetAttr( parm->constituent,
			  at_PRESENTATION_STYLE_ID,
			  (POINTER_type) PresentStyleIDString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6__Presentation__Style__Descriptor]: can not set attribute at_PRESENTATION_STYLE_ID" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
        p0_count ++;
    }
    else {
        advise (NULLCP, "style-identifier missing style-identifier member");
        return NOTOK;
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 0)) {
        register char *p1;
        int p1_len;

#ifdef DEBUG
        (void) testdebug (p0, "user-readable-comments");
#endif

        if ((p1 = prim2str (p0, &p1_len)) == NULLCP) {
            advise (NULLCP, "user-readable-comments bad octetstring: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        CommentChars  = p1;
         CommentLength  = p1_len;
        {
# line 136 "isrd6.py"

	    CommentString = MakeString(CommentLength);
	    if ( CommentString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Presentation__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    CommentString->sequence_value.chars = CommentChars;
	    if ( SetAttr( parm->constituent,
			  at_USER_READABLE_COMMENTS,
			  (POINTER_type) CommentString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Presentation__Style__Descriptor]: can not set attribute at_USER_READABLE_COMMENTS" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
            /* do nothing */;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 1)) {
        register char *p2;
        int p2_len;

#ifdef DEBUG
        (void) testdebug (p0, "user-visible-name");
#endif

        if ((p2 = prim2str (p0, &p2_len)) == NULLCP) {
            advise (NULLCP, "user-visible-name bad octetstring: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        NameChars  = p2;
         NameLength  = p2_len;
        {
# line 163 "isrd6.py"

	    NameString = MakeString(NameLength);
	    if ( NameString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Presentation__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    NameString->sequence_value.chars = NameChars;
	    if ( SetAttr( parm->constituent,
			  at_USER_VISIBLE_NAME,
			  (POINTER_type) NameString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Presentation_Style__Descriptor]: can not set attribute at_USER_VISIBLE_NAME" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
            /* do nothing */;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p0, "transparency");
#endif

        if (parse_ISRD4_Transparency (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p0, "presentation-attributes");
#endif

        if (parse_ISRD6_Presentation__Attributes (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p0, "colour");
#endif

        if (parse_ISRD4_Colour (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p0, "border");
#endif

        if (parse_ISRD4_Border (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    {
# line 212 "isrd6.py"

    if ( GetAttr( parm->constituent,
		  at_PRESENTATION_STYLE_ID,
		  (POINTER_type) &PresentStyleIDString,
		  /* default */ BOOL_false,
		  /* mask */ (PARM_MASK_type *) 0
	        ) == ERROR_INT ) {
	return ( NOTOK );
    } else {
	if ( ISODE_FillInConstituent ( parm->constituent,
				       PresentStyleIDString
				     ) == ERROR_INT ) {
	    return ( NOTOK );
	}
    }
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Presentation__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p3_count = 0;
    register PE p3;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Presentation-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Presentation-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Presentation-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p3 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Presentation-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p3;

    if (p3 = set_find (pe, PE_CLASS_APPL, 2)) {
#ifdef DEBUG
        (void) testdebug (p3, "content-type");
#endif

        if (parse_ISRD6_Content__Type (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_UNIV, 6)) {
#ifdef DEBUG
        (void) testdebug (p3, "content-architecture-class");
#endif

        if (parse_ISRD6_Content__Architecture__Class (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p3, "character-attributes");
#endif

        if (parse_ISRD9_Character__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p3, "raster-graphics-attributes");
#endif

        if (parse_ISRD12_Raster__Graphics__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p3, "geometric-graphics-attributes");
#endif

        if (parse_ISRD15_Geometric__Graphics__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 6)) {
        register PE p4;

#ifdef DEBUG
        (void) testdebug (p3, "ext-cont-arch-attributes");
#endif

        if ((p4 = prim2seq (p3)) == NULLPE) {
            advise (NULLCP, "ext-cont-arch-attributes bad sequence: %s",
                    pe_error (p3 -> pe_errno));
            return NOTOK;
        }
        p3 = p4;

        for (p4 = first_member (p3); p4; p4 = next_member (p3, p4)) {
#ifdef DEBUG
            (void) testdebug (p4, "element");
#endif

            if (parse_UNIV_EXTERNAL (p4, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p3_count ++;
    }
    if (p3_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Content__Type (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p5;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Content-Type");
#endif

    if (explicit
            && PE_ID (pe -> pe_class, pe -> pe_id)
                    != PE_ID (PE_CLASS_APPL, 2)) {
        advise (NULLCP, "Content-Type bad class/id: %s/0x%x", 
                pe_classlist[pe -> pe_class], pe -> pe_id);
        return NOTOK;
    }
    if ((p5 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Content-Type bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p5;
    switch (p5) {
        case 0:	/* formatted-characters */
            break;
        case 1:	/* formatted-raster-graphics */
            break;
        default:
            advise (NULLCP, "Content-Type has unknown component: %d", p5);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Content__Architecture__Class (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register OID p6;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Content-Architecture-Class");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_OID) {
            advise (NULLCP, "Content-Architecture-Class bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Content-Architecture-Class bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p6 = prim2oid (pe)) == NULLOID) {
        advise (NULLCP, "Content-Architecture-Class bad object identifier: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (buffer)
        *buffer = sprintoid (p6);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Layout__Style__Descriptor (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
struct isode2toolkit_t *  parm;
{
# line 255 "isrd6.py"
    

    CHAR_type *LayoutStyleIDChars;
    STRING_type LayoutStyleIDString;

    CHAR_type *CommentChars;
    INT_type CommentLength;
    STRING_type CommentString;

    CHAR_type *NameChars;
    INT_type NameLength;
    STRING_type NameString;


    int p7_count = 0;
    register PE p7;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Layout-Style-Descriptor");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Layout-Style-Descriptor bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Layout-Style-Descriptor bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    {
# line 272 "isrd6.py"

    parm->constituent = MakeStyle( parm->document, LAYOUT_STYLE );
    if ( parm->constituent == ERROR_CONSTITUENT ) {
	dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not make style");
	dummy = TKERR_EndErrMsg();
	return( NOTOK );
    }
    }
    if ((p7 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Layout-Style-Descriptor bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p7;

    if (p7 = set_find (pe, PE_CLASS_APPL, 5)) {
#ifdef DEBUG
        (void) testdebug (p7, "style-identifier");
#endif

        if (parse_ISRD3_Style__Identifier (p7, 0, NULLIP, &(LayoutStyleIDChars ), NullParm) == NOTOK)
            return NOTOK;
        {
# line 288 "isrd6.py"

	    LayoutStyleIDString = Chars2String(LayoutStyleIDChars);
	    if ( LayoutStyleIDString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    if ( SetAttr( parm->constituent,
			  at_LAYOUT_STYLE_IDENTIFIER,
			  (POINTER_type) LayoutStyleIDString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not set attribute at_LAYOUT_STYLE_IDENTIFIER" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
        p7_count ++;
    }
    else {
        advise (NULLCP, "style-identifier missing style-identifier member");
        return NOTOK;
    }

    if (p7 = set_find (pe, PE_CLASS_CONT, 0)) {
        register char *p8;
        int p8_len;

#ifdef DEBUG
        (void) testdebug (p7, "user-readable-comments");
#endif

        if ((p8 = prim2str (p7, &p8_len)) == NULLCP) {
            advise (NULLCP, "user-readable-comments bad octetstring: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        CommentChars  = p8;
         CommentLength  = p8_len;
        {
# line 312 "isrd6.py"

	    CommentString = MakeString(CommentLength);
	    if ( CommentString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    CommentString->sequence_value.chars = CommentChars;
	    if ( SetAttr( parm->constituent,
			  at_USER_READABLE_COMMENTS,
			  (POINTER_type) CommentString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not set attribute at_USER_READABLE_COMMENTS" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
            /* do nothing */;
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 1)) {
        register char *p9;
        int p9_len;

#ifdef DEBUG
        (void) testdebug (p7, "user-visible-name");
#endif

        if ((p9 = prim2str (p7, &p9_len)) == NULLCP) {
            advise (NULLCP, "user-visible-name bad octetstring: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        NameChars  = p9;
         NameLength  = p9_len;
        {
# line 339 "isrd6.py"

	    NameString = MakeString(NameLength);
	    if ( NameString == ERROR_STRING ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout__Style__Descriptor]: can not make string");
		dummy = TKERR_EndErrMsg();
		return ( NOTOK );
	    }
	    NameString->sequence_value.chars = NameChars;
	    if ( SetAttr( parm->constituent,
			  at_USER_VISIBLE_NAME,
			  (POINTER_type) NameString,
			  /* mask */ (PARM_MASK_type *) 0
		        ) == ERROR_INT ) {
		dummy = TKERR_StartErrMsg();
		dummy = TKERR_Format("[parse_ISRD6_Layout_Style__Descriptor]: can not set attribute at_USER_VISIBLE_NAME" );
		dummy = TKERR_EndErrMsg();
		return( NOTOK );
	    }
	
        }
            /* do nothing */;
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p7, "layout-directives");
#endif

        if (parse_ISRD6_Layout__Directives (p7, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p7_count ++;
    }
    if (p7_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    {
# line 369 "isrd6.py"

    if ( GetAttr( parm->constituent,
		  at_LAYOUT_STYLE_IDENTIFIER,
		  (POINTER_type) &LayoutStyleIDString,
		  /* default */ BOOL_false,
		  /* mask */ (PARM_MASK_type *) 0
	        ) == ERROR_INT ) {
	return ( NOTOK );
    } else {
	if ( ISODE_FillInConstituent ( parm->constituent,
				       LayoutStyleIDString
				     ) == ERROR_INT ) {
	    return ( NOTOK );
	}
    }
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Layout__Directives (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p10_count = 0;
    register PE p10;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Layout-Directives");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Layout-Directives bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Layout-Directives bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p10 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Layout-Directives bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p10;

    if ( (p10 = set_find (pe, PE_CLASS_CONT, 0))
        || (p10 = set_find (pe, PE_CLASS_CONT, 1))
        || (p10 = set_find (pe, PE_CLASS_CONT, 2))
        || (p10 = set_find (pe, PE_CLASS_CONT, 15)) ) {
#ifdef DEBUG
        (void) testdebug (p10, "indivisibility");
#endif

        switch (PE_ID (p10 -> pe_class, p10 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):	/* to-layout-object-class */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-object-class");
#endif

                    if (parse_ISRD3_Object__or__Class__Identifier (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 1):	/* to-layout-category */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-category");
#endif

                    if (parse_ISRD3_Layout__Category__Name (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 2):	/* to-layout-object-type */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-object-type");
#endif

                    if (parse_ISRD4_Layout__Object__Type (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 15):	/* null */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "null");
#endif

                }
                break;

            default:
                advise (NULLCP, "indivisibility has unknown choice: %s/%d/0x%x",
                        pe_classlist[p10 -> pe_class], p10 -> pe_form, p10 -> pe_id);
                return NOTOK;
        }
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p10, "separation");
#endif

        if (parse_ISRD6_Separation (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p10, "offset");
#endif

        if (parse_ISRD6_Offset (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p10, "fill-order");
#endif

        if (parse_ISRD6_Fill__Order (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p10, "concatenation");
#endif

        if (parse_ISRD6_Concatenation (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if ( (p10 = set_find (pe, PE_CLASS_CONT, 7))
        || (p10 = set_find (pe, PE_CLASS_CONT, 8))
        || (p10 = set_find (pe, PE_CLASS_CONT, 9))
        || (p10 = set_find (pe, PE_CLASS_CONT, 16)) ) {
#ifdef DEBUG
        (void) testdebug (p10, "new-layout-object");
#endif

        switch (PE_ID (p10 -> pe_class, p10 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 7):	/* to-layout-object-class */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-object-class");
#endif

                    if (parse_ISRD3_Object__or__Class__Identifier (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 8):	/* to-layout-category */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-category");
#endif

                    if (parse_ISRD3_Layout__Category__Name (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 9):	/* to-layout-object-type */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "to-layout-object-type");
#endif

                    if (parse_ISRD4_Layout__Object__Type (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 16):	/* null */
                {
#ifdef DEBUG
                    (void) testdebug (p10, "null");
#endif

                }
                break;

            default:
                advise (NULLCP, "new-layout-object has unknown choice: %s/%d/0x%x",
                        pe_classlist[p10 -> pe_class], p10 -> pe_form, p10 -> pe_id);
                return NOTOK;
        }
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 10)) {
#ifdef DEBUG
        (void) testdebug (p10, "same-layout-object");
#endif

        if (parse_ISRD6_Same__Layout__Object (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 11)) {
#ifdef DEBUG
        (void) testdebug (p10, "layout-object-class");
#endif

        if (parse_ISRD3_Object__or__Class__Identifier (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 12)) {
#ifdef DEBUG
        (void) testdebug (p10, "layout-category");
#endif

        if (parse_ISRD3_Layout__Category__Name (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if ( (p10 = set_find (pe, PE_CLASS_CONT, 13))
        || (p10 = set_find (pe, PE_CLASS_CONT, 17))
        || (p10 = set_find (pe, PE_CLASS_CONT, 18)) ) {
#ifdef DEBUG
        (void) testdebug (p10, "synchronization");
#endif

        switch (PE_ID (p10 -> pe_class, p10 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 13):
                {
#ifdef DEBUG
                    (void) testdebug (p10, "member");
#endif

                    if (parse_ISRD3_Object__or__Class__Identifier (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 17):
                {
                    register PE p11 = p10;

                    {	/* member TAG PULLUP */
                        register PE p12;

                        if ((p12 = prim2set (p11)) == NULLPE) {
                            advise (NULLCP, "member bad member: %s",
                                    pe_error (p11 -> pe_errno));
                            return NOTOK;
                        }
                        if (p12 -> pe_cardinal != 1) {
                            advise (NULLCP, "member too many elements for tagged member: %d",
                                    p12 -> pe_cardinal);
                            return NOTOK;
                        }
                        p11 = first_member (p12);
                    }
                    {
#ifdef DEBUG
                        (void) testdebug (p11, "member");
#endif

                        if (parse_ISRD3_Object__Id__Expression (p11, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 18):
                {
#ifdef DEBUG
                    (void) testdebug (p10, "member");
#endif

                }
                break;

            default:
                advise (NULLCP, "synchronization has unknown choice: %s/%d/0x%x",
                        pe_classlist[p10 -> pe_class], p10 -> pe_form, p10 -> pe_id);
                return NOTOK;
        }
        p10_count ++;
    }
    if (p10 = set_find (pe, PE_CLASS_CONT, 14)) {
#ifdef DEBUG
        (void) testdebug (p10, "block-alignment");
#endif

        if (parse_ISRD6_Block__Alignment (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p10_count ++;
    }
    if (p10_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Separation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p13_count = 0;
    register PE p13;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Separation");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Separation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Separation bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p13 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Separation bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p13;

    if (p13 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p13, "leading");
#endif

        if (prim2num (p13) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "leading bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p13, "trailing");
#endif

        if (prim2num (p13) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "trailing bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p13, "centre");
#endif

        if (prim2num (p13) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "centre bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Offset (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p14_count = 0;
    register PE p14;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Offset");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Offset bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Offset bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p14 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Offset bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p14;

    if (p14 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p14, "right-hand");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "right-hand bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p14 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p14, "left-hand");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "left-hand bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p14 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p14, "trailing");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "trailing bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p14 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p14, "leading");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "leading bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p14_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Fill__Order (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p15;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Fill-Order");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Fill-Order bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Fill-Order bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p15 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Fill-Order bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p15;
    switch (p15) {
        case 0:	/* normal */
            break;
        case 1:	/* reverse */
            break;
        default:
            advise (NULLCP, "Fill-Order has unknown component: %d", p15);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Concatenation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p16;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Concatenation");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Concatenation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Concatenation bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p16 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Concatenation bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p16;
    switch (p16) {
        case 0:	/* non-concatenated */
            break;
        case 1:	/* concatenated */
            break;
        default:
            advise (NULLCP, "Concatenation has unknown component: %d", p16);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Same__Layout__Object (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p17_count = 0;
    register PE p17;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Same-Layout-Object");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Same-Layout-Object bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Same-Layout-Object bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p17 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Same-Layout-Object bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p17;

    if ( (p17 = set_find (pe, PE_CLASS_CONT, 0))
        || (p17 = set_find (pe, PE_CLASS_CONT, 4))
        || (p17 = set_find (pe, PE_CLASS_CONT, 5)) ) {
#ifdef DEBUG
        (void) testdebug (p17, "to-logical-object");
#endif

        switch (PE_ID (p17 -> pe_class, p17 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):
                {
#ifdef DEBUG
                    (void) testdebug (p17, "member");
#endif

                    if (parse_ISRD3_Object__or__Class__Identifier (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 4):
                {
                    register PE p18 = p17;

                    {	/* member TAG PULLUP */
                        register PE p19;

                        if ((p19 = prim2set (p18)) == NULLPE) {
                            advise (NULLCP, "member bad member: %s",
                                    pe_error (p18 -> pe_errno));
                            return NOTOK;
                        }
                        if (p19 -> pe_cardinal != 1) {
                            advise (NULLCP, "member too many elements for tagged member: %d",
                                    p19 -> pe_cardinal);
                            return NOTOK;
                        }
                        p18 = first_member (p19);
                    }
                    {
#ifdef DEBUG
                        (void) testdebug (p18, "member");
#endif

                        if (parse_ISRD3_Object__Id__Expression (p18, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 5):
                {
#ifdef DEBUG
                    (void) testdebug (p17, "member");
#endif

                }
                break;

            default:
                advise (NULLCP, "to-logical-object has unknown choice: %s/%d/0x%x",
                        pe_classlist[p17 -> pe_class], p17 -> pe_form, p17 -> pe_id);
                return NOTOK;
        }
        p17_count ++;
    }
    else {
        advise (NULLCP, "to-logical-object missing to-logical-object member");
        return NOTOK;
    }

    if ( (p17 = set_find (pe, PE_CLASS_CONT, 1))
        || (p17 = set_find (pe, PE_CLASS_CONT, 2))
        || (p17 = set_find (pe, PE_CLASS_CONT, 3)) ) {
#ifdef DEBUG
        (void) testdebug (p17, "member");
#endif

        switch (PE_ID (p17 -> pe_class, p17 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 1):	/* to-layout-object-class */
                {
#ifdef DEBUG
                    (void) testdebug (p17, "to-layout-object-class");
#endif

                    if (parse_ISRD3_Object__or__Class__Identifier (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 2):	/* to-layout-category */
                {
#ifdef DEBUG
                    (void) testdebug (p17, "to-layout-category");
#endif

                    if (parse_ISRD3_Layout__Category__Name (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 3):	/* to-layout-object-type */
                {
#ifdef DEBUG
                    (void) testdebug (p17, "to-layout-object-type");
#endif

                    if (parse_ISRD4_Layout__Object__Type (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;

            default:
                advise (NULLCP, "member has unknown choice: %s/%d/0x%x",
                        pe_classlist[p17 -> pe_class], p17 -> pe_form, p17 -> pe_id);
                return NOTOK;
        }
        p17_count ++;
    }
    if (p17_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD6_Block__Alignment (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p20;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD6.Block-Alignment");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Block-Alignment bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Block-Alignment bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p20 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Block-Alignment bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p20;
    switch (p20) {
        case 0:	/* right-hand */
            break;
        case 1:	/* left-hand */
            break;
        case 2:	/* centred */
            break;
        case 3:	/* null */
            break;
        default:
            advise (NULLCP, "Block-Alignment has unknown component: %d", p20);
            return NOTOK;
    }

    return OK;
}
