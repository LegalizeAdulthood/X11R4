/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISRD15 */
# line 5 "isrd15.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */

#include <odatk.h>

#define TK_IMPL_ISRD

#include <isrd.h>

#undef TK_IMPL_ISRD

#define PEPYPARM struct isode2toolkit_t *


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	parse_ISRD15_Geometric__Graphics__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p0_count = 0;
    register PE p0;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Geometric-Graphics-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Geometric-Graphics-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Geometric-Graphics-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Geometric-Graphics-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    if (p0 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p0, "encoding-announcer");
#endif

        if (parse_ISRD15_Encoding__Announcer (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p0, "line-rendition");
#endif

        if (parse_ISRD15_Line__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p0, "marker-rendition");
#endif

        if (parse_ISRD15_Marker__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p0, "text-rendition");
#endif

        if (parse_ISRD15_Text__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p0, "filled-area-rendition");
#endif

        if (parse_ISRD15_Filled__Area__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p0, "edge-rendition");
#endif

        if (parse_ISRD15_Edge__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p0, "colour-representations");
#endif

        if (parse_ISRD15_Colour__Representations (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p0, "transparency-specification");
#endif

        if (parse_ISRD15_Transparency__Specification (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 8)) {
#ifdef DEBUG
        (void) testdebug (p0, "transformation-specification");
#endif

        if (parse_ISRD15_Transformation__Specification (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 9)) {
        register PE p1 = p0;

        {	/* region-of-interest TAG PULLUP */
            register PE p2;

            if ((p2 = prim2set (p1)) == NULLPE) {
                advise (NULLCP, "region-of-interest bad region-of-interest: %s",
                        pe_error (p1 -> pe_errno));
                return NOTOK;
            }
            if (p2 -> pe_cardinal != 1) {
                advise (NULLCP, "region-of-interest too many elements for tagged region-of-interest: %d",
                        p2 -> pe_cardinal);
                return NOTOK;
            }
            p1 = first_member (p2);
        }
        {
#ifdef DEBUG
            (void) testdebug (p1, "region-of-interest");
#endif

            if (parse_ISRD15_Region__Of__Interest (p1, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 10)) {
#ifdef DEBUG
        (void) testdebug (p0, "picture-orientation");
#endif

        if (parse_ISRD15_Picture__Orientation (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 11)) {
        register PE p3 = p0;

        {	/* picture-dimensions TAG PULLUP */
            register PE p4;

            if ((p4 = prim2set (p3)) == NULLPE) {
                advise (NULLCP, "picture-dimensions bad picture-dimensions: %s",
                        pe_error (p3 -> pe_errno));
                return NOTOK;
            }
            if (p4 -> pe_cardinal != 1) {
                advise (NULLCP, "picture-dimensions too many elements for tagged picture-dimensions: %d",
                        p4 -> pe_cardinal);
                return NOTOK;
            }
            p3 = first_member (p4);
        }
        {
#ifdef DEBUG
            (void) testdebug (p3, "picture-dimensions");
#endif

            if (parse_ISRD15_Picture__Dimensions (p3, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p0_count ++;
    }
    if (p0_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Encoding__Announcer (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p5;
    int p5_len;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Encoding-Announcer");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "Encoding-Announcer bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p5 = prim2str (pe, &p5_len)) == NULLCP) {
        advise (NULLCP, "Encoding-Announcer bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p5_len;
    if (buffer)
        *buffer = p5;
    else
        if (p5)
            free (p5);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Line__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p6;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Line-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Line-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Line-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p6 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Line-Rendition bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p6;

    {
        register PE p7;

        if ((p7 = first_member (pe)) != NULLPE
                && PE_ID (p7 -> pe_class, p7 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p7 = NULLPE;
        if (p7 != NULLPE) {
            p6 = p7;

            {	/* individual-part */
#ifdef DEBUG
                (void) testdebug (p7, "individual-part");
#endif

            }
        }
    }

    {
        register PE p8;

        if ((p8 = (pe != p6 ? next_member (pe, p6) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p8 -> pe_class, p8 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p8 = NULLPE;
        if (p8 != NULLPE) {
            p6 = p8;

            {	/* asf-part */
                register PE p9;

#ifdef DEBUG
                (void) testdebug (p8, "asf-part");
#endif

                if ((p9 = prim2seq (p8)) == NULLPE) {
                    advise (NULLCP, "asf-part bad sequence: %s",
                            pe_error (p8 -> pe_errno));
                    return NOTOK;
                }
                p8 = p9;

                {
                    register PE p10;

                    if ((p10 = first_member (p8)) != NULLPE) {
                        p9 = p10;

                        {	/* line-type-asf */
#ifdef DEBUG
                            (void) testdebug (p10, "line-type-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p10, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing line-type-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p11;

                    if ((p11 = (p8 != p9 ? next_member (p8, p9) : first_member (p8))) != NULLPE) {
                        p9 = p11;

                        {	/* line-width-asf */
#ifdef DEBUG
                            (void) testdebug (p11, "line-width-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p11, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing line-width-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p12;

                    if ((p12 = (p8 != p9 ? next_member (p8, p9) : first_member (p8))) != NULLPE) {
                        p9 = p12;

                        {	/* line-colour-asf */
#ifdef DEBUG
                            (void) testdebug (p12, "line-colour-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p12, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing line-colour-asf element");
                        return NOTOK;
                    }

                }


                if (p8 -> pe_cardinal > 3) {
                    advise (NULLCP, "asf-part has too many elements(3): %d",
                            p8 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p13;

        if ((p13 = (pe != p6 ? next_member (pe, p6) : first_member (pe))) != NULLPE) {
            p6 = p13;

            {	/* bundle-part */
                register PE p14;

#ifdef DEBUG
                (void) testdebug (p13, "bundle-part");
#endif

                if ((p14 = prim2seq (p13)) == NULLPE) {
                    advise (NULLCP, "bundle-part bad sequence: %s",
                            pe_error (p13 -> pe_errno));
                    return NOTOK;
                }
                p13 = p14;

                for (p14 = first_member (p13); p14; p14 = next_member (p13, p14)) {
                    register PE p15;

#ifdef DEBUG
                    (void) testdebug (p14, "element");
#endif

                    if (p14 -> pe_class != PE_CLASS_UNIV
                            || p14 -> pe_form != PE_FORM_CONS
                            || p14 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p14 -> pe_class], p14 -> pe_form, p14 -> pe_id);
                        return NOTOK;
                    }

                    if ((p15 = prim2seq (p14)) == NULLPE) {
                        advise (NULLCP, "element bad sequence: %s",
                                pe_error (p14 -> pe_errno));
                        return NOTOK;
                    }
                    p14 = p15;

                    {
                        register PE p16;

                        if ((p16 = first_member (p14)) != NULLPE) {
                            p15 = p16;

                            {	/* bundle-index */
#ifdef DEBUG
                                (void) testdebug (p16, "bundle-index");
#endif

                                if (p16 -> pe_class != PE_CLASS_UNIV
                                        || p16 -> pe_form != PE_FORM_PRIM
                                        || p16 -> pe_id != PE_PRIM_INT) {
                                    advise (NULLCP, "bundle-index bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p16 -> pe_class], p16 -> pe_form, p16 -> pe_id);
                                    return NOTOK;
                                }

                                if (prim2num (p16) == NOTOK
                                        && p16 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "bundle-index bad integer: %s",
                                            pe_error (p16 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-index element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p17;

                        if ((p17 = (p14 != p15 ? next_member (p14, p15) : first_member (p14))) != NULLPE) {
                            p15 = p17;

                            {	/* bundle-representation */
#ifdef DEBUG
                                (void) testdebug (p17, "bundle-representation");
#endif

                                if (p17 -> pe_class != PE_CLASS_UNIV || p17 -> pe_id != PE_PRIM_OCTS) {
                                    advise (NULLCP, "bundle-representation bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p17 -> pe_class], p17 -> pe_form, p17 -> pe_id);
                                    return NOTOK;
                                }

                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-representation element");
                            return NOTOK;
                        }

                    }


                    if (p14 -> pe_cardinal > 2) {
                        advise (NULLCP, "element has too many elements(2): %d",
                                p14 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 3) {
        advise (NULLCP, "Line-Rendition has too many elements(3): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Marker__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p18;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Marker-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Marker-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Marker-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p18 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Marker-Rendition bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p18;

    {
        register PE p19;

        if ((p19 = first_member (pe)) != NULLPE
                && PE_ID (p19 -> pe_class, p19 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p19 = NULLPE;
        if (p19 != NULLPE) {
            p18 = p19;

            {	/* individual-part */
#ifdef DEBUG
                (void) testdebug (p19, "individual-part");
#endif

            }
        }
    }

    {
        register PE p20;

        if ((p20 = (pe != p18 ? next_member (pe, p18) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p20 -> pe_class, p20 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p20 = NULLPE;
        if (p20 != NULLPE) {
            p18 = p20;

            {	/* asf-part */
                register PE p21;

#ifdef DEBUG
                (void) testdebug (p20, "asf-part");
#endif

                if ((p21 = prim2seq (p20)) == NULLPE) {
                    advise (NULLCP, "asf-part bad sequence: %s",
                            pe_error (p20 -> pe_errno));
                    return NOTOK;
                }
                p20 = p21;

                {
                    register PE p22;

                    if ((p22 = first_member (p20)) != NULLPE) {
                        p21 = p22;

                        {	/* marker-type-asf */
#ifdef DEBUG
                            (void) testdebug (p22, "marker-type-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p22, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing marker-type-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p23;

                    if ((p23 = (p20 != p21 ? next_member (p20, p21) : first_member (p20))) != NULLPE) {
                        p21 = p23;

                        {	/* marker-width-asf */
#ifdef DEBUG
                            (void) testdebug (p23, "marker-width-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p23, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing marker-width-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p24;

                    if ((p24 = (p20 != p21 ? next_member (p20, p21) : first_member (p20))) != NULLPE) {
                        p21 = p24;

                        {	/* marker-colour-asf */
#ifdef DEBUG
                            (void) testdebug (p24, "marker-colour-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p24, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing marker-colour-asf element");
                        return NOTOK;
                    }

                }


                if (p20 -> pe_cardinal > 3) {
                    advise (NULLCP, "asf-part has too many elements(3): %d",
                            p20 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p25;

        if ((p25 = (pe != p18 ? next_member (pe, p18) : first_member (pe))) != NULLPE) {
            p18 = p25;

            {	/* bundle-part */
                register PE p26;

#ifdef DEBUG
                (void) testdebug (p25, "bundle-part");
#endif

                if ((p26 = prim2seq (p25)) == NULLPE) {
                    advise (NULLCP, "bundle-part bad sequence: %s",
                            pe_error (p25 -> pe_errno));
                    return NOTOK;
                }
                p25 = p26;

                for (p26 = first_member (p25); p26; p26 = next_member (p25, p26)) {
                    register PE p27;

#ifdef DEBUG
                    (void) testdebug (p26, "element");
#endif

                    if (p26 -> pe_class != PE_CLASS_UNIV
                            || p26 -> pe_form != PE_FORM_CONS
                            || p26 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p26 -> pe_class], p26 -> pe_form, p26 -> pe_id);
                        return NOTOK;
                    }

                    if ((p27 = prim2seq (p26)) == NULLPE) {
                        advise (NULLCP, "element bad sequence: %s",
                                pe_error (p26 -> pe_errno));
                        return NOTOK;
                    }
                    p26 = p27;

                    {
                        register PE p28;

                        if ((p28 = first_member (p26)) != NULLPE) {
                            p27 = p28;

                            {	/* bundle-index */
#ifdef DEBUG
                                (void) testdebug (p28, "bundle-index");
#endif

                                if (p28 -> pe_class != PE_CLASS_UNIV
                                        || p28 -> pe_form != PE_FORM_PRIM
                                        || p28 -> pe_id != PE_PRIM_INT) {
                                    advise (NULLCP, "bundle-index bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p28 -> pe_class], p28 -> pe_form, p28 -> pe_id);
                                    return NOTOK;
                                }

                                if (prim2num (p28) == NOTOK
                                        && p28 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "bundle-index bad integer: %s",
                                            pe_error (p28 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-index element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p29;

                        if ((p29 = (p26 != p27 ? next_member (p26, p27) : first_member (p26))) != NULLPE) {
                            p27 = p29;

                            {	/* bundle-representation */
#ifdef DEBUG
                                (void) testdebug (p29, "bundle-representation");
#endif

                                if (p29 -> pe_class != PE_CLASS_UNIV || p29 -> pe_id != PE_PRIM_OCTS) {
                                    advise (NULLCP, "bundle-representation bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p29 -> pe_class], p29 -> pe_form, p29 -> pe_id);
                                    return NOTOK;
                                }

                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-representation element");
                            return NOTOK;
                        }

                    }


                    if (p26 -> pe_cardinal > 2) {
                        advise (NULLCP, "element has too many elements(2): %d",
                                p26 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 3) {
        advise (NULLCP, "Marker-Rendition has too many elements(3): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Text__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p30;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Text-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Text-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Text-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p30 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Text-Rendition bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p30;

    {
        register PE p31;

        if ((p31 = first_member (pe)) != NULLPE
                && PE_ID (p31 -> pe_class, p31 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p31 = NULLPE;
        if (p31 != NULLPE) {
            p30 = p31;

            {	/* individual-part */
#ifdef DEBUG
                (void) testdebug (p31, "individual-part");
#endif

            }
        }
    }

    {
        register PE p32;

        if ((p32 = (pe != p30 ? next_member (pe, p30) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p32 -> pe_class, p32 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p32 = NULLPE;
        if (p32 != NULLPE) {
            p30 = p32;

            {	/* asf-part */
                register PE p33;

#ifdef DEBUG
                (void) testdebug (p32, "asf-part");
#endif

                if ((p33 = prim2seq (p32)) == NULLPE) {
                    advise (NULLCP, "asf-part bad sequence: %s",
                            pe_error (p32 -> pe_errno));
                    return NOTOK;
                }
                p32 = p33;

                {
                    register PE p34;

                    if ((p34 = first_member (p32)) != NULLPE) {
                        p33 = p34;

                        {	/* text-type-asf */
#ifdef DEBUG
                            (void) testdebug (p34, "text-type-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p34, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing text-type-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p35;

                    if ((p35 = (p32 != p33 ? next_member (p32, p33) : first_member (p32))) != NULLPE) {
                        p33 = p35;

                        {	/* text-precision-asf */
#ifdef DEBUG
                            (void) testdebug (p35, "text-precision-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p35, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing text-precision-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p36;

                    if ((p36 = (p32 != p33 ? next_member (p32, p33) : first_member (p32))) != NULLPE) {
                        p33 = p36;

                        {	/* character-expansion-factor-asf */
#ifdef DEBUG
                            (void) testdebug (p36, "character-expansion-factor-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p36, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing character-expansion-factor-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p37;

                    if ((p37 = (p32 != p33 ? next_member (p32, p33) : first_member (p32))) != NULLPE) {
                        p33 = p37;

                        {	/* character-spacing-asf */
#ifdef DEBUG
                            (void) testdebug (p37, "character-spacing-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p37, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing character-spacing-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p38;

                    if ((p38 = (p32 != p33 ? next_member (p32, p33) : first_member (p32))) != NULLPE) {
                        p33 = p38;

                        {	/* text-colour-asf */
#ifdef DEBUG
                            (void) testdebug (p38, "text-colour-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p38, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing text-colour-asf element");
                        return NOTOK;
                    }

                }


                if (p32 -> pe_cardinal > 5) {
                    advise (NULLCP, "asf-part has too many elements(5): %d",
                            p32 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p39;

        if ((p39 = (pe != p30 ? next_member (pe, p30) : first_member (pe))) != NULLPE) {
            p30 = p39;

            {	/* bundle-part */
                register PE p40;

#ifdef DEBUG
                (void) testdebug (p39, "bundle-part");
#endif

                if ((p40 = prim2seq (p39)) == NULLPE) {
                    advise (NULLCP, "bundle-part bad sequence: %s",
                            pe_error (p39 -> pe_errno));
                    return NOTOK;
                }
                p39 = p40;

                for (p40 = first_member (p39); p40; p40 = next_member (p39, p40)) {
                    register PE p41;

#ifdef DEBUG
                    (void) testdebug (p40, "element");
#endif

                    if (p40 -> pe_class != PE_CLASS_UNIV
                            || p40 -> pe_form != PE_FORM_CONS
                            || p40 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p40 -> pe_class], p40 -> pe_form, p40 -> pe_id);
                        return NOTOK;
                    }

                    if ((p41 = prim2seq (p40)) == NULLPE) {
                        advise (NULLCP, "element bad sequence: %s",
                                pe_error (p40 -> pe_errno));
                        return NOTOK;
                    }
                    p40 = p41;

                    {
                        register PE p42;

                        if ((p42 = first_member (p40)) != NULLPE) {
                            p41 = p42;

                            {	/* bundle-index */
#ifdef DEBUG
                                (void) testdebug (p42, "bundle-index");
#endif

                                if (p42 -> pe_class != PE_CLASS_UNIV
                                        || p42 -> pe_form != PE_FORM_PRIM
                                        || p42 -> pe_id != PE_PRIM_INT) {
                                    advise (NULLCP, "bundle-index bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p42 -> pe_class], p42 -> pe_form, p42 -> pe_id);
                                    return NOTOK;
                                }

                                if (prim2num (p42) == NOTOK
                                        && p42 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "bundle-index bad integer: %s",
                                            pe_error (p42 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-index element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p43;

                        if ((p43 = (p40 != p41 ? next_member (p40, p41) : first_member (p40))) != NULLPE) {
                            p41 = p43;

                            {	/* bundle-representation */
#ifdef DEBUG
                                (void) testdebug (p43, "bundle-representation");
#endif

                                if (p43 -> pe_class != PE_CLASS_UNIV || p43 -> pe_id != PE_PRIM_OCTS) {
                                    advise (NULLCP, "bundle-representation bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p43 -> pe_class], p43 -> pe_form, p43 -> pe_id);
                                    return NOTOK;
                                }

                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-representation element");
                            return NOTOK;
                        }

                    }


                    if (p40 -> pe_cardinal > 2) {
                        advise (NULLCP, "element has too many elements(2): %d",
                                p40 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 3) {
        advise (NULLCP, "Text-Rendition has too many elements(3): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Filled__Area__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p44;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Filled-Area-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Filled-Area-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Filled-Area-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p44 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Filled-Area-Rendition bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p44;

    {
        register PE p45;

        if ((p45 = first_member (pe)) != NULLPE
                && PE_ID (p45 -> pe_class, p45 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p45 = NULLPE;
        if (p45 != NULLPE) {
            p44 = p45;

            {	/* individual-part */
#ifdef DEBUG
                (void) testdebug (p45, "individual-part");
#endif

            }
        }
    }

    {
        register PE p46;

        if ((p46 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p46 -> pe_class, p46 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p46 = NULLPE;
        if (p46 != NULLPE) {
            p44 = p46;

            {	/* pattern-table-part */
                register PE p47;

#ifdef DEBUG
                (void) testdebug (p46, "pattern-table-part");
#endif

                if ((p47 = prim2seq (p46)) == NULLPE) {
                    advise (NULLCP, "pattern-table-part bad sequence: %s",
                            pe_error (p46 -> pe_errno));
                    return NOTOK;
                }
                p46 = p47;

                for (p47 = first_member (p46); p47; p47 = next_member (p46, p47)) {
#ifdef DEBUG
                    (void) testdebug (p47, "element");
#endif

                    if (p47 -> pe_class != PE_CLASS_UNIV || p47 -> pe_id != PE_PRIM_OCTS) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p47 -> pe_class], p47 -> pe_form, p47 -> pe_id);
                        return NOTOK;
                    }

                }
            }
        }
    }

    {
        register PE p48;

        if ((p48 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p48 -> pe_class, p48 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p48 = NULLPE;
        if (p48 != NULLPE) {
            p44 = p48;

            {	/* asf-part */
                register PE p49;

#ifdef DEBUG
                (void) testdebug (p48, "asf-part");
#endif

                if ((p49 = prim2seq (p48)) == NULLPE) {
                    advise (NULLCP, "asf-part bad sequence: %s",
                            pe_error (p48 -> pe_errno));
                    return NOTOK;
                }
                p48 = p49;

                {
                    register PE p50;

                    if ((p50 = first_member (p48)) != NULLPE) {
                        p49 = p50;

                        {	/* interior-style-asf */
#ifdef DEBUG
                            (void) testdebug (p50, "interior-style-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p50, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing interior-style-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p51;

                    if ((p51 = (p48 != p49 ? next_member (p48, p49) : first_member (p48))) != NULLPE) {
                        p49 = p51;

                        {	/* fill-colour-asf */
#ifdef DEBUG
                            (void) testdebug (p51, "fill-colour-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p51, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing fill-colour-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p52;

                    if ((p52 = (p48 != p49 ? next_member (p48, p49) : first_member (p48))) != NULLPE) {
                        p49 = p52;

                        {	/* hatch-index-asf */
#ifdef DEBUG
                            (void) testdebug (p52, "hatch-index-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p52, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing hatch-index-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p53;

                    if ((p53 = (p48 != p49 ? next_member (p48, p49) : first_member (p48))) != NULLPE) {
                        p49 = p53;

                        {	/* pattern-index-asf */
#ifdef DEBUG
                            (void) testdebug (p53, "pattern-index-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p53, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing pattern-index-asf element");
                        return NOTOK;
                    }

                }


                if (p48 -> pe_cardinal > 4) {
                    advise (NULLCP, "asf-part has too many elements(4): %d",
                            p48 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p54;

        if ((p54 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) != NULLPE) {
            p44 = p54;

            {	/* bundle-part */
                register PE p55;

#ifdef DEBUG
                (void) testdebug (p54, "bundle-part");
#endif

                if ((p55 = prim2seq (p54)) == NULLPE) {
                    advise (NULLCP, "bundle-part bad sequence: %s",
                            pe_error (p54 -> pe_errno));
                    return NOTOK;
                }
                p54 = p55;

                for (p55 = first_member (p54); p55; p55 = next_member (p54, p55)) {
                    register PE p56;

#ifdef DEBUG
                    (void) testdebug (p55, "element");
#endif

                    if (p55 -> pe_class != PE_CLASS_UNIV
                            || p55 -> pe_form != PE_FORM_CONS
                            || p55 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p55 -> pe_class], p55 -> pe_form, p55 -> pe_id);
                        return NOTOK;
                    }

                    if ((p56 = prim2seq (p55)) == NULLPE) {
                        advise (NULLCP, "element bad sequence: %s",
                                pe_error (p55 -> pe_errno));
                        return NOTOK;
                    }
                    p55 = p56;

                    {
                        register PE p57;

                        if ((p57 = first_member (p55)) != NULLPE) {
                            p56 = p57;

                            {	/* bundle-index */
#ifdef DEBUG
                                (void) testdebug (p57, "bundle-index");
#endif

                                if (p57 -> pe_class != PE_CLASS_UNIV
                                        || p57 -> pe_form != PE_FORM_PRIM
                                        || p57 -> pe_id != PE_PRIM_INT) {
                                    advise (NULLCP, "bundle-index bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p57 -> pe_class], p57 -> pe_form, p57 -> pe_id);
                                    return NOTOK;
                                }

                                if (prim2num (p57) == NOTOK
                                        && p57 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "bundle-index bad integer: %s",
                                            pe_error (p57 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-index element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p58;

                        if ((p58 = (p55 != p56 ? next_member (p55, p56) : first_member (p55))) != NULLPE) {
                            p56 = p58;

                            {	/* bundle-representation */
#ifdef DEBUG
                                (void) testdebug (p58, "bundle-representation");
#endif

                                if (p58 -> pe_class != PE_CLASS_UNIV || p58 -> pe_id != PE_PRIM_OCTS) {
                                    advise (NULLCP, "bundle-representation bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p58 -> pe_class], p58 -> pe_form, p58 -> pe_id);
                                    return NOTOK;
                                }

                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-representation element");
                            return NOTOK;
                        }

                    }


                    if (p55 -> pe_cardinal > 2) {
                        advise (NULLCP, "element has too many elements(2): %d",
                                p55 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 4) {
        advise (NULLCP, "Filled-Area-Rendition has too many elements(4): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Edge__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p59;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Edge-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Edge-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Edge-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p59 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Edge-Rendition bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p59;

    {
        register PE p60;

        if ((p60 = first_member (pe)) != NULLPE
                && PE_ID (p60 -> pe_class, p60 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p60 = NULLPE;
        if (p60 != NULLPE) {
            p59 = p60;

            {	/* individual-part */
#ifdef DEBUG
                (void) testdebug (p60, "individual-part");
#endif

            }
        }
    }

    {
        register PE p61;

        if ((p61 = (pe != p59 ? next_member (pe, p59) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p61 -> pe_class, p61 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p61 = NULLPE;
        if (p61 != NULLPE) {
            p59 = p61;

            {	/* asf-part */
                register PE p62;

#ifdef DEBUG
                (void) testdebug (p61, "asf-part");
#endif

                if ((p62 = prim2seq (p61)) == NULLPE) {
                    advise (NULLCP, "asf-part bad sequence: %s",
                            pe_error (p61 -> pe_errno));
                    return NOTOK;
                }
                p61 = p62;

                {
                    register PE p63;

                    if ((p63 = first_member (p61)) != NULLPE) {
                        p62 = p63;

                        {	/* edge-type-asf */
#ifdef DEBUG
                            (void) testdebug (p63, "edge-type-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p63, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing edge-type-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p64;

                    if ((p64 = (p61 != p62 ? next_member (p61, p62) : first_member (p61))) != NULLPE) {
                        p62 = p64;

                        {	/* edge-width-asf */
#ifdef DEBUG
                            (void) testdebug (p64, "edge-width-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p64, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing edge-width-asf element");
                        return NOTOK;
                    }

                }

                {
                    register PE p65;

                    if ((p65 = (p61 != p62 ? next_member (p61, p62) : first_member (p61))) != NULLPE) {
                        p62 = p65;

                        {	/* edge-colour-asf */
#ifdef DEBUG
                            (void) testdebug (p65, "edge-colour-asf");
#endif

                            if (parse_ISRD15_ASF__Type (p65, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "asf-part missing edge-colour-asf element");
                        return NOTOK;
                    }

                }


                if (p61 -> pe_cardinal > 3) {
                    advise (NULLCP, "asf-part has too many elements(3): %d",
                            p61 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p66;

        if ((p66 = (pe != p59 ? next_member (pe, p59) : first_member (pe))) != NULLPE) {
            p59 = p66;

            {	/* bundle-part */
                register PE p67;

#ifdef DEBUG
                (void) testdebug (p66, "bundle-part");
#endif

                if ((p67 = prim2seq (p66)) == NULLPE) {
                    advise (NULLCP, "bundle-part bad sequence: %s",
                            pe_error (p66 -> pe_errno));
                    return NOTOK;
                }
                p66 = p67;

                for (p67 = first_member (p66); p67; p67 = next_member (p66, p67)) {
                    register PE p68;

#ifdef DEBUG
                    (void) testdebug (p67, "element");
#endif

                    if (p67 -> pe_class != PE_CLASS_UNIV
                            || p67 -> pe_form != PE_FORM_CONS
                            || p67 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p67 -> pe_class], p67 -> pe_form, p67 -> pe_id);
                        return NOTOK;
                    }

                    if ((p68 = prim2seq (p67)) == NULLPE) {
                        advise (NULLCP, "element bad sequence: %s",
                                pe_error (p67 -> pe_errno));
                        return NOTOK;
                    }
                    p67 = p68;

                    {
                        register PE p69;

                        if ((p69 = first_member (p67)) != NULLPE) {
                            p68 = p69;

                            {	/* bundle-index */
#ifdef DEBUG
                                (void) testdebug (p69, "bundle-index");
#endif

                                if (p69 -> pe_class != PE_CLASS_UNIV
                                        || p69 -> pe_form != PE_FORM_PRIM
                                        || p69 -> pe_id != PE_PRIM_INT) {
                                    advise (NULLCP, "bundle-index bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p69 -> pe_class], p69 -> pe_form, p69 -> pe_id);
                                    return NOTOK;
                                }

                                if (prim2num (p69) == NOTOK
                                        && p69 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "bundle-index bad integer: %s",
                                            pe_error (p69 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-index element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p70;

                        if ((p70 = (p67 != p68 ? next_member (p67, p68) : first_member (p67))) != NULLPE) {
                            p68 = p70;

                            {	/* bundle-representation */
#ifdef DEBUG
                                (void) testdebug (p70, "bundle-representation");
#endif

                                if (p70 -> pe_class != PE_CLASS_UNIV || p70 -> pe_id != PE_PRIM_OCTS) {
                                    advise (NULLCP, "bundle-representation bad class/form/id: %s/%d/0x%x",
                                            pe_classlist[p70 -> pe_class], p70 -> pe_form, p70 -> pe_id);
                                    return NOTOK;
                                }

                            }
                        }
                        else {
                            advise (NULLCP, "element missing bundle-representation element");
                            return NOTOK;
                        }

                    }


                    if (p67 -> pe_cardinal > 2) {
                        advise (NULLCP, "element has too many elements(2): %d",
                                p67 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 3) {
        advise (NULLCP, "Edge-Rendition has too many elements(3): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_ASF__Type (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p71;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.ASF-Type");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "ASF-Type bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "ASF-Type bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p71 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "ASF-Type bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p71;
    switch (p71) {
        case 0:	/* bundled */
            break;
        case 1:	/* individual */
            break;
        default:
            advise (NULLCP, "ASF-Type has unknown component: %d", p71);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Colour__Representations (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p72;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Colour-Representations");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Colour-Representations bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Colour-Representations bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p72 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Colour-Representations bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p72;

    {
        register PE p73;

        if ((p73 = first_member (pe)) != NULLPE
                && PE_ID (p73 -> pe_class, p73 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p73 = NULLPE;
        if (p73 != NULLPE) {
            p72 = p73;

            {	/* background-colour */
#ifdef DEBUG
                (void) testdebug (p73, "background-colour");
#endif

            }
        }
    }

    {
        register PE p74;

        if ((p74 = (pe != p72 ? next_member (pe, p72) : first_member (pe))) != NULLPE) {
            p72 = p74;

            {	/* colour-table-part */
                register PE p75;

#ifdef DEBUG
                (void) testdebug (p74, "colour-table-part");
#endif

                if ((p75 = prim2seq (p74)) == NULLPE) {
                    advise (NULLCP, "colour-table-part bad sequence: %s",
                            pe_error (p74 -> pe_errno));
                    return NOTOK;
                }
                p74 = p75;

                for (p75 = first_member (p74); p75; p75 = next_member (p74, p75)) {
#ifdef DEBUG
                    (void) testdebug (p75, "element");
#endif

                    if (p75 -> pe_class != PE_CLASS_UNIV || p75 -> pe_id != PE_PRIM_OCTS) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p75 -> pe_class], p75 -> pe_form, p75 -> pe_id);
                        return NOTOK;
                    }

                }
            }
        }
    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Colour-Representations has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Transparency__Specification (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p76;
    int p76_len;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Transparency-Specification");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "Transparency-Specification bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p76 = prim2str (pe, &p76_len)) == NULLCP) {
        advise (NULLCP, "Transparency-Specification bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p76_len;
    if (buffer)
        *buffer = p76;
    else
        if (p76)
            free (p76);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Transformation__Specification (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p77;
    int p77_len;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Transformation-Specification");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "Transformation-Specification bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p77 = prim2str (pe, &p77_len)) == NULLCP) {
        advise (NULLCP, "Transformation-Specification bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p77_len;
    if (buffer)
        *buffer = p77;
    else
        if (p77)
            free (p77);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Region__Of__Interest (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Region-Of-Interest");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_CONT, 0):	/* automatic */
            {
#ifdef DEBUG
                (void) testdebug (pe, "automatic");
#endif

            }
            break;
        case PE_ID (PE_CLASS_CONT, 1):	/* rectangle */
            {
                register PE p78;

#ifdef DEBUG
                (void) testdebug (pe, "rectangle");
#endif

                if ((p78 = prim2seq (pe)) == NULLPE) {
                    advise (NULLCP, "rectangle bad sequence: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                pe = p78;

                {
                    register PE p79;

                    if ((p79 = first_member (pe)) != NULLPE) {
                        p78 = p79;

                        {
#ifdef DEBUG
                            (void) testdebug (p79, "element");
#endif

                            if (parse_ISRD15_VDC__Pair (p79, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "rectangle missing element");
                        return NOTOK;
                    }

                }

                {
                    register PE p80;

                    if ((p80 = (pe != p78 ? next_member (pe, p78) : first_member (pe))) != NULLPE) {
                        p78 = p80;

                        {
#ifdef DEBUG
                            (void) testdebug (p80, "element");
#endif

                            if (parse_ISRD15_VDC__Pair (p80, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                    else {
                        advise (NULLCP, "rectangle missing element");
                        return NOTOK;
                    }

                }


                if (pe -> pe_cardinal > 2) {
                    advise (NULLCP, "rectangle has too many elements(2): %d",
                            pe -> pe_cardinal);
                    return NOTOK;
                }
            }
            break;

        default:
            advise (NULLCP, "Region-Of-Interest has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_VDC__Pair (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p81;
    int p81_len;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.VDC-Pair");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "VDC-Pair bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p81 = prim2str (pe, &p81_len)) == NULLCP) {
        advise (NULLCP, "VDC-Pair bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p81_len;
    if (buffer)
        *buffer = p81;
    else
        if (p81)
            free (p81);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Picture__Orientation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Picture-Orientation");
#endif

    if (parse_ISRD15_One__Of__Four__Angles (pe, explicit, len, buffer, NullParm) == NOTOK)
        return NOTOK;

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_One__Of__Four__Angles (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p82;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.One-Of-Four-Angles");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "One-Of-Four-Angles bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "One-Of-Four-Angles bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p82 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "One-Of-Four-Angles bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p82;
    switch (p82) {
        case 0:	/* d0 */
            break;
        case 1:	/* d90 */
            break;
        case 2:	/* d180 */
            break;
        case 3:	/* d270 */
            break;
        default:
            advise (NULLCP, "One-Of-Four-Angles has unknown component: %d", p82);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Picture__Dimensions (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Picture-Dimensions");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_CONT, 0):	/* picture-width */
            {
                register PE p83;

#ifdef DEBUG
                (void) testdebug (pe, "picture-width");
#endif

                if ((p83 = prim2seq (pe)) == NULLPE) {
                    advise (NULLCP, "picture-width bad sequence: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                pe = p83;

                {
                    register PE p84;

                    if ((p84 = first_member (pe)) != NULLPE) {
                        p83 = p84;

                        {	/* w-mimimum-width */
#ifdef DEBUG
                            (void) testdebug (p84, "w-mimimum-width");
#endif

                            if (p84 -> pe_class != PE_CLASS_UNIV
                                    || p84 -> pe_form != PE_FORM_PRIM
                                    || p84 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "w-mimimum-width bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p84 -> pe_class], p84 -> pe_form, p84 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p84) == NOTOK
                                    && p84 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "w-mimimum-width bad integer: %s",
                                        pe_error (p84 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-width missing w-mimimum-width element");
                        return NOTOK;
                    }

                }

                {
                    register PE p85;

                    if ((p85 = (pe != p83 ? next_member (pe, p83) : first_member (pe))) != NULLPE) {
                        p83 = p85;

                        {	/* w-preferred-width */
#ifdef DEBUG
                            (void) testdebug (p85, "w-preferred-width");
#endif

                            if (p85 -> pe_class != PE_CLASS_UNIV
                                    || p85 -> pe_form != PE_FORM_PRIM
                                    || p85 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "w-preferred-width bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p85 -> pe_class], p85 -> pe_form, p85 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p85) == NOTOK
                                    && p85 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "w-preferred-width bad integer: %s",
                                        pe_error (p85 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-width missing w-preferred-width element");
                        return NOTOK;
                    }

                }


                if (pe -> pe_cardinal > 2) {
                    advise (NULLCP, "picture-width has too many elements(2): %d",
                            pe -> pe_cardinal);
                    return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 1):	/* picture-height */
            {
                register PE p86;

#ifdef DEBUG
                (void) testdebug (pe, "picture-height");
#endif

                if ((p86 = prim2seq (pe)) == NULLPE) {
                    advise (NULLCP, "picture-height bad sequence: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                pe = p86;

                {
                    register PE p87;

                    if ((p87 = first_member (pe)) != NULLPE) {
                        p86 = p87;

                        {	/* h-mimimum-height */
#ifdef DEBUG
                            (void) testdebug (p87, "h-mimimum-height");
#endif

                            if (p87 -> pe_class != PE_CLASS_UNIV
                                    || p87 -> pe_form != PE_FORM_PRIM
                                    || p87 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "h-mimimum-height bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p87 -> pe_class], p87 -> pe_form, p87 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p87) == NOTOK
                                    && p87 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "h-mimimum-height bad integer: %s",
                                        pe_error (p87 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-height missing h-mimimum-height element");
                        return NOTOK;
                    }

                }

                {
                    register PE p88;

                    if ((p88 = (pe != p86 ? next_member (pe, p86) : first_member (pe))) != NULLPE) {
                        p86 = p88;

                        {	/* h-preferred-height */
#ifdef DEBUG
                            (void) testdebug (p88, "h-preferred-height");
#endif

                            if (p88 -> pe_class != PE_CLASS_UNIV
                                    || p88 -> pe_form != PE_FORM_PRIM
                                    || p88 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "h-preferred-height bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p88 -> pe_class], p88 -> pe_form, p88 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p88) == NOTOK
                                    && p88 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "h-preferred-height bad integer: %s",
                                        pe_error (p88 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-height missing h-preferred-height element");
                        return NOTOK;
                    }

                }


                if (pe -> pe_cardinal > 2) {
                    advise (NULLCP, "picture-height has too many elements(2): %d",
                            pe -> pe_cardinal);
                    return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 2):	/* picture-size */
            {
                register PE p89;

#ifdef DEBUG
                (void) testdebug (pe, "picture-size");
#endif

                if ((p89 = prim2seq (pe)) == NULLPE) {
                    advise (NULLCP, "picture-size bad sequence: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                pe = p89;

                {
                    register PE p90;

                    if ((p90 = first_member (pe)) != NULLPE) {
                        p89 = p90;

                        {	/* s-mimimum-width */
#ifdef DEBUG
                            (void) testdebug (p90, "s-mimimum-width");
#endif

                            if (p90 -> pe_class != PE_CLASS_UNIV
                                    || p90 -> pe_form != PE_FORM_PRIM
                                    || p90 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "s-mimimum-width bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p90 -> pe_class], p90 -> pe_form, p90 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p90) == NOTOK
                                    && p90 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "s-mimimum-width bad integer: %s",
                                        pe_error (p90 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-size missing s-mimimum-width element");
                        return NOTOK;
                    }

                }

                {
                    register PE p91;

                    if ((p91 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) != NULLPE) {
                        p89 = p91;

                        {	/* s-preferred-width */
#ifdef DEBUG
                            (void) testdebug (p91, "s-preferred-width");
#endif

                            if (p91 -> pe_class != PE_CLASS_UNIV
                                    || p91 -> pe_form != PE_FORM_PRIM
                                    || p91 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "s-preferred-width bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p91 -> pe_class], p91 -> pe_form, p91 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p91) == NOTOK
                                    && p91 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "s-preferred-width bad integer: %s",
                                        pe_error (p91 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-size missing s-preferred-width element");
                        return NOTOK;
                    }

                }

                {
                    register PE p92;

                    if ((p92 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) != NULLPE) {
                        p89 = p92;

                        {	/* s-mimimum-height */
#ifdef DEBUG
                            (void) testdebug (p92, "s-mimimum-height");
#endif

                            if (p92 -> pe_class != PE_CLASS_UNIV
                                    || p92 -> pe_form != PE_FORM_PRIM
                                    || p92 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "s-mimimum-height bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p92 -> pe_class], p92 -> pe_form, p92 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p92) == NOTOK
                                    && p92 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "s-mimimum-height bad integer: %s",
                                        pe_error (p92 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-size missing s-mimimum-height element");
                        return NOTOK;
                    }

                }

                {
                    register PE p93;

                    if ((p93 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) != NULLPE) {
                        p89 = p93;

                        {	/* s-preferred-height */
#ifdef DEBUG
                            (void) testdebug (p93, "s-preferred-height");
#endif

                            if (p93 -> pe_class != PE_CLASS_UNIV
                                    || p93 -> pe_form != PE_FORM_PRIM
                                    || p93 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "s-preferred-height bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p93 -> pe_class], p93 -> pe_form, p93 -> pe_id);
                                return NOTOK;
                            }

                            if (prim2num (p93) == NOTOK
                                    && p93 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "s-preferred-height bad integer: %s",
                                        pe_error (p93 -> pe_errno));
                                return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-size missing s-preferred-height element");
                        return NOTOK;
                    }

                }

                {
                    register PE p94;

                    if ((p94 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) != NULLPE) {
                        p89 = p94;

                        {	/* s-aspect-ratio-flag */
                            register int p95;

#ifdef DEBUG
                            (void) testdebug (p94, "s-aspect-ratio-flag");
#endif

                            if (p94 -> pe_class != PE_CLASS_UNIV
                                    || p94 -> pe_form != PE_FORM_PRIM
                                    || p94 -> pe_id != PE_PRIM_INT) {
                                advise (NULLCP, "s-aspect-ratio-flag bad class/form/id: %s/%d/0x%x",
                                        pe_classlist[p94 -> pe_class], p94 -> pe_form, p94 -> pe_id);
                                return NOTOK;
                            }

                            if ((p95 = prim2num (p94)) == NOTOK
                                    && p94 -> pe_errno != PE_ERR_NONE) {
                                advise (NULLCP, "s-aspect-ratio-flag bad integer: %s",
                                        pe_error (p94 -> pe_errno));
                                return NOTOK;
                            }
                            switch (p95) {
                                case 0:	/* fixed */
                                    break;
                                case 1:	/* variable */
                                    break;
                                default:
                                    advise (NULLCP, "s-aspect-ratio-flag has unknown component: %d", p95);
                                    return NOTOK;
                            }
                        }
                    }
                    else {
                        advise (NULLCP, "picture-size missing s-aspect-ratio-flag element");
                        return NOTOK;
                    }

                }


                if (pe -> pe_cardinal > 5) {
                    advise (NULLCP, "picture-size has too many elements(5): %d",
                            pe -> pe_cardinal);
                    return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 3):	/* automatic */
            {
#ifdef DEBUG
                (void) testdebug (pe, "automatic");
#endif

            }
            break;

        default:
            advise (NULLCP, "Picture-Dimensions has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD15_Geo__Gr__Presentation__Attribute (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD15.Geo-Gr-Presentation-Attribute");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_UNIV, 2):
            {
#ifdef DEBUG
                (void) testdebug (pe, "member");
#endif

                if (prim2num (pe) == NOTOK
                        && pe -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "member bad integer: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
            }
            break;

        default:
            advise (NULLCP, "Geo-Gr-Presentation-Attribute has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}
