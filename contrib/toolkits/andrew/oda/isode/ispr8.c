/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISPR8 */
# line 5 "ispr8.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	print_ISPR8_Text__Unit (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p0;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Text-Unit bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Text-Unit bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Text-Unit bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    vpush ();
    {
        register PE p1;

        if ((p1 = first_member (pe)) != NULLPE
                && PE_ID (p1 -> pe_class, p1 -> pe_id)
                        != PE_ID (PE_CLASS_UNIV, 17))
            p1 = NULLPE;
        if (p1 != NULLPE) {
            p0 = p1;

            {	/* content-portion-attributes */
                vname ("content-portion-attributes");
                if (print_ISPR8_Content__Portion__Attributes (p1, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p2;

        if ((p2 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) != NULLPE) {
            p0 = p2;

            {	/* content-information */
                vname ("content-information");
                if (print_ISPR8_Content__Information (p2, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
        else {
            advise (NULLCP, "Text-Unit missing content-information element");
            return NOTOK;
        }

    }

    vpop ();

    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Text-Unit has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	print_ISPR8_Content__Portion__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p3_count = 0;
    register PE p3;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Content-Portion-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Content-Portion-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p3 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Content-Portion-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p3;

    vpush ();
    if (p3 = set_find (pe, PE_CLASS_APPL, 0)) {
        vname ("content-identifier-layout");
        if (print_ISPR3_Content__Portion__Identifier (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 4)) {
        vname ("content-identifier-logical");
        if (print_ISPR3_Content__Portion__Identifier (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if ( (p3 = set_find (pe, PE_CLASS_CONT, 0))
        || (p3 = set_find (pe, PE_CLASS_CONT, 6)) ) {
        vname ("type-of-coding");
        vpush ();
        switch (PE_ID (p3 -> pe_class, p3 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):
                {
                    register int p4;

                    if ((p4 = prim2num (p3)) == NOTOK
                            && p3 -> pe_errno != PE_ERR_NONE) {
                        advise (NULLCP, "member bad integer: %s",
                                pe_error (p3 -> pe_errno));
                        return NOTOK;
                    }
                    switch (p4) {
                        case 0:	/* iso2022 */
                            vprint ("iso2022");
                            break;
                        case 1:	/* t6 */
                            vprint ("t6");
                            break;
                        default:
                            advise (NULLCP, "member has unknown component: %d", p4);
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 6):
                {
                    register OID p5;

                    if ((p5 = prim2oid (p3)) == NULLOID) {
                        advise (NULLCP, "member bad object identifier: %s",
                                pe_error (p3 -> pe_errno));
                        return NOTOK;
                    }
                    vprint ("%s", oid2ode (p5));
                }
                break;

            default:
                advise (NULLCP, "type-of-coding has unknown choice: %s/%d/0x%x",
                        pe_classlist[p3 -> pe_class], p3 -> pe_form, p3 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p3_count ++;
    }
    if ( (p3 = set_find (pe, PE_CLASS_CONT, 1))
        || (p3 = set_find (pe, PE_CLASS_CONT, 2))
        || (p3 = set_find (pe, PE_CLASS_CONT, 7))
        || (p3 = set_find (pe, PE_CLASS_CONT, 11)) ) {
        vname ("coding-attributes");
        vpush ();
        switch (PE_ID (p3 -> pe_class, p3 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 1):	/* character-coding-attributes */
                {
                    vname ("character-coding-attributes");
                    if (print_ISPR10_Character__Coding__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 2):	/* raster-gr-coding-attributes */
                {
                    vname ("raster-gr-coding-attributes");
                    if (print_ISPR13_Raster__Gr__Coding__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 7):	/* geo-gr-coding-attributes */
                {
                    vname ("geo-gr-coding-attributes");
                    if (print_ISPR16_Geo__Gr__Coding__Attributes (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 11):	/* ext-cont-arch-coding-attributes */
                {
                    vname ("ext-cont-arch-coding-attributes");
                    if (print_UNIV_EXTERNAL (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;

            default:
                advise (NULLCP, "coding-attributes has unknown choice: %s/%d/0x%x",
                        pe_classlist[p3 -> pe_class], p3 -> pe_form, p3 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p3_count ++;
    }
    if (p3 = set_find (pe, PE_CLASS_CONT, 3)) {
        vname ("alternative-representation");
        if (print_ISPR8_Alternative__Representation (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p3_count ++;
    }
    if (p3_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR8_Content__Information (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p6;
    int p6_len;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "Content-Information bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p6 = prim2str (pe, &p6_len)) == NULLCP) {
        advise (NULLCP, "Content-Information bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    vstring (pe);
    if (len)
        *len = p6_len;
    if (buffer)
        *buffer = p6;
    else
        if (p6)
            free (p6);

    return OK;
}

/* ARGSUSED */

int	print_ISPR8_Type__of__Coding (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    vpush ();
    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_CONT, 0):
            {
                register int p7;

                if ((p7 = prim2num (pe)) == NOTOK
                        && pe -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "member bad integer: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                switch (p7) {
                    case 0:	/* iso2022 */
                        vprint ("iso2022");
                        break;
                    case 1:	/* t6 */
                        vprint ("t6");
                        break;
                    default:
                        advise (NULLCP, "member has unknown component: %d", p7);
                        return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 6):
            {
                register OID p8;

                if ((p8 = prim2oid (pe)) == NULLOID) {
                    advise (NULLCP, "member bad object identifier: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                vprint ("%s", oid2ode (p8));
            }
            break;

        default:
            advise (NULLCP, "Type-of-Coding has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR8_Alternative__Representation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p9;
    int p9_len;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV || pe -> pe_id != PE_PRIM_OCTS) {
            advise (NULLCP, "Alternative-Representation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }

    if ((p9 = prim2str (pe, &p9_len)) == NULLCP) {
        advise (NULLCP, "Alternative-Representation bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    vstring (pe);
    if (len)
        *len = p9_len;
    if (buffer)
        *buffer = p9;
    else
        if (p9)
            free (p9);

    return OK;
}
