/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISRD9 */
# line 5 "isrd9.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */

#include <odatk.h>

#define TK_IMPL_ISRD

#include <isrd.h>

#undef TK_IMPL_ISRD

#define PEPYPARM struct isode2toolkit_t *


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	parse_ISRD9_Character__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p0_count = 0;
    register PE p0;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Character-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Character-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Character-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Character-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    if (p0 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p0, "character-path");
#endif

        if (parse_ISRD9_One__Of__Four__Angles (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p0, "line-progression");
#endif

        if (parse_ISRD9_One__Of__Two__Angles (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p0, "character-orientation");
#endif

        if (parse_ISRD9_One__Of__Four__Angles (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p0, "initial-offset");
#endif

        if (parse_ISRD4_Measure__Pair (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p0, "character-spacing");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "character-spacing bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p0, "line-spacing");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "line-spacing bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 8)) {
#ifdef DEBUG
        (void) testdebug (p0, "alignment");
#endif

        if (parse_ISRD9_Alignment (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 9)) {
#ifdef DEBUG
        (void) testdebug (p0, "line-layout-table");
#endif

        if (parse_ISRD9_Layout__Table (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 10)) {
#ifdef DEBUG
        (void) testdebug (p0, "graphic-rendition");
#endif

        if (parse_ISRD9_Graphic__Rendition (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 11)) {
#ifdef DEBUG
        (void) testdebug (p0, "formatting-indicator");
#endif

        if (parse_ISRD9_Formatting__Indicator (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 12)) {
#ifdef DEBUG
        (void) testdebug (p0, "charcter-fonts");
#endif

        if (parse_ISRD9_Character__Fonts (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 13)) {
#ifdef DEBUG
        (void) testdebug (p0, "graphic-char-subrepertoire");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "graphic-char-subrepertoire bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 14)) {
#ifdef DEBUG
        (void) testdebug (p0, "itemisation");
#endif

        if (parse_ISRD9_Itemisation (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 15)) {
#ifdef DEBUG
        (void) testdebug (p0, "widow-size");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "widow-size bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 16)) {
#ifdef DEBUG
        (void) testdebug (p0, "orphan-size");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "orphan-size bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 17)) {
#ifdef DEBUG
        (void) testdebug (p0, "graphic-character-sets");
#endif

        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 19)) {
#ifdef DEBUG
        (void) testdebug (p0, "indentation");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "indentation bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 20)) {
#ifdef DEBUG
        (void) testdebug (p0, "kerning-offset");
#endif

        if (parse_ISRD9_Kerning__Offset (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 21)) {
#ifdef DEBUG
        (void) testdebug (p0, "proportional-line-spacing");
#endif

        if (parse_ISRD9_Proportional__Line__Spacing (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 22)) {
#ifdef DEBUG
        (void) testdebug (p0, "pairwise-kerning");
#endif

        if (parse_ISRD9_Pairwise__Kerning (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 23)) {
#ifdef DEBUG
        (void) testdebug (p0, "first-line-offset");
#endif

        if (prim2num (p0) == NOTOK
                && p0 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "first-line-offset bad integer: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 24)) {
#ifdef DEBUG
        (void) testdebug (p0, "code-extension-announcers");
#endif

        p0_count ++;
    }
    if (p0_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_One__Of__Four__Angles (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p1;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.One-Of-Four-Angles");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "One-Of-Four-Angles bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "One-Of-Four-Angles bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p1 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "One-Of-Four-Angles bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p1;
    switch (p1) {
        case 0:	/* d0 */
            break;
        case 1:	/* d90 */
            break;
        case 2:	/* d180 */
            break;
        case 3:	/* d270 */
            break;
        default:
            advise (NULLCP, "One-Of-Four-Angles has unknown component: %d", p1);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_One__Of__Two__Angles (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p2;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.One-Of-Two-Angles");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "One-Of-Two-Angles bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "One-Of-Two-Angles bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p2 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "One-Of-Two-Angles bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p2;
    switch (p2) {
        case 1:	/* d90 */
            break;
        case 3:	/* d270 */
            break;
        default:
            advise (NULLCP, "One-Of-Two-Angles has unknown component: %d", p2);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Alignment (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p3;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Alignment");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Alignment bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Alignment bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p3 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Alignment bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p3;
    switch (p3) {
        case 0:	/* start-aligned */
            break;
        case 1:	/* end-aligned */
            break;
        case 2:	/* centred */
            break;
        case 3:	/* justified */
            break;
        default:
            advise (NULLCP, "Alignment has unknown component: %d", p3);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Layout__Table (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p4;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Layout-Table");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Layout-Table bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Layout-Table bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p4 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Layout-Table bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p4;

    for (p4 = first_member (pe); p4; p4 = next_member (pe, p4)) {
#ifdef DEBUG
        (void) testdebug (p4, "member");
#endif

        if (parse_ISRD9_Tabulation__Stop (p4, 1, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Tabulation__Stop (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p5_count = 0;
    register PE p5;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Tabulation-Stop");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Tabulation-Stop bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Tabulation-Stop bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p5 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Tabulation-Stop bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p5;

    if (p5 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p5, "tabulation-reference");
#endif

        if (parse_UNIV_NumericString (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p5_count ++;
    }
    else {
        advise (NULLCP, "tabulation-reference missing tabulation-reference member");
        return NOTOK;
    }

    if (p5 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p5, "tabulation-position");
#endif

        if (prim2num (p5) == NOTOK
                && p5 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "tabulation-position bad integer: %s",
                    pe_error (p5 -> pe_errno));
            return NOTOK;
        }
        p5_count ++;
    }
    else {
        advise (NULLCP, "tabulation-position missing tabulation-position member");
        return NOTOK;
    }

    if (p5 = set_find (pe, PE_CLASS_CONT, 2)) {
        register int p6;

#ifdef DEBUG
        (void) testdebug (p5, "alignment");
#endif

        if ((p6 = prim2num (p5)) == NOTOK
                && p5 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "alignment bad integer: %s",
                    pe_error (p5 -> pe_errno));
            return NOTOK;
        }
        switch (p6) {
            case 0:	/* start-aligned */
                break;
            case 1:	/* end-aligned */
                break;
            case 2:	/* centred-1 */
                break;
            case 3:	/* round-aligned */
                break;
            default:
                advise (NULLCP, "alignment has unknown component: %d", p6);
                return NOTOK;
        }
        p5_count ++;
    }
    else {
        advise (NULLCP, "alignment missing alignment member");
        return NOTOK;
    }

    if (p5 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p5, "alignment-character-string");
#endif

        p5_count ++;
    }
    if (p5_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Graphic__Rendition (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p7;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Graphic-Rendition");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Graphic-Rendition bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Graphic-Rendition bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p7 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Graphic-Rendition bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p7;

    for (p7 = first_member (pe); p7; p7 = next_member (pe, p7)) {
#ifdef DEBUG
        (void) testdebug (p7, "member");
#endif

        if (parse_ISRD9_Graphic__Rendition__Aspect (p7, 1, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Character__Fonts (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p8_count = 0;
    register PE p8;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Character-Fonts");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Character-Fonts bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Character-Fonts bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p8 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Character-Fonts bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p8;

    if (p8 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p8, "primary-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p8, "first-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p8, "second-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p8, "third-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p8, "fourth-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p8, "fifth-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p8, "sixth-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p8, "seventh-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 8)) {
#ifdef DEBUG
        (void) testdebug (p8, "eighth-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8 = set_find (pe, PE_CLASS_CONT, 9)) {
#ifdef DEBUG
        (void) testdebug (p8, "ninth-alternative-font");
#endif

        if (parse_ISRD9_Font__Type (p8, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p8_count ++;
    }
    if (p8_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Font__Type (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p9_count = 0;
    register PE p9;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Font-Type");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Font-Type bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Font-Type bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p9 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Font-Type bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p9;

    if (p9 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p9, "font-size");
#endif

        if (prim2num (p9) == NOTOK
                && p9 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "font-size bad integer: %s",
                    pe_error (p9 -> pe_errno));
            return NOTOK;
        }
        p9_count ++;
    }
    else {
        advise (NULLCP, "font-size missing font-size member");
        return NOTOK;
    }

    if (p9 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p9, "font-identifier");
#endif

        if (prim2num (p9) == NOTOK
                && p9 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "font-identifier bad integer: %s",
                    pe_error (p9 -> pe_errno));
            return NOTOK;
        }
        p9_count ++;
    }
    else {
        advise (NULLCP, "font-identifier missing font-identifier member");
        return NOTOK;
    }

    if (p9_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Graphic__Rendition__Aspect (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p10;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Graphic-Rendition-Aspect");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Graphic-Rendition-Aspect bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Graphic-Rendition-Aspect bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p10 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Graphic-Rendition-Aspect bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p10;
    switch (p10) {
        case 0:	/* cancel */
            break;
        case 1:	/* increased-intensity */
            break;
        case 2:	/* decreased-intensity */
            break;
        case 3:	/* italicized */
            break;
        case 4:	/* underlined */
            break;
        case 5:	/* slowly-blinking */
            break;
        case 6:	/* rapidly-blinking */
            break;
        case 7:	/* negative-image */
            break;
        case 9:	/* crossed-out */
            break;
        case 10:	/* primary-font */
            break;
        case 11:	/* first-alternative-font */
            break;
        case 12:	/* second-alternative-font */
            break;
        case 13:	/* third-alternative-font */
            break;
        case 14:	/* fourth-alternative-font */
            break;
        case 15:	/* fifth-alternative-font */
            break;
        case 16:	/* sixth-alternative-font */
            break;
        case 17:	/* seventh-alternative-font */
            break;
        case 18:	/* eighth-alternative-font */
            break;
        case 19:	/* ninth-alternative-font */
            break;
        case 21:	/* doubly-underlined */
            break;
        case 22:	/* normal-intensity */
            break;
        case 23:	/* not-italicized */
            break;
        case 24:	/* not-underlined */
            break;
        case 25:	/* steady */
            break;
        case 26:	/* variable-spacing */
            break;
        case 27:	/* positive-image */
            break;
        case 29:	/* not-crossed-out */
            break;
        default:
            advise (NULLCP, "Graphic-Rendition-Aspect has unknown component: %d", p10);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Formatting__Indicator (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p11;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Formatting-Indicator");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Formatting-Indicator bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Formatting-Indicator bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p11 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Formatting-Indicator bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p11;
    switch (p11) {
        case 0:	/* no */
            break;
        case 1:	/* yes */
            break;
        default:
            advise (NULLCP, "Formatting-Indicator has unknown component: %d", p11);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Itemisation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p12_count = 0;
    register PE p12;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Itemisation");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Itemisation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Itemisation bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p12 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Itemisation bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p12;

    if (p12 = set_find (pe, PE_CLASS_CONT, 0)) {
        register int p13;

#ifdef DEBUG
        (void) testdebug (p12, "identifier-alignment");
#endif

        if ((p13 = prim2num (p12)) == NOTOK
                && p12 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "identifier-alignment bad integer: %s",
                    pe_error (p12 -> pe_errno));
            return NOTOK;
        }
        switch (p13) {
            case 0:	/* no-itemisation */
                break;
            case 1:	/* start-aligned */
                break;
            case 2:	/* end-aligned */
                break;
            default:
                advise (NULLCP, "identifier-alignment has unknown component: %d", p13);
                return NOTOK;
        }
        p12_count ++;
    }
    else {
        advise (NULLCP, "identifier-alignment missing identifier-alignment member");
        return NOTOK;
    }

    if (p12 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p12, "identifier-start-offset");
#endif

        if (prim2num (p12) == NOTOK
                && p12 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "identifier-start-offset bad integer: %s",
                    pe_error (p12 -> pe_errno));
            return NOTOK;
        }
        p12_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p12 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p12, "identifier-end-offset");
#endif

        if (prim2num (p12) == NOTOK
                && p12 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "identifier-end-offset bad integer: %s",
                    pe_error (p12 -> pe_errno));
            return NOTOK;
        }
        p12_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p12_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Kerning__Offset (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p14_count = 0;
    register PE p14;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Kerning-Offset");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Kerning-Offset bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Kerning-Offset bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p14 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Kerning-Offset bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p14;

    if (p14 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p14, "start-offset");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "start-offset bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        advise (NULLCP, "start-offset missing start-offset member");
        return NOTOK;
    }

    if (p14 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p14, "end-offset");
#endif

        if (prim2num (p14) == NOTOK
                && p14 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "end-offset bad integer: %s",
                    pe_error (p14 -> pe_errno));
            return NOTOK;
        }
        p14_count ++;
    }
    else {
        advise (NULLCP, "end-offset missing end-offset member");
        return NOTOK;
    }

    if (p14_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Proportional__Line__Spacing (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p15;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Proportional-Line-Spacing");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Proportional-Line-Spacing bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Proportional-Line-Spacing bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p15 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Proportional-Line-Spacing bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p15;
    switch (p15) {
        case 0:	/* no */
            break;
        case 1:	/* yes */
            break;
        default:
            advise (NULLCP, "Proportional-Line-Spacing has unknown component: %d", p15);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD9_Pairwise__Kerning (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p16;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD9.Pairwise-Kerning");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Pairwise-Kerning bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Pairwise-Kerning bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p16 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Pairwise-Kerning bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p16;
    switch (p16) {
        case 0:	/* no */
            break;
        case 1:	/* yes */
            break;
        default:
            advise (NULLCP, "Pairwise-Kerning has unknown component: %d", p16);
            return NOTOK;
    }

    return OK;
}
