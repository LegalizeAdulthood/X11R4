/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISRD18 */
# line 4 "isrd18.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */

#include <odatk.h>

#define TK_IMPL_ISRD

#include <isrd.h>

#undef TK_IMPL_ISRD

#define PEPYPARM struct isode2toolkit_t *


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	parse_ISRD18_Font__Reference (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
struct isode2toolkit_t *  parm;
{
    register PE p0;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Font-Reference");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Font-Reference bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Font-Reference bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Font-Reference bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    {
        register PE p1;

        if ((p1 = first_member (pe)) != NULLPE
                && PE_ID (p1 -> pe_class, p1 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p1 = NULLPE;
        if (p1 != NULLPE) {
            p0 = p1;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p1, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p2;

        if ((p2 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p2 -> pe_class, p2 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p2 = NULLPE;
        if (p2 != NULLPE) {
            p0 = p2;

            {	/* font-name */
#ifdef DEBUG
                (void) testdebug (p2, "font-name");
#endif

                if (parse_ISRD18_Structured__Name (p2, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p3;

        if ((p3 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p3 -> pe_class, p3 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p3 = NULLPE;
        if (p3 != NULLPE) {
            p0 = p3;

            {	/* device-independent-font-name */
#ifdef DEBUG
                (void) testdebug (p3, "device-independent-font-name");
#endif

                if (parse_ISRD18_Structured__Name (p3, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p4;

        if ((p4 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p4 -> pe_class, p4 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p4 = NULLPE;
        if (p4 != NULLPE) {
            p0 = p4;

            {	/* proprietary-data-indicator */
#ifdef DEBUG
                (void) testdebug (p4, "proprietary-data-indicator");
#endif

                if (prim2num (p4) == NOTOK
                        && p4 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "proprietary-data-indicator bad integer: %s",
                            pe_error (p4 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p5;

        if ((p5 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p5 -> pe_class, p5 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 4))
            p5 = NULLPE;
        if (p5 != NULLPE) {
            p0 = p5;

            {	/* typeface-name */
#ifdef DEBUG
                (void) testdebug (p5, "typeface-name");
#endif

                if (parse_ISRD18_Structured__Name (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p6;

        if ((p6 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p6 -> pe_class, p6 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 5))
            p6 = NULLPE;
        if (p6 != NULLPE) {
            p0 = p6;

            {	/* family-name */
#ifdef DEBUG
                (void) testdebug (p6, "family-name");
#endif

                if (parse_ISRD18_Structured__Name (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p7;

        if ((p7 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p7 -> pe_class, p7 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 6))
            p7 = NULLPE;
        if (p7 != NULLPE) {
            p0 = p7;

            {	/* posture */
#ifdef DEBUG
                (void) testdebug (p7, "posture");
#endif

                if (prim2num (p7) == NOTOK
                        && p7 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "posture bad integer: %s",
                            pe_error (p7 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p8;

        if ((p8 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p8 -> pe_class, p8 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 7))
            p8 = NULLPE;
        if (p8 != NULLPE) {
            p0 = p8;

            {	/* weight */
#ifdef DEBUG
                (void) testdebug (p8, "weight");
#endif

                if (prim2num (p8) == NOTOK
                        && p8 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "weight bad integer: %s",
                            pe_error (p8 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p9;

        if ((p9 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p9 -> pe_class, p9 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 8))
            p9 = NULLPE;
        if (p9 != NULLPE) {
            p0 = p9;

            {	/* proportionate-width */
#ifdef DEBUG
                (void) testdebug (p9, "proportionate-width");
#endif

                if (prim2num (p9) == NOTOK
                        && p9 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "proportionate-width bad integer: %s",
                            pe_error (p9 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p10;

        if ((p10 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p10 -> pe_class, p10 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 9))
            p10 = NULLPE;
        if (p10 != NULLPE) {
            p0 = p10;

            {	/* character-complement */
#ifdef DEBUG
                (void) testdebug (p10, "character-complement");
#endif

                if (parse_ISRD18_Character__Complement (p10, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p11;

        if ((p11 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p11 -> pe_class, p11 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 10))
            p11 = NULLPE;
        if (p11 != NULLPE) {
            p0 = p11;

            {	/* number-of-characters */
#ifdef DEBUG
                (void) testdebug (p11, "number-of-characters");
#endif

                if (prim2num (p11) == NOTOK
                        && p11 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "number-of-characters bad integer: %s",
                            pe_error (p11 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p12;

        if ((p12 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p12 -> pe_class, p12 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 11))
            p12 = NULLPE;
        if (p12 != NULLPE) {
            p0 = p12;

            {	/* ligature-table */
#ifdef DEBUG
                (void) testdebug (p12, "ligature-table");
#endif

                if (parse_ISRD18_Ligature__Table (p12, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p13;

        if ((p13 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p13 -> pe_class, p13 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 12))
            p13 = NULLPE;
        if (p13 != NULLPE) {
            p0 = p13;

            {	/* design-size */
#ifdef DEBUG
                (void) testdebug (p13, "design-size");
#endif

                if (parse_ISRD18_Real (p13, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p14;

        if ((p14 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p14 -> pe_class, p14 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 13))
            p14 = NULLPE;
        if (p14 != NULLPE) {
            p0 = p14;

            {	/* minimum-size */
#ifdef DEBUG
                (void) testdebug (p14, "minimum-size");
#endif

                if (parse_ISRD18_Real (p14, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p15;

        if ((p15 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p15 -> pe_class, p15 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 14))
            p15 = NULLPE;
        if (p15 != NULLPE) {
            p0 = p15;

            {	/* maximum-size */
#ifdef DEBUG
                (void) testdebug (p15, "maximum-size");
#endif

                if (parse_ISRD18_Real (p15, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p16;

        if ((p16 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p16 -> pe_class, p16 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 15))
            p16 = NULLPE;
        if (p16 != NULLPE) {
            p0 = p16;

            {	/* design-classification */
                register PE p17;

#ifdef DEBUG
                (void) testdebug (p16, "design-classification");
#endif

                if ((p17 = prim2seq (p16)) == NULLPE) {
                    advise (NULLCP, "design-classification bad sequence: %s",
                            pe_error (p16 -> pe_errno));
                    return NOTOK;
                }
                p16 = p17;

                for (p17 = first_member (p16); p17; p17 = next_member (p16, p17)) {
#ifdef DEBUG
                    (void) testdebug (p17, "element");
#endif

                    if (p17 -> pe_class != PE_CLASS_UNIV
                            || p17 -> pe_form != PE_FORM_PRIM
                            || p17 -> pe_id != PE_PRIM_INT) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p17 -> pe_class], p17 -> pe_form, p17 -> pe_id);
                        return NOTOK;
                    }

                    if (prim2num (p17) == NOTOK
                            && p17 -> pe_errno != PE_ERR_NONE) {
                        advise (NULLCP, "element bad integer: %s",
                                pe_error (p17 -> pe_errno));
                        return NOTOK;
                    }
                }
            }
        }
    }

    {
        register PE p18;

        if ((p18 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p18 -> pe_class, p18 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 16))
            p18 = NULLPE;
        if (p18 != NULLPE) {
            p0 = p18;

            {	/* structure */
#ifdef DEBUG
                (void) testdebug (p18, "structure");
#endif

                if (prim2num (p18) == NOTOK
                        && p18 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "structure bad integer: %s",
                            pe_error (p18 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p19;

        if ((p19 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p19 -> pe_class, p19 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 17))
            p19 = NULLPE;
        if (p19 != NULLPE) {
            p0 = p19;

            {	/* minimum-feature-size */
#ifdef DEBUG
                (void) testdebug (p19, "minimum-feature-size");
#endif

                if (parse_ISRD18_Real (p19, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p20;

        if ((p20 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p20 -> pe_class, p20 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 18))
            p20 = NULLPE;
        if (p20 != NULLPE) {
            p0 = p20;

            {	/* writing-modes */
#ifdef DEBUG
                (void) testdebug (p20, "writing-modes");
#endif

                if (parse_ISRD18_Writing__Modes (p20, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p21;

        if ((p21 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p21 -> pe_class, p21 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 19))
            p21 = NULLPE;
        if (p21 != NULLPE) {
            p0 = p21;

            {	/* writing-mode */
#ifdef DEBUG
                (void) testdebug (p21, "writing-mode");
#endif

                if (parse_ISRD18_Structured__Name (p21, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p22;

        if ((p22 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p22 -> pe_class, p22 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 20))
            p22 = NULLPE;
        if (p22 != NULLPE) {
            p0 = p22;

            {	/* character-shape-technologies */
#ifdef DEBUG
                (void) testdebug (p22, "character-shape-technologies");
#endif

                if (parse_ISRD18_Character__Shape__Technologies (p22, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p23;

        if ((p23 = (pe != p0 ? next_member (pe, p0) : first_member (pe))) != NULLPE) {
            p0 = p23;

            {	/* non-ISO-attributes */
                register PE p24;

#ifdef DEBUG
                (void) testdebug (p23, "non-ISO-attributes");
#endif

                if ((p24 = prim2set (p23)) == NULLPE) {
                    advise (NULLCP, "non-ISO-attributes bad set: %s",
                            pe_error (p23 -> pe_errno));
                    return NOTOK;
                }
                p23 = p24;

                for (p24 = first_member (p23); p24; p24 = next_member (p23, p24)) {
#ifdef DEBUG
                    (void) testdebug (p24, "member");
#endif

                    if (parse_ISRD18_Non__ISO__Attribute (p24, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }


    if (pe -> pe_cardinal > 22) {
        advise (NULLCP, "Font-Reference has too many elements(22): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Character__Complement (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p25;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Character-Complement");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Character-Complement bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Character-Complement bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p25 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Character-Complement bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p25;

    {
        register PE p26;

        if ((p26 = first_member (pe)) != NULLPE
                && PE_ID (p26 -> pe_class, p26 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p26 = NULLPE;
        if (p26 != NULLPE) {
            p25 = p26;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p26, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p26, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p27;

        if ((p27 = (pe != p25 ? next_member (pe, p25) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p27 -> pe_class, p27 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p27 = NULLPE;
        if (p27 != NULLPE) {
            p25 = p27;

            {	/* included-character-collections */
                register PE p28;

#ifdef DEBUG
                (void) testdebug (p27, "included-character-collections");
#endif

                if ((p28 = prim2set (p27)) == NULLPE) {
                    advise (NULLCP, "included-character-collections bad set: %s",
                            pe_error (p27 -> pe_errno));
                    return NOTOK;
                }
                p27 = p28;

                for (p28 = first_member (p27); p28; p28 = next_member (p27, p28)) {
#ifdef DEBUG
                    (void) testdebug (p28, "member");
#endif

                    if (parse_ISRD18_Structured__Name (p28, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }

    {
        register PE p29;

        if ((p29 = (pe != p25 ? next_member (pe, p25) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p29 -> pe_class, p29 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p29 = NULLPE;
        if (p29 != NULLPE) {
            p25 = p29;

            {	/* excluded-character-collections */
                register PE p30;

#ifdef DEBUG
                (void) testdebug (p29, "excluded-character-collections");
#endif

                if ((p30 = prim2set (p29)) == NULLPE) {
                    advise (NULLCP, "excluded-character-collections bad set: %s",
                            pe_error (p29 -> pe_errno));
                    return NOTOK;
                }
                p29 = p30;

                for (p30 = first_member (p29); p30; p30 = next_member (p29, p30)) {
#ifdef DEBUG
                    (void) testdebug (p30, "member");
#endif

                    if (parse_ISRD18_Structured__Name (p30, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }

    {
        register PE p31;

        if ((p31 = (pe != p25 ? next_member (pe, p25) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p31 -> pe_class, p31 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p31 = NULLPE;
        if (p31 != NULLPE) {
            p25 = p31;

            {	/* included-characters */
                register PE p32;

#ifdef DEBUG
                (void) testdebug (p31, "included-characters");
#endif

                if ((p32 = prim2set (p31)) == NULLPE) {
                    advise (NULLCP, "included-characters bad set: %s",
                            pe_error (p31 -> pe_errno));
                    return NOTOK;
                }
                p31 = p32;

                for (p32 = first_member (p31); p32; p32 = next_member (p31, p32)) {
#ifdef DEBUG
                    (void) testdebug (p32, "member");
#endif

                    if (parse_ISRD18_Structured__Name (p32, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }

    {
        register PE p33;

        if ((p33 = (pe != p25 ? next_member (pe, p25) : first_member (pe))) != NULLPE) {
            p25 = p33;

            {	/* excluded-characters */
                register PE p34;

#ifdef DEBUG
                (void) testdebug (p33, "excluded-characters");
#endif

                if ((p34 = prim2set (p33)) == NULLPE) {
                    advise (NULLCP, "excluded-characters bad set: %s",
                            pe_error (p33 -> pe_errno));
                    return NOTOK;
                }
                p33 = p34;

                for (p34 = first_member (p33); p34; p34 = next_member (p33, p34)) {
#ifdef DEBUG
                    (void) testdebug (p34, "member");
#endif

                    if (parse_ISRD18_Structured__Name (p34, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }


    if (pe -> pe_cardinal > 5) {
        advise (NULLCP, "Character-Complement has too many elements(5): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Ligature__Table (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p35;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Ligature-Table");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Ligature-Table bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Ligature-Table bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p35 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Ligature-Table bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p35;

    {
        register PE p36;

        if ((p36 = first_member (pe)) != NULLPE
                && PE_ID (p36 -> pe_class, p36 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p36 = NULLPE;
        if (p36 != NULLPE) {
            p35 = p36;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p36, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p36, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p37;

        if ((p37 = (pe != p35 ? next_member (pe, p35) : first_member (pe))) != NULLPE) {
            p35 = p37;

            {	/* ligatures */
                register PE p38;

#ifdef DEBUG
                (void) testdebug (p37, "ligatures");
#endif

                if ((p38 = prim2set (p37)) == NULLPE) {
                    advise (NULLCP, "ligatures bad set: %s",
                            pe_error (p37 -> pe_errno));
                    return NOTOK;
                }
                p37 = p38;

                for (p38 = first_member (p37); p38; p38 = next_member (p37, p38)) {
#ifdef DEBUG
                    (void) testdebug (p38, "member");
#endif

                    if (parse_ISRD18_Ligature (p38, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
        else {
            advise (NULLCP, "Ligature-Table missing ligatures element");
            return NOTOK;
        }

    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Ligature-Table has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Ligature (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p39;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Ligature");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Ligature bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Ligature bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p39 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Ligature bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p39;

    {
        register PE p40;

        if ((p40 = first_member (pe)) != NULLPE
                && PE_ID (p40 -> pe_class, p40 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p40 = NULLPE;
        if (p40 != NULLPE) {
            p39 = p40;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p40, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p40, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p41;

        if ((p41 = (pe != p39 ? next_member (pe, p39) : first_member (pe))) != NULLPE) {
            p39 = p41;

            {	/* ligature-character */
#ifdef DEBUG
                (void) testdebug (p41, "ligature-character");
#endif

                if (parse_ISRD18_Structured__Name (p41, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
        else {
            advise (NULLCP, "Ligature missing ligature-character element");
            return NOTOK;
        }

    }

    {
        register PE p42;

        if ((p42 = (pe != p39 ? next_member (pe, p39) : first_member (pe))) != NULLPE) {
            p39 = p42;

            {	/* equivalent-characters */
                register PE p43;

#ifdef DEBUG
                (void) testdebug (p42, "equivalent-characters");
#endif

                if ((p43 = prim2seq (p42)) == NULLPE) {
                    advise (NULLCP, "equivalent-characters bad sequence: %s",
                            pe_error (p42 -> pe_errno));
                    return NOTOK;
                }
                p42 = p43;

                for (p43 = first_member (p42); p43; p43 = next_member (p42, p43)) {
#ifdef DEBUG
                    (void) testdebug (p43, "element");
#endif

                    if (parse_ISRD18_Structured__Name (p43, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
        else {
            advise (NULLCP, "Ligature missing equivalent-characters element");
            return NOTOK;
        }

    }


    if (pe -> pe_cardinal > 3) {
        advise (NULLCP, "Ligature has too many elements(3): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Writing__Modes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p44;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Writing-Modes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Writing-Modes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Writing-Modes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p44 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Writing-Modes bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p44;

    {
        register PE p45;

        if ((p45 = first_member (pe)) != NULLPE
                && PE_ID (p45 -> pe_class, p45 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p45 = NULLPE;
        if (p45 != NULLPE) {
            p44 = p45;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p45, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p45, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p46;

        if ((p46 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p46 -> pe_class, p46 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p46 = NULLPE;
        if (p46 != NULLPE) {
            p44 = p46;

            {	/* iso-0 */
#ifdef DEBUG
                (void) testdebug (p46, "iso-0");
#endif

                if (parse_ISRD18_Modal__Font__Attributes (p46, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p47;

        if ((p47 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p47 -> pe_class, p47 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p47 = NULLPE;
        if (p47 != NULLPE) {
            p44 = p47;

            {	/* iso-180 */
#ifdef DEBUG
                (void) testdebug (p47, "iso-180");
#endif

                if (parse_ISRD18_Modal__Font__Attributes (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p48;

        if ((p48 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p48 -> pe_class, p48 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p48 = NULLPE;
        if (p48 != NULLPE) {
            p44 = p48;

            {	/* iso-270 */
#ifdef DEBUG
                (void) testdebug (p48, "iso-270");
#endif

                if (parse_ISRD18_Modal__Font__Attributes (p48, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p49;

        if ((p49 = (pe != p44 ? next_member (pe, p44) : first_member (pe))) != NULLPE) {
            p44 = p49;

            {	/* non-ISO-modes */
                register PE p50;

#ifdef DEBUG
                (void) testdebug (p49, "non-ISO-modes");
#endif

                if ((p50 = prim2set (p49)) == NULLPE) {
                    advise (NULLCP, "non-ISO-modes bad set: %s",
                            pe_error (p49 -> pe_errno));
                    return NOTOK;
                }
                p49 = p50;

                for (p50 = first_member (p49); p50; p50 = next_member (p49, p50)) {
                    register PE p51;

#ifdef DEBUG
                    (void) testdebug (p50, "member");
#endif

                    if (p50 -> pe_class != PE_CLASS_UNIV
                            || p50 -> pe_form != PE_FORM_CONS
                            || p50 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p50 -> pe_class], p50 -> pe_form, p50 -> pe_id);
                        return NOTOK;
                    }

                    if ((p51 = prim2seq (p50)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p50 -> pe_errno));
                        return NOTOK;
                    }
                    p50 = p51;

                    {
                        register PE p52;

                        if ((p52 = first_member (p50)) != NULLPE) {
                            p51 = p52;

                            {	/* mode-name */
#ifdef DEBUG
                                (void) testdebug (p52, "mode-name");
#endif

                                if (parse_ISRD18_Structured__Name (p52, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing mode-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p53;

                        if ((p53 = (p50 != p51 ? next_member (p50, p51) : first_member (p50))) != NULLPE) {
                            p51 = p53;

                            {	/* mode-attributes */
#ifdef DEBUG
                                (void) testdebug (p53, "mode-attributes");
#endif

                                if (parse_ISRD18_Modal__Font__Attributes (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing mode-attributes element");
                            return NOTOK;
                        }

                    }


                    if (p50 -> pe_cardinal > 2) {
                        advise (NULLCP, "member has too many elements(2): %d",
                                p50 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 5) {
        advise (NULLCP, "Writing-Modes has too many elements(5): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Modal__Font__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p54;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Modal-Font-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Modal-Font-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Modal-Font-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p54 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Modal-Font-Attributes bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p54;

    {
        register PE p55;

        if ((p55 = first_member (pe)) != NULLPE
                && PE_ID (p55 -> pe_class, p55 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p55 = NULLPE;
        if (p55 != NULLPE) {
            p54 = p55;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p55, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p55, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p56;

        if ((p56 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p56 -> pe_class, p56 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p56 = NULLPE;
        if (p56 != NULLPE) {
            p54 = p56;

            {	/* escapement-direction */
#ifdef DEBUG
                (void) testdebug (p56, "escapement-direction");
#endif

                if (parse_ISRD18_Real (p56, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p57;

        if ((p57 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p57 -> pe_class, p57 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p57 = NULLPE;
        if (p57 != NULLPE) {
            p54 = p57;

            {	/* escapement-class */
#ifdef DEBUG
                (void) testdebug (p57, "escapement-class");
#endif

                if (prim2num (p57) == NOTOK
                        && p57 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "escapement-class bad integer: %s",
                            pe_error (p57 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p58;

        if ((p58 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p58 -> pe_class, p58 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p58 = NULLPE;
        if (p58 != NULLPE) {
            p54 = p58;

            {	/* average-escapement */
#ifdef DEBUG
                (void) testdebug (p58, "average-escapement");
#endif

                if (parse_ISRD18_Real (p58, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p59;

        if ((p59 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p59 -> pe_class, p59 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 4))
            p59 = NULLPE;
        if (p59 != NULLPE) {
            p54 = p59;

            {	/* average-lower-case-escapement */
#ifdef DEBUG
                (void) testdebug (p59, "average-lower-case-escapement");
#endif

                if (parse_ISRD18_Real (p59, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p60;

        if ((p60 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p60 -> pe_class, p60 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 5))
            p60 = NULLPE;
        if (p60 != NULLPE) {
            p54 = p60;

            {	/* average-capital-escapement */
#ifdef DEBUG
                (void) testdebug (p60, "average-capital-escapement");
#endif

                if (parse_ISRD18_Real (p60, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p61;

        if ((p61 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p61 -> pe_class, p61 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 6))
            p61 = NULLPE;
        if (p61 != NULLPE) {
            p54 = p61;

            {	/* weighted-average-escapement */
#ifdef DEBUG
                (void) testdebug (p61, "weighted-average-escapement");
#endif

                if (parse_ISRD18_Real (p61, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p62;

        if ((p62 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p62 -> pe_class, p62 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 7))
            p62 = NULLPE;
        if (p62 != NULLPE) {
            p54 = p62;

            {	/* tabular-escapement */
                register PE p63;

#ifdef DEBUG
                (void) testdebug (p62, "tabular-escapement");
#endif

                if ((p63 = prim2seq (p62)) == NULLPE) {
                    advise (NULLCP, "tabular-escapement bad sequence: %s",
                            pe_error (p62 -> pe_errno));
                    return NOTOK;
                }
                p62 = p63;

                {
                    register PE p64;

                    if ((p64 = first_member (p62)) != NULLPE
                            && PE_ID (p64 -> pe_class, p64 -> pe_id)
                                    != PE_ID (PE_CLASS_CONT, 0))
                        p64 = NULLPE;
                    if (p64 != NULLPE) {
                        p63 = p64;

                        {	/* x-component */
#ifdef DEBUG
                            (void) testdebug (p64, "x-component");
#endif

                            if (parse_ISRD18_Real (p64, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                }

                {
                    register PE p65;

                    if ((p65 = (p62 != p63 ? next_member (p62, p63) : first_member (p62))) != NULLPE) {
                        p63 = p65;

                        {	/* y-component */
#ifdef DEBUG
                            (void) testdebug (p65, "y-component");
#endif

                            if (parse_ISRD18_Real (p65, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                    }
                }


                if (p62 -> pe_cardinal > 2) {
                    advise (NULLCP, "tabular-escapement has too many elements(2): %d",
                            p62 -> pe_cardinal);
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p66;

        if ((p66 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p66 -> pe_class, p66 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 8))
            p66 = NULLPE;
        if (p66 != NULLPE) {
            p54 = p66;

            {	/* maximum-forward-extent */
#ifdef DEBUG
                (void) testdebug (p66, "maximum-forward-extent");
#endif

                if (parse_ISRD18_Real (p66, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p67;

        if ((p67 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p67 -> pe_class, p67 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 9))
            p67 = NULLPE;
        if (p67 != NULLPE) {
            p54 = p67;

            {	/* maximum-left-extent */
#ifdef DEBUG
                (void) testdebug (p67, "maximum-left-extent");
#endif

                if (parse_ISRD18_Real (p67, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p68;

        if ((p68 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p68 -> pe_class, p68 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 10))
            p68 = NULLPE;
        if (p68 != NULLPE) {
            p54 = p68;

            {	/* maximum-backward-extent */
#ifdef DEBUG
                (void) testdebug (p68, "maximum-backward-extent");
#endif

                if (parse_ISRD18_Real (p68, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p69;

        if ((p69 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p69 -> pe_class, p69 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 11))
            p69 = NULLPE;
        if (p69 != NULLPE) {
            p54 = p69;

            {	/* maximum-right-extent */
#ifdef DEBUG
                (void) testdebug (p69, "maximum-right-extent");
#endif

                if (parse_ISRD18_Real (p69, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p70;

        if ((p70 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p70 -> pe_class, p70 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 12))
            p70 = NULLPE;
        if (p70 != NULLPE) {
            p54 = p70;

            {	/* class-pairwise-esc-adjustments */
                register PE p71;

#ifdef DEBUG
                (void) testdebug (p70, "class-pairwise-esc-adjustments");
#endif

                if ((p71 = prim2set (p70)) == NULLPE) {
                    advise (NULLCP, "class-pairwise-esc-adjustments bad set: %s",
                            pe_error (p70 -> pe_errno));
                    return NOTOK;
                }
                p70 = p71;

                for (p71 = first_member (p70); p71; p71 = next_member (p70, p71)) {
                    register PE p72;

#ifdef DEBUG
                    (void) testdebug (p71, "member");
#endif

                    if (p71 -> pe_class != PE_CLASS_UNIV
                            || p71 -> pe_form != PE_FORM_CONS
                            || p71 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p71 -> pe_class], p71 -> pe_form, p71 -> pe_id);
                        return NOTOK;
                    }

                    if ((p72 = prim2seq (p71)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p71 -> pe_errno));
                        return NOTOK;
                    }
                    p71 = p72;

                    {
                        register PE p73;

                        if ((p73 = first_member (p71)) != NULLPE) {
                            p72 = p73;

                            {	/* first-character-forward-class */
#ifdef DEBUG
                                (void) testdebug (p73, "first-character-forward-class");
#endif

                                if (prim2num (p73) == NOTOK
                                        && p73 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "first-character-forward-class bad integer: %s",
                                            pe_error (p73 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "member missing first-character-forward-class element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p74;

                        if ((p74 = (p71 != p72 ? next_member (p71, p72) : first_member (p71))) != NULLPE) {
                            p72 = p74;

                            {	/* second-character-backward-class */
#ifdef DEBUG
                                (void) testdebug (p74, "second-character-backward-class");
#endif

                                if (prim2num (p74) == NOTOK
                                        && p74 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "second-character-backward-class bad integer: %s",
                                            pe_error (p74 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                        else {
                            advise (NULLCP, "member missing second-character-backward-class element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p75;

                        if ((p75 = (p71 != p72 ? next_member (p71, p72) : first_member (p71))) 
                                    != NULLPE
                                && PE_ID (p75 -> pe_class, p75 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 2))
                            p75 = NULLPE;
                        if (p75 != NULLPE) {
                            p72 = p75;

                            {	/* x-adjustment */
#ifdef DEBUG
                                (void) testdebug (p75, "x-adjustment");
#endif

                                if (parse_ISRD18_Real (p75, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p76;

                        if ((p76 = (p71 != p72 ? next_member (p71, p72) : first_member (p71))) != NULLPE) {
                            p72 = p76;

                            {	/* y-adjustment */
#ifdef DEBUG
                                (void) testdebug (p76, "y-adjustment");
#endif

                                if (parse_ISRD18_Real (p76, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }


                    if (p71 -> pe_cardinal > 4) {
                        advise (NULLCP, "member has too many elements(4): %d",
                                p71 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }

    {
        register PE p77;

        if ((p77 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p77 -> pe_class, p77 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 13))
            p77 = NULLPE;
        if (p77 != NULLPE) {
            p54 = p77;

            {	/* minimum-space-amplification */
#ifdef DEBUG
                (void) testdebug (p77, "minimum-space-amplification");
#endif

                if (parse_ISRD18_Real (p77, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p78;

        if ((p78 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p78 -> pe_class, p78 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 14))
            p78 = NULLPE;
        if (p78 != NULLPE) {
            p54 = p78;

            {	/* maximum-space-amplification */
#ifdef DEBUG
                (void) testdebug (p78, "maximum-space-amplification");
#endif

                if (parse_ISRD18_Real (p78, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p79;

        if ((p79 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p79 -> pe_class, p79 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 15))
            p79 = NULLPE;
        if (p79 != NULLPE) {
            p54 = p79;

            {	/* space-adjustment-tracks */
#ifdef DEBUG
                (void) testdebug (p79, "space-adjustment-tracks");
#endif

                if (parse_ISRD18_Space__Adjustment__Tracks (p79, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p80;

        if ((p80 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p80 -> pe_class, p80 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 16))
            p80 = NULLPE;
        if (p80 != NULLPE) {
            p54 = p80;

            {	/* space-adjustment-track */
#ifdef DEBUG
                (void) testdebug (p80, "space-adjustment-track");
#endif

                if (parse_ISRD18_Structured__Name (p80, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p81;

        if ((p81 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p81 -> pe_class, p81 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 17))
            p81 = NULLPE;
        if (p81 != NULLPE) {
            p54 = p81;

            {	/* scores */
#ifdef DEBUG
                (void) testdebug (p81, "scores");
#endif

                if (parse_ISRD18_Scores (p81, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p82;

        if ((p82 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p82 -> pe_class, p82 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 18))
            p82 = NULLPE;
        if (p82 != NULLPE) {
            p54 = p82;

            {	/* variant-scripts */
#ifdef DEBUG
                (void) testdebug (p82, "variant-scripts");
#endif

                if (parse_ISRD18_Variant__Scripts (p82, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p83;

        if ((p83 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p83 -> pe_class, p83 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 19))
            p83 = NULLPE;
        if (p83 != NULLPE) {
            p54 = p83;

            {	/* minimum-line-to-line-spacing */
#ifdef DEBUG
                (void) testdebug (p83, "minimum-line-to-line-spacing");
#endif

                if (parse_ISRD18_Real (p83, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p84;

        if ((p84 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p84 -> pe_class, p84 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 20))
            p84 = NULLPE;
        if (p84 != NULLPE) {
            p54 = p84;

            {	/* minimum-anamorphic-scaling */
#ifdef DEBUG
                (void) testdebug (p84, "minimum-anamorphic-scaling");
#endif

                if (parse_ISRD18_Real (p84, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p85;

        if ((p85 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p85 -> pe_class, p85 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 21))
            p85 = NULLPE;
        if (p85 != NULLPE) {
            p54 = p85;

            {	/* maximum-anamorphic-scaling */
#ifdef DEBUG
                (void) testdebug (p85, "maximum-anamorphic-scaling");
#endif

                if (parse_ISRD18_Real (p85, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p86;

        if ((p86 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p86 -> pe_class, p86 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 22))
            p86 = NULLPE;
        if (p86 != NULLPE) {
            p54 = p86;

            {	/* modal-character-attributes */
#ifdef DEBUG
                (void) testdebug (p86, "modal-character-attributes");
#endif

                if (parse_ISRD18_Modal__Character__Attributes (p86, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p87;

        if ((p87 = (pe != p54 ? next_member (pe, p54) : first_member (pe))) != NULLPE) {
            p54 = p87;

            {	/* non-ISO-attributes */
                register PE p88;

#ifdef DEBUG
                (void) testdebug (p87, "non-ISO-attributes");
#endif

                if ((p88 = prim2set (p87)) == NULLPE) {
                    advise (NULLCP, "non-ISO-attributes bad set: %s",
                            pe_error (p87 -> pe_errno));
                    return NOTOK;
                }
                p87 = p88;

                for (p88 = first_member (p87); p88; p88 = next_member (p87, p88)) {
#ifdef DEBUG
                    (void) testdebug (p88, "member");
#endif

                    if (parse_ISRD18_Non__ISO__Attribute (p88, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }


    if (pe -> pe_cardinal > 24) {
        advise (NULLCP, "Modal-Font-Attributes has too many elements(24): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Space__Adjustment__Tracks (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p89;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Space-Adjustment-Tracks");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Space-Adjustment-Tracks bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Space-Adjustment-Tracks bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p89 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Space-Adjustment-Tracks bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p89;

    {
        register PE p90;

        if ((p90 = first_member (pe)) != NULLPE
                && PE_ID (p90 -> pe_class, p90 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p90 = NULLPE;
        if (p90 != NULLPE) {
            p89 = p90;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p90, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p90, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p91;

        if ((p91 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p91 -> pe_class, p91 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p91 = NULLPE;
        if (p91 != NULLPE) {
            p89 = p91;

            {	/* tight */
#ifdef DEBUG
                (void) testdebug (p91, "tight");
#endif

                if (parse_ISRD18_Track (p91, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p92;

        if ((p92 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p92 -> pe_class, p92 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p92 = NULLPE;
        if (p92 != NULLPE) {
            p89 = p92;

            {	/* normal */
#ifdef DEBUG
                (void) testdebug (p92, "normal");
#endif

                if (parse_ISRD18_Track (p92, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p93;

        if ((p93 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p93 -> pe_class, p93 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p93 = NULLPE;
        if (p93 != NULLPE) {
            p89 = p93;

            {	/* loose */
#ifdef DEBUG
                (void) testdebug (p93, "loose");
#endif

                if (parse_ISRD18_Track (p93, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p94;

        if ((p94 = (pe != p89 ? next_member (pe, p89) : first_member (pe))) != NULLPE) {
            p89 = p94;

            {	/* non-ISO-tracks */
                register PE p95;

#ifdef DEBUG
                (void) testdebug (p94, "non-ISO-tracks");
#endif

                if ((p95 = prim2set (p94)) == NULLPE) {
                    advise (NULLCP, "non-ISO-tracks bad set: %s",
                            pe_error (p94 -> pe_errno));
                    return NOTOK;
                }
                p94 = p95;

                for (p95 = first_member (p94); p95; p95 = next_member (p94, p95)) {
                    register PE p96;

#ifdef DEBUG
                    (void) testdebug (p95, "member");
#endif

                    if (p95 -> pe_class != PE_CLASS_UNIV
                            || p95 -> pe_form != PE_FORM_CONS
                            || p95 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p95 -> pe_class], p95 -> pe_form, p95 -> pe_id);
                        return NOTOK;
                    }

                    if ((p96 = prim2seq (p95)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p95 -> pe_errno));
                        return NOTOK;
                    }
                    p95 = p96;

                    {
                        register PE p97;

                        if ((p97 = first_member (p95)) != NULLPE) {
                            p96 = p97;

                            {	/* track-name */
#ifdef DEBUG
                                (void) testdebug (p97, "track-name");
#endif

                                if (parse_ISRD18_Structured__Name (p97, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing track-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p98;

                        if ((p98 = (p95 != p96 ? next_member (p95, p96) : first_member (p95))) != NULLPE) {
                            p96 = p98;

                            {	/* track */
#ifdef DEBUG
                                (void) testdebug (p98, "track");
#endif

                                if (parse_ISRD18_Track (p98, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing track element");
                            return NOTOK;
                        }

                    }


                    if (p95 -> pe_cardinal > 2) {
                        advise (NULLCP, "member has too many elements(2): %d",
                                p95 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 5) {
        advise (NULLCP, "Space-Adjustment-Tracks has too many elements(5): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Track (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p99;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Track");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Track bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Track bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p99 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Track bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p99;

    {
        register PE p100;

        if ((p100 = first_member (pe)) != NULLPE
                && PE_ID (p100 -> pe_class, p100 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p100 = NULLPE;
        if (p100 != NULLPE) {
            p99 = p100;

            {	/* slope */
#ifdef DEBUG
                (void) testdebug (p100, "slope");
#endif

                if (parse_ISRD18_Real (p100, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p101;

        if ((p101 = (pe != p99 ? next_member (pe, p99) : first_member (pe))) != NULLPE) {
            p99 = p101;

            {	/* constant */
#ifdef DEBUG
                (void) testdebug (p101, "constant");
#endif

                if (parse_ISRD18_Real (p101, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Track has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Scores (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p102;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Scores");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Scores bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Scores bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p102 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Scores bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p102;

    {
        register PE p103;

        if ((p103 = first_member (pe)) != NULLPE
                && PE_ID (p103 -> pe_class, p103 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p103 = NULLPE;
        if (p103 != NULLPE) {
            p102 = p103;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p103, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p103, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p104;

        if ((p104 = (pe != p102 ? next_member (pe, p102) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p104 -> pe_class, p104 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p104 = NULLPE;
        if (p104 != NULLPE) {
            p102 = p104;

            {	/* rightward */
#ifdef DEBUG
                (void) testdebug (p104, "rightward");
#endif

                if (parse_ISRD18_Score (p104, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p105;

        if ((p105 = (pe != p102 ? next_member (pe, p102) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p105 -> pe_class, p105 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p105 = NULLPE;
        if (p105 != NULLPE) {
            p102 = p105;

            {	/* leftward */
#ifdef DEBUG
                (void) testdebug (p105, "leftward");
#endif

                if (parse_ISRD18_Score (p105, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p106;

        if ((p106 = (pe != p102 ? next_member (pe, p102) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p106 -> pe_class, p106 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p106 = NULLPE;
        if (p106 != NULLPE) {
            p102 = p106;

            {	/* through */
#ifdef DEBUG
                (void) testdebug (p106, "through");
#endif

                if (parse_ISRD18_Score (p106, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p107;

        if ((p107 = (pe != p102 ? next_member (pe, p102) : first_member (pe))) != NULLPE) {
            p102 = p107;

            {	/* non-ISO-scores */
                register PE p108;

#ifdef DEBUG
                (void) testdebug (p107, "non-ISO-scores");
#endif

                if ((p108 = prim2set (p107)) == NULLPE) {
                    advise (NULLCP, "non-ISO-scores bad set: %s",
                            pe_error (p107 -> pe_errno));
                    return NOTOK;
                }
                p107 = p108;

                for (p108 = first_member (p107); p108; p108 = next_member (p107, p108)) {
                    register PE p109;

#ifdef DEBUG
                    (void) testdebug (p108, "member");
#endif

                    if (p108 -> pe_class != PE_CLASS_UNIV
                            || p108 -> pe_form != PE_FORM_CONS
                            || p108 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p108 -> pe_class], p108 -> pe_form, p108 -> pe_id);
                        return NOTOK;
                    }

                    if ((p109 = prim2seq (p108)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p108 -> pe_errno));
                        return NOTOK;
                    }
                    p108 = p109;

                    {
                        register PE p110;

                        if ((p110 = first_member (p108)) != NULLPE) {
                            p109 = p110;

                            {	/* score-name */
#ifdef DEBUG
                                (void) testdebug (p110, "score-name");
#endif

                                if (parse_ISRD18_Structured__Name (p110, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing score-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p111;

                        if ((p111 = (p108 != p109 ? next_member (p108, p109) : first_member (p108))) != NULLPE) {
                            p109 = p111;

                            {	/* score */
#ifdef DEBUG
                                (void) testdebug (p111, "score");
#endif

                                if (parse_ISRD18_Score (p111, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing score element");
                            return NOTOK;
                        }

                    }


                    if (p108 -> pe_cardinal > 2) {
                        advise (NULLCP, "member has too many elements(2): %d",
                                p108 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 5) {
        advise (NULLCP, "Scores has too many elements(5): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Score (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p112;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Score");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Score bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Score bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p112 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Score bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p112;

    {
        register PE p113;

        if ((p113 = first_member (pe)) != NULLPE
                && PE_ID (p113 -> pe_class, p113 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p113 = NULLPE;
        if (p113 != NULLPE) {
            p112 = p113;

            {	/* position */
#ifdef DEBUG
                (void) testdebug (p113, "position");
#endif

                if (parse_ISRD18_Real (p113, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p114;

        if ((p114 = (pe != p112 ? next_member (pe, p112) : first_member (pe))) != NULLPE) {
            p112 = p114;

            {	/* thickness */
#ifdef DEBUG
                (void) testdebug (p114, "thickness");
#endif

                if (parse_ISRD18_Real (p114, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Score has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Variant__Scripts (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p115;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Variant-Scripts");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Variant-Scripts bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Variant-Scripts bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p115 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Variant-Scripts bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p115;

    {
        register PE p116;

        if ((p116 = first_member (pe)) != NULLPE
                && PE_ID (p116 -> pe_class, p116 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p116 = NULLPE;
        if (p116 != NULLPE) {
            p115 = p116;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p116, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p116, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p117;

        if ((p117 = (pe != p115 ? next_member (pe, p115) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p117 -> pe_class, p117 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p117 = NULLPE;
        if (p117 != NULLPE) {
            p115 = p117;

            {	/* leftward */
#ifdef DEBUG
                (void) testdebug (p117, "leftward");
#endif

                if (parse_ISRD18_Variant__Script (p117, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p118;

        if ((p118 = (pe != p115 ? next_member (pe, p115) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p118 -> pe_class, p118 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p118 = NULLPE;
        if (p118 != NULLPE) {
            p115 = p118;

            {	/* rightward */
#ifdef DEBUG
                (void) testdebug (p118, "rightward");
#endif

                if (parse_ISRD18_Variant__Script (p118, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p119;

        if ((p119 = (pe != p115 ? next_member (pe, p115) : first_member (pe))) != NULLPE) {
            p115 = p119;

            {	/* non-ISO-scripts */
                register PE p120;

#ifdef DEBUG
                (void) testdebug (p119, "non-ISO-scripts");
#endif

                if ((p120 = prim2set (p119)) == NULLPE) {
                    advise (NULLCP, "non-ISO-scripts bad set: %s",
                            pe_error (p119 -> pe_errno));
                    return NOTOK;
                }
                p119 = p120;

                for (p120 = first_member (p119); p120; p120 = next_member (p119, p120)) {
                    register PE p121;

#ifdef DEBUG
                    (void) testdebug (p120, "member");
#endif

                    if (p120 -> pe_class != PE_CLASS_UNIV
                            || p120 -> pe_form != PE_FORM_CONS
                            || p120 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p120 -> pe_class], p120 -> pe_form, p120 -> pe_id);
                        return NOTOK;
                    }

                    if ((p121 = prim2seq (p120)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p120 -> pe_errno));
                        return NOTOK;
                    }
                    p120 = p121;

                    {
                        register PE p122;

                        if ((p122 = first_member (p120)) != NULLPE) {
                            p121 = p122;

                            {	/* script-name */
#ifdef DEBUG
                                (void) testdebug (p122, "script-name");
#endif

                                if (parse_ISRD18_Structured__Name (p122, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing script-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p123;

                        if ((p123 = (p120 != p121 ? next_member (p120, p121) : first_member (p120))) != NULLPE) {
                            p121 = p123;

                            {	/* script */
#ifdef DEBUG
                                (void) testdebug (p123, "script");
#endif

                                if (parse_ISRD18_Variant__Script (p123, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing script element");
                            return NOTOK;
                        }

                    }


                    if (p120 -> pe_cardinal > 2) {
                        advise (NULLCP, "member has too many elements(2): %d",
                                p120 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 4) {
        advise (NULLCP, "Variant-Scripts has too many elements(4): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Variant__Script (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p124;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Variant-Script");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Variant-Script bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Variant-Script bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p124 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Variant-Script bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p124;

    {
        register PE p125;

        if ((p125 = first_member (pe)) != NULLPE
                && PE_ID (p125 -> pe_class, p125 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p125 = NULLPE;
        if (p125 != NULLPE) {
            p124 = p125;

            {	/* x-offset */
#ifdef DEBUG
                (void) testdebug (p125, "x-offset");
#endif

                if (parse_ISRD18_Real (p125, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p126;

        if ((p126 = (pe != p124 ? next_member (pe, p124) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p126 -> pe_class, p126 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p126 = NULLPE;
        if (p126 != NULLPE) {
            p124 = p126;

            {	/* y-offset */
#ifdef DEBUG
                (void) testdebug (p126, "y-offset");
#endif

                if (parse_ISRD18_Real (p126, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p127;

        if ((p127 = (pe != p124 ? next_member (pe, p124) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p127 -> pe_class, p127 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p127 = NULLPE;
        if (p127 != NULLPE) {
            p124 = p127;

            {	/* x-scale */
#ifdef DEBUG
                (void) testdebug (p127, "x-scale");
#endif

                if (parse_ISRD18_Real (p127, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p128;

        if ((p128 = (pe != p124 ? next_member (pe, p124) : first_member (pe))) != NULLPE) {
            p124 = p128;

            {	/* y-scale */
#ifdef DEBUG
                (void) testdebug (p128, "y-scale");
#endif

                if (parse_ISRD18_Real (p128, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }


    if (pe -> pe_cardinal > 4) {
        advise (NULLCP, "Variant-Script has too many elements(4): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Modal__Character__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p129;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Modal-Character-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Modal-Character-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Modal-Character-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p129 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Modal-Character-Attributes bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p129;

    {
        register PE p130;

        if ((p130 = first_member (pe)) != NULLPE
                && PE_ID (p130 -> pe_class, p130 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p130 = NULLPE;
        if (p130 != NULLPE) {
            p129 = p130;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p130, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p130, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p131;

        if ((p131 = (pe != p129 ? next_member (pe, p129) : first_member (pe))) != NULLPE) {
            p129 = p131;

            {	/* characters */
                register PE p132;

#ifdef DEBUG
                (void) testdebug (p131, "characters");
#endif

                if ((p132 = prim2set (p131)) == NULLPE) {
                    advise (NULLCP, "characters bad set: %s",
                            pe_error (p131 -> pe_errno));
                    return NOTOK;
                }
                p131 = p132;

                for (p132 = first_member (p131); p132; p132 = next_member (p131, p132)) {
                    register PE p133;

#ifdef DEBUG
                    (void) testdebug (p132, "member");
#endif

                    if (p132 -> pe_class != PE_CLASS_UNIV
                            || p132 -> pe_form != PE_FORM_CONS
                            || p132 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p132 -> pe_class], p132 -> pe_form, p132 -> pe_id);
                        return NOTOK;
                    }

                    if ((p133 = prim2seq (p132)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p132 -> pe_errno));
                        return NOTOK;
                    }
                    p132 = p133;

                    {
                        register PE p134;

                        if ((p134 = first_member (p132)) != NULLPE
                                && PE_ID (p134 -> pe_class, p134 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 0))
                            p134 = NULLPE;
                        if (p134 != NULLPE) {
                            p133 = p134;

                            {	/* default-name-prefix */
#ifdef DEBUG
                                (void) testdebug (p134, "default-name-prefix");
#endif

                                if (parse_ISRD18_Default__Name__Prefix (p134, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p135;

                        if ((p135 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) != NULLPE) {
                            p133 = p135;

                            {	/* character-name */
#ifdef DEBUG
                                (void) testdebug (p135, "character-name");
#endif

                                if (parse_ISRD18_Structured__Name (p135, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing character-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p136;

                        if ((p136 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p136 -> pe_class, p136 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 2))
                            p136 = NULLPE;
                        if (p136 != NULLPE) {
                            p133 = p136;

                            {	/* position-x */
#ifdef DEBUG
                                (void) testdebug (p136, "position-x");
#endif

                                if (parse_ISRD18_Real (p136, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p137;

                        if ((p137 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p137 -> pe_class, p137 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 3))
                            p137 = NULLPE;
                        if (p137 != NULLPE) {
                            p133 = p137;

                            {	/* position-y */
#ifdef DEBUG
                                (void) testdebug (p137, "position-y");
#endif

                                if (parse_ISRD18_Real (p137, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p138;

                        if ((p138 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p138 -> pe_class, p138 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 4))
                            p138 = NULLPE;
                        if (p138 != NULLPE) {
                            p133 = p138;

                            {	/* escapement-x */
#ifdef DEBUG
                                (void) testdebug (p138, "escapement-x");
#endif

                                if (parse_ISRD18_Real (p138, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p139;

                        if ((p139 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p139 -> pe_class, p139 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 5))
                            p139 = NULLPE;
                        if (p139 != NULLPE) {
                            p133 = p139;

                            {	/* escapement-y */
#ifdef DEBUG
                                (void) testdebug (p139, "escapement-y");
#endif

                                if (parse_ISRD18_Real (p139, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p140;

                        if ((p140 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p140 -> pe_class, p140 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 6))
                            p140 = NULLPE;
                        if (p140 != NULLPE) {
                            p133 = p140;

                            {	/* forward-extent */
#ifdef DEBUG
                                (void) testdebug (p140, "forward-extent");
#endif

                                if (parse_ISRD18_Real (p140, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p141;

                        if ((p141 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p141 -> pe_class, p141 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 7))
                            p141 = NULLPE;
                        if (p141 != NULLPE) {
                            p133 = p141;

                            {	/* left-extent */
#ifdef DEBUG
                                (void) testdebug (p141, "left-extent");
#endif

                                if (parse_ISRD18_Real (p141, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p142;

                        if ((p142 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p142 -> pe_class, p142 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 8))
                            p142 = NULLPE;
                        if (p142 != NULLPE) {
                            p133 = p142;

                            {	/* backward-extent */
#ifdef DEBUG
                                (void) testdebug (p142, "backward-extent");
#endif

                                if (parse_ISRD18_Real (p142, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p143;

                        if ((p143 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p143 -> pe_class, p143 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 9))
                            p143 = NULLPE;
                        if (p143 != NULLPE) {
                            p133 = p143;

                            {	/* right-extent */
#ifdef DEBUG
                                (void) testdebug (p143, "right-extent");
#endif

                                if (parse_ISRD18_Real (p143, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p144;

                        if ((p144 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p144 -> pe_class, p144 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 10))
                            p144 = NULLPE;
                        if (p144 != NULLPE) {
                            p133 = p144;

                            {	/* char-pair-esc-adjusts */
#ifdef DEBUG
                                (void) testdebug (p144, "char-pair-esc-adjusts");
#endif

                                if (parse_ISRD18_Char__Pair__Esc__Adjusts (p144, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p145;

                        if ((p145 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p145 -> pe_class, p145 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 11))
                            p145 = NULLPE;
                        if (p145 != NULLPE) {
                            p133 = p145;

                            {	/* forward-class-pairwise-class */
#ifdef DEBUG
                                (void) testdebug (p145, "forward-class-pairwise-class");
#endif

                                if (prim2num (p145) == NOTOK
                                        && p145 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "forward-class-pairwise-class bad integer: %s",
                                            pe_error (p145 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p146;

                        if ((p146 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p146 -> pe_class, p146 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 12))
                            p146 = NULLPE;
                        if (p146 != NULLPE) {
                            p133 = p146;

                            {	/* backward-class-pairwise-class */
#ifdef DEBUG
                                (void) testdebug (p146, "backward-class-pairwise-class");
#endif

                                if (prim2num (p146) == NOTOK
                                        && p146 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "backward-class-pairwise-class bad integer: %s",
                                            pe_error (p146 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p147;

                        if ((p147 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p147 -> pe_class, p147 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 13))
                            p147 = NULLPE;
                        if (p147 != NULLPE) {
                            p133 = p147;

                            {	/* forward-sector-space-adjusts */
                                register PE p148;

#ifdef DEBUG
                                (void) testdebug (p147, "forward-sector-space-adjusts");
#endif

                                if ((p148 = prim2seq (p147)) == NULLPE) {
                                    advise (NULLCP, "forward-sector-space-adjusts bad sequence: %s",
                                            pe_error (p147 -> pe_errno));
                                    return NOTOK;
                                }
                                p147 = p148;

                                for (p148 = first_member (p147); p148; p148 = next_member (p147, p148)) {
#ifdef DEBUG
                                    (void) testdebug (p148, "element");
#endif

                                    if (parse_ISRD18_Real (p148, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                        return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p149;

                        if ((p149 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p149 -> pe_class, p149 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 14))
                            p149 = NULLPE;
                        if (p149 != NULLPE) {
                            p133 = p149;

                            {	/* backward-sector-space-adjusts */
                                register PE p150;

#ifdef DEBUG
                                (void) testdebug (p149, "backward-sector-space-adjusts");
#endif

                                if ((p150 = prim2seq (p149)) == NULLPE) {
                                    advise (NULLCP, "backward-sector-space-adjusts bad sequence: %s",
                                            pe_error (p149 -> pe_errno));
                                    return NOTOK;
                                }
                                p149 = p150;

                                for (p150 = first_member (p149); p150; p150 = next_member (p149, p150)) {
#ifdef DEBUG
                                    (void) testdebug (p150, "element");
#endif

                                    if (parse_ISRD18_Real (p150, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                        return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p151;

                        if ((p151 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p151 -> pe_class, p151 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 15))
                            p151 = NULLPE;
                        if (p151 != NULLPE) {
                            p133 = p151;

                            {	/* amplification */
#ifdef DEBUG
                                (void) testdebug (p151, "amplification");
#endif

                                if (prim2num (p151) == NOTOK
                                        && p151 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "amplification bad integer: %s",
                                            pe_error (p151 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p152;

                        if ((p152 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p152 -> pe_class, p152 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 16))
                            p152 = NULLPE;
                        if (p152 != NULLPE) {
                            p133 = p152;

                            {	/* correction */
#ifdef DEBUG
                                (void) testdebug (p152, "correction");
#endif

                                if (prim2num (p152) == NOTOK
                                        && p152 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "correction bad integer: %s",
                                            pe_error (p152 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p153;

                        if ((p153 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p153 -> pe_class, p153 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 17))
                            p153 = NULLPE;
                        if (p153 != NULLPE) {
                            p133 = p153;

                            {	/* tracked-space-adjust-indicator */
#ifdef DEBUG
                                (void) testdebug (p153, "tracked-space-adjust-indicator");
#endif

                                if (prim2num (p153) == NOTOK
                                        && p153 -> pe_errno != PE_ERR_NONE) {
                                    advise (NULLCP, "tracked-space-adjust-indicator bad integer: %s",
                                            pe_error (p153 -> pe_errno));
                                    return NOTOK;
                                }
                            }
                        }
                    }

                    {
                        register PE p154;

                        if ((p154 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) 
                                    != NULLPE
                                && PE_ID (p154 -> pe_class, p154 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 18))
                            p154 = NULLPE;
                        if (p154 != NULLPE) {
                            p133 = p154;

                            {	/* frequency-of-use */
#ifdef DEBUG
                                (void) testdebug (p154, "frequency-of-use");
#endif

                                if (parse_ISRD18_Real (p154, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p155;

                        if ((p155 = (p132 != p133 ? next_member (p132, p133) : first_member (p132))) != NULLPE) {
                            p133 = p155;

                            {	/* non-ISO-attributes */
                                register PE p156;

#ifdef DEBUG
                                (void) testdebug (p155, "non-ISO-attributes");
#endif

                                if ((p156 = prim2set (p155)) == NULLPE) {
                                    advise (NULLCP, "non-ISO-attributes bad set: %s",
                                            pe_error (p155 -> pe_errno));
                                    return NOTOK;
                                }
                                p155 = p156;

                                for (p156 = first_member (p155); p156; p156 = next_member (p155, p156)) {
#ifdef DEBUG
                                    (void) testdebug (p156, "member");
#endif

                                    if (parse_ISRD18_Non__ISO__Attribute (p156, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                        return NOTOK;
                                }
                            }
                        }
                    }


                    if (p132 -> pe_cardinal > 20) {
                        advise (NULLCP, "member has too many elements(20): %d",
                                p132 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
        else {
            advise (NULLCP, "Modal-Character-Attributes missing characters element");
            return NOTOK;
        }

    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Modal-Character-Attributes has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Char__Pair__Esc__Adjusts (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p157;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Char-Pair-Esc-Adjusts");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Char-Pair-Esc-Adjusts bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Char-Pair-Esc-Adjusts bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p157 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Char-Pair-Esc-Adjusts bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p157;

    {
        register PE p158;

        if ((p158 = first_member (pe)) != NULLPE
                && PE_ID (p158 -> pe_class, p158 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p158 = NULLPE;
        if (p158 != NULLPE) {
            p157 = p158;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p158, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p158, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p159;

        if ((p159 = (pe != p157 ? next_member (pe, p157) : first_member (pe))) != NULLPE) {
            p157 = p159;

            {	/* successor-characters */
                register PE p160;

#ifdef DEBUG
                (void) testdebug (p159, "successor-characters");
#endif

                if ((p160 = prim2set (p159)) == NULLPE) {
                    advise (NULLCP, "successor-characters bad set: %s",
                            pe_error (p159 -> pe_errno));
                    return NOTOK;
                }
                p159 = p160;

                for (p160 = first_member (p159); p160; p160 = next_member (p159, p160)) {
                    register PE p161;

#ifdef DEBUG
                    (void) testdebug (p160, "member");
#endif

                    if (p160 -> pe_class != PE_CLASS_UNIV
                            || p160 -> pe_form != PE_FORM_CONS
                            || p160 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p160 -> pe_class], p160 -> pe_form, p160 -> pe_id);
                        return NOTOK;
                    }

                    if ((p161 = prim2seq (p160)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p160 -> pe_errno));
                        return NOTOK;
                    }
                    p160 = p161;

                    {
                        register PE p162;

                        if ((p162 = first_member (p160)) != NULLPE) {
                            p161 = p162;

                            {	/* successor-character-name */
#ifdef DEBUG
                                (void) testdebug (p162, "successor-character-name");
#endif

                                if (parse_ISRD18_Structured__Name (p162, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing successor-character-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p163;

                        if ((p163 = (p160 != p161 ? next_member (p160, p161) : first_member (p160))) 
                                    != NULLPE
                                && PE_ID (p163 -> pe_class, p163 -> pe_id)
                                        != PE_ID (PE_CLASS_CONT, 1))
                            p163 = NULLPE;
                        if (p163 != NULLPE) {
                            p161 = p163;

                            {	/* adjustment-x */
#ifdef DEBUG
                                (void) testdebug (p163, "adjustment-x");
#endif

                                if (parse_ISRD18_Real (p163, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }

                    {
                        register PE p164;

                        if ((p164 = (p160 != p161 ? next_member (p160, p161) : first_member (p160))) != NULLPE) {
                            p161 = p164;

                            {	/* adjustment-y */
#ifdef DEBUG
                                (void) testdebug (p164, "adjustment-y");
#endif

                                if (parse_ISRD18_Real (p164, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                    }


                    if (p160 -> pe_cardinal > 3) {
                        advise (NULLCP, "member has too many elements(3): %d",
                                p160 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
        else {
            advise (NULLCP, "Char-Pair-Esc-Adjusts missing successor-characters element");
            return NOTOK;
        }

    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Char-Pair-Esc-Adjusts has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Character__Shape__Technologies (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p165;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Character-Shape-Technologies");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Character-Shape-Technologies bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Character-Shape-Technologies bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p165 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Character-Shape-Technologies bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p165;

    {
        register PE p166;

        if ((p166 = first_member (pe)) != NULLPE
                && PE_ID (p166 -> pe_class, p166 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p166 = NULLPE;
        if (p166 != NULLPE) {
            p165 = p166;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p166, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p166, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p167;

        if ((p167 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p167 -> pe_class, p167 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p167 = NULLPE;
        if (p167 != NULLPE) {
            p165 = p167;

            {	/* bitmap */
#ifdef DEBUG
                (void) testdebug (p167, "bitmap");
#endif

                if (parse_ISRD18_Technology__Attributes (p167, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p168;

        if ((p168 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p168 -> pe_class, p168 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p168 = NULLPE;
        if (p168 != NULLPE) {
            p165 = p168;

            {	/* straight-line-outline */
#ifdef DEBUG
                (void) testdebug (p168, "straight-line-outline");
#endif

                if (parse_ISRD18_Technology__Attributes (p168, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p169;

        if ((p169 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p169 -> pe_class, p169 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p169 = NULLPE;
        if (p169 != NULLPE) {
            p165 = p169;

            {	/* circular-outline */
#ifdef DEBUG
                (void) testdebug (p169, "circular-outline");
#endif

                if (parse_ISRD18_Technology__Attributes (p169, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p170;

        if ((p170 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p170 -> pe_class, p170 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 4))
            p170 = NULLPE;
        if (p170 != NULLPE) {
            p165 = p170;

            {	/* conic-outline */
#ifdef DEBUG
                (void) testdebug (p170, "conic-outline");
#endif

                if (parse_ISRD18_Technology__Attributes (p170, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p171;

        if ((p171 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p171 -> pe_class, p171 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 5))
            p171 = NULLPE;
        if (p171 != NULLPE) {
            p165 = p171;

            {	/* bezier-outline */
#ifdef DEBUG
                (void) testdebug (p171, "bezier-outline");
#endif

                if (parse_ISRD18_Technology__Attributes (p171, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p172;

        if ((p172 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p172 -> pe_class, p172 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 6))
            p172 = NULLPE;
        if (p172 != NULLPE) {
            p165 = p172;

            {	/* mixed */
#ifdef DEBUG
                (void) testdebug (p172, "mixed");
#endif

                if (parse_ISRD18_Technology__Attributes (p172, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p173;

        if ((p173 = (pe != p165 ? next_member (pe, p165) : first_member (pe))) != NULLPE) {
            p165 = p173;

            {	/* non-ISO-technologies */
                register PE p174;

#ifdef DEBUG
                (void) testdebug (p173, "non-ISO-technologies");
#endif

                if ((p174 = prim2set (p173)) == NULLPE) {
                    advise (NULLCP, "non-ISO-technologies bad set: %s",
                            pe_error (p173 -> pe_errno));
                    return NOTOK;
                }
                p173 = p174;

                for (p174 = first_member (p173); p174; p174 = next_member (p173, p174)) {
                    register PE p175;

#ifdef DEBUG
                    (void) testdebug (p174, "member");
#endif

                    if (p174 -> pe_class != PE_CLASS_UNIV
                            || p174 -> pe_form != PE_FORM_CONS
                            || p174 -> pe_id != PE_CONS_SEQ) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p174 -> pe_class], p174 -> pe_form, p174 -> pe_id);
                        return NOTOK;
                    }

                    if ((p175 = prim2seq (p174)) == NULLPE) {
                        advise (NULLCP, "member bad sequence: %s",
                                pe_error (p174 -> pe_errno));
                        return NOTOK;
                    }
                    p174 = p175;

                    {
                        register PE p176;

                        if ((p176 = first_member (p174)) != NULLPE) {
                            p175 = p176;

                            {	/* technology-name */
#ifdef DEBUG
                                (void) testdebug (p176, "technology-name");
#endif

                                if (parse_ISRD18_Structured__Name (p176, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing technology-name element");
                            return NOTOK;
                        }

                    }

                    {
                        register PE p177;

                        if ((p177 = (p174 != p175 ? next_member (p174, p175) : first_member (p174))) != NULLPE) {
                            p175 = p177;

                            {	/* technology-attributes */
#ifdef DEBUG
                                (void) testdebug (p177, "technology-attributes");
#endif

                                if (parse_ISRD18_Technology__Attributes (p177, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                                    return NOTOK;
                            }
                        }
                        else {
                            advise (NULLCP, "member missing technology-attributes element");
                            return NOTOK;
                        }

                    }


                    if (p174 -> pe_cardinal > 2) {
                        advise (NULLCP, "member has too many elements(2): %d",
                                p174 -> pe_cardinal);
                        return NOTOK;
                    }
                }
            }
        }
    }


    if (pe -> pe_cardinal > 8) {
        advise (NULLCP, "Character-Shape-Technologies has too many elements(8): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Technology__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p178;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Technology-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Technology-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Technology-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p178 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Technology-Attributes bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p178;

    {
        register PE p179;

        if ((p179 = first_member (pe)) != NULLPE
                && PE_ID (p179 -> pe_class, p179 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 0))
            p179 = NULLPE;
        if (p179 != NULLPE) {
            p178 = p179;

            {	/* default-name-prefix */
#ifdef DEBUG
                (void) testdebug (p179, "default-name-prefix");
#endif

                if (parse_ISRD18_Default__Name__Prefix (p179, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p180;

        if ((p180 = (pe != p178 ? next_member (pe, p178) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p180 -> pe_class, p180 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 1))
            p180 = NULLPE;
        if (p180 != NULLPE) {
            p178 = p180;

            {	/* fast-scan-direction */
#ifdef DEBUG
                (void) testdebug (p180, "fast-scan-direction");
#endif

                if (parse_ISRD18_Real (p180, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p181;

        if ((p181 = (pe != p178 ? next_member (pe, p178) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p181 -> pe_class, p181 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 2))
            p181 = NULLPE;
        if (p181 != NULLPE) {
            p178 = p181;

            {	/* slow-scan-direction */
#ifdef DEBUG
                (void) testdebug (p181, "slow-scan-direction");
#endif

                if (prim2num (p181) == NOTOK
                        && p181 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "slow-scan-direction bad integer: %s",
                            pe_error (p181 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }

    {
        register PE p182;

        if ((p182 = (pe != p178 ? next_member (pe, p178) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p182 -> pe_class, p182 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 3))
            p182 = NULLPE;
        if (p182 != NULLPE) {
            p178 = p182;

            {	/* fast-scan-resolution */
#ifdef DEBUG
                (void) testdebug (p182, "fast-scan-resolution");
#endif

                if (parse_ISRD18_Real (p182, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p183;

        if ((p183 = (pe != p178 ? next_member (pe, p178) : first_member (pe))) 
                    != NULLPE
                && PE_ID (p183 -> pe_class, p183 -> pe_id)
                        != PE_ID (PE_CLASS_CONT, 4))
            p183 = NULLPE;
        if (p183 != NULLPE) {
            p178 = p183;

            {	/* slow-scan-resolution */
#ifdef DEBUG
                (void) testdebug (p183, "slow-scan-resolution");
#endif

                if (parse_ISRD18_Real (p183, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
    }

    {
        register PE p184;

        if ((p184 = (pe != p178 ? next_member (pe, p178) : first_member (pe))) != NULLPE) {
            p178 = p184;

            {	/* non-ISO-Attributes */
                register PE p185;

#ifdef DEBUG
                (void) testdebug (p184, "non-ISO-Attributes");
#endif

                if ((p185 = prim2set (p184)) == NULLPE) {
                    advise (NULLCP, "non-ISO-Attributes bad set: %s",
                            pe_error (p184 -> pe_errno));
                    return NOTOK;
                }
                p184 = p185;

                for (p185 = first_member (p184); p185; p185 = next_member (p184, p185)) {
#ifdef DEBUG
                    (void) testdebug (p185, "member");
#endif

                    if (parse_ISRD18_Non__ISO__Attribute (p185, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
        }
    }


    if (pe -> pe_cardinal > 6) {
        advise (NULLCP, "Technology-Attributes has too many elements(6): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Non__ISO__Attribute (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p186;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Non-ISO-Attribute");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Non-ISO-Attribute bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Non-ISO-Attribute bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p186 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Non-ISO-Attribute bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p186;

    {
        register PE p187;

        if ((p187 = first_member (pe)) != NULLPE) {
            p186 = p187;

            {	/* attribute-name */
#ifdef DEBUG
                (void) testdebug (p187, "attribute-name");
#endif

                if (parse_ISRD18_Structured__Name (p187, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
        }
        else {
            advise (NULLCP, "Non-ISO-Attribute missing attribute-name element");
            return NOTOK;
        }

    }

    {
        register PE p188;

        if ((p188 = (pe != p186 ? next_member (pe, p186) : first_member (pe))) != NULLPE) {
            p186 = p188;

            {	/* attribute-value */
#ifdef DEBUG
                (void) testdebug (p188, "attribute-value");
#endif

            }
        }
        else {
            advise (NULLCP, "Non-ISO-Attribute missing attribute-value element");
            return NOTOK;
        }

    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Non-ISO-Attribute has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Structured__Name (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Structured-Name");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_CONT, 0):	/* complete-structured-name */
            {
                register PE p189;

#ifdef DEBUG
                (void) testdebug (pe, "complete-structured-name");
#endif

                if ((p189 = prim2seq (pe)) == NULLPE) {
                    advise (NULLCP, "complete-structured-name bad sequence: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
                pe = p189;

                for (p189 = first_member (pe); p189; p189 = next_member (pe, p189)) {
#ifdef DEBUG
                    (void) testdebug (p189, "element");
#endif

                    if (parse_ISRD18_Identifier (p189, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 1):	/* abbreviated-structured-name */
            {
#ifdef DEBUG
                (void) testdebug (pe, "abbreviated-structured-name");
#endif

                if (parse_ISRD18_Identifier (pe, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
            break;

        default:
            advise (NULLCP, "Structured-Name has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Default__Name__Prefix (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p190;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Default-Name-Prefix");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Default-Name-Prefix bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Default-Name-Prefix bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p190 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Default-Name-Prefix bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p190;

    for (p190 = first_member (pe); p190; p190 = next_member (pe, p190)) {
#ifdef DEBUG
        (void) testdebug (p190, "element");
#endif

        if (parse_ISRD18_Identifier (p190, 1, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Identifier (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Identifier");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_CONT, 0):	/* integer */
            {
#ifdef DEBUG
                (void) testdebug (pe, "integer");
#endif

                if (prim2num (pe) == NOTOK
                        && pe -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "integer bad integer: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_CONT, 1):	/* character-sequence */
            {
#ifdef DEBUG
                (void) testdebug (pe, "character-sequence");
#endif

            }
            break;

        default:
            advise (NULLCP, "Identifier has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD18_Real (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p191;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD18.Real");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SEQ) {
            advise (NULLCP, "Real bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Real bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p191 = prim2seq (pe)) == NULLPE) {
        advise (NULLCP, "Real bad sequence: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p191;

    {
        register PE p192;

        if ((p192 = first_member (pe)) != NULLPE) {
            p191 = p192;

            {	/* numerator */
#ifdef DEBUG
                (void) testdebug (p192, "numerator");
#endif

                if (prim2num (p192) == NOTOK
                        && p192 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "numerator bad integer: %s",
                            pe_error (p192 -> pe_errno));
                    return NOTOK;
                }
            }
        }
        else {
            advise (NULLCP, "Real missing numerator element");
            return NOTOK;
        }

    }

    {
        register PE p193;

        if ((p193 = (pe != p191 ? next_member (pe, p191) : first_member (pe))) != NULLPE) {
            p191 = p193;

            {	/* denominator */
#ifdef DEBUG
                (void) testdebug (p193, "denominator");
#endif

                if (prim2num (p193) == NOTOK
                        && p193 -> pe_errno != PE_ERR_NONE) {
                    advise (NULLCP, "denominator bad integer: %s",
                            pe_error (p193 -> pe_errno));
                    return NOTOK;
                }
            }
        }
    }


    if (pe -> pe_cardinal > 2) {
        advise (NULLCP, "Real has too many elements(2): %d",
                pe -> pe_cardinal);
        return NOTOK;
    }

    return OK;
}
