/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISPR6 */
# line 5 "ispr6.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	print_ISPR6_Presentation__Style__Descriptor (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p0_count = 0;
    register PE p0;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Presentation-Style-Descriptor bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Presentation-Style-Descriptor bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Presentation-Style-Descriptor bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    vpush ();
    if (p0 = set_find (pe, PE_CLASS_APPL, 5)) {
        vname ("style-identifier");
        if (print_ISPR3_Style__Identifier (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    else {
        advise (NULLCP, "style-identifier missing style-identifier member");
        return NOTOK;
    }

    if (p0 = set_find (pe, PE_CLASS_CONT, 0)) {
        vname ("user-readable-comments");
        if (print_ISPR4_Comment__String (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 1)) {
        vname ("user-visible-name");
        if (print_ISPR4_Comment__String (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 2)) {
        vname ("transparency");
        if (print_ISPR4_Transparency (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 3)) {
        vname ("presentation-attributes");
        if (print_ISPR6_Presentation__Attributes (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 4)) {
        vname ("colour");
        if (print_ISPR4_Colour (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 5)) {
        vname ("border");
        if (print_ISPR4_Border (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Presentation__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p1_count = 0;
    register PE p1;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Presentation-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Presentation-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p1 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Presentation-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p1;

    vpush ();
    if (p1 = set_find (pe, PE_CLASS_APPL, 2)) {
        vname ("content-type");
        if (print_ISPR6_Content__Type (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p1_count ++;
    }
    if (p1 = set_find (pe, PE_CLASS_UNIV, 6)) {
        vname ("content-architecture-class");
        if (print_ISPR6_Content__Architecture__Class (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p1_count ++;
    }
    if (p1 = set_find (pe, PE_CLASS_CONT, 0)) {
        vname ("character-attributes");
        if (print_ISPR9_Character__Attributes (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p1_count ++;
    }
    if (p1 = set_find (pe, PE_CLASS_CONT, 1)) {
        vname ("raster-graphics-attributes");
        if (print_ISPR12_Raster__Graphics__Attributes (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p1_count ++;
    }
    if (p1 = set_find (pe, PE_CLASS_CONT, 2)) {
        vname ("geometric-graphics-attributes");
        if (print_ISPR15_Geometric__Graphics__Attributes (p1, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p1_count ++;
    }
    if (p1 = set_find (pe, PE_CLASS_CONT, 6)) {
        register PE p2;

        vname ("ext-cont-arch-attributes");
        if ((p2 = prim2seq (p1)) == NULLPE) {
            advise (NULLCP, "ext-cont-arch-attributes bad sequence: %s",
                    pe_error (p1 -> pe_errno));
            return NOTOK;
        }
        p1 = p2;

        vpush ();
        for (p2 = first_member (p1); p2; p2 = next_member (p1, p2)) {
            if (print_UNIV_EXTERNAL (p2, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        vpop ();
        p1_count ++;
    }
    if (p1_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Content__Type (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p3;

    if (explicit
            && PE_ID (pe -> pe_class, pe -> pe_id)
                    != PE_ID (PE_CLASS_APPL, 2)) {
        advise (NULLCP, "Content-Type bad class/id: %s/0x%x", 
                pe_classlist[pe -> pe_class], pe -> pe_id);
        return NOTOK;
    }
    if ((p3 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Content-Type bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p3;
    switch (p3) {
        case 0:	/* formatted-characters */
            vprint ("formatted-characters");
            break;
        case 1:	/* formatted-raster-graphics */
            vprint ("formatted-raster-graphics");
            break;
        default:
            advise (NULLCP, "Content-Type has unknown component: %d", p3);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Content__Architecture__Class (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register OID p4;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_OID) {
            advise (NULLCP, "Content-Architecture-Class bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Content-Architecture-Class bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p4 = prim2oid (pe)) == NULLOID) {
        advise (NULLCP, "Content-Architecture-Class bad object identifier: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (buffer)
        *buffer = sprintoid (p4);
    vprint ("%s", oid2ode (p4));

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Layout__Style__Descriptor (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p5_count = 0;
    register PE p5;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Layout-Style-Descriptor bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Layout-Style-Descriptor bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p5 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Layout-Style-Descriptor bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p5;

    vpush ();
    if (p5 = set_find (pe, PE_CLASS_APPL, 5)) {
        vname ("style-identifier");
        if (print_ISPR3_Style__Identifier (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p5_count ++;
    }
    else {
        advise (NULLCP, "style-identifier missing style-identifier member");
        return NOTOK;
    }

    if (p5 = set_find (pe, PE_CLASS_CONT, 0)) {
        vname ("user-readable-comments");
        if (print_ISPR4_Comment__String (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p5_count ++;
    }
    if (p5 = set_find (pe, PE_CLASS_CONT, 1)) {
        vname ("user-visible-name");
        if (print_ISPR4_Comment__String (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p5_count ++;
    }
    if (p5 = set_find (pe, PE_CLASS_CONT, 4)) {
        vname ("layout-directives");
        if (print_ISPR6_Layout__Directives (p5, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p5_count ++;
    }
    if (p5_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Layout__Directives (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p6_count = 0;
    register PE p6;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Layout-Directives bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Layout-Directives bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p6 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Layout-Directives bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p6;

    vpush ();
    if ( (p6 = set_find (pe, PE_CLASS_CONT, 0))
        || (p6 = set_find (pe, PE_CLASS_CONT, 1))
        || (p6 = set_find (pe, PE_CLASS_CONT, 2))
        || (p6 = set_find (pe, PE_CLASS_CONT, 15)) ) {
        vname ("indivisibility");
        vpush ();
        switch (PE_ID (p6 -> pe_class, p6 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):	/* to-layout-object-class */
                {
                    vname ("to-layout-object-class");
                    if (print_ISPR3_Object__or__Class__Identifier (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 1):	/* to-layout-category */
                {
                    vname ("to-layout-category");
                    if (print_ISPR3_Layout__Category__Name (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 2):	/* to-layout-object-type */
                {
                    vname ("to-layout-object-type");
                    if (print_ISPR4_Layout__Object__Type (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 15):	/* null */
                {
                    vname ("null");
                    vprint ("NULL");
                }
                break;

            default:
                advise (NULLCP, "indivisibility has unknown choice: %s/%d/0x%x",
                        pe_classlist[p6 -> pe_class], p6 -> pe_form, p6 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 3)) {
        vname ("separation");
        if (print_ISPR6_Separation (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 4)) {
        vname ("offset");
        if (print_ISPR6_Offset (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 5)) {
        vname ("fill-order");
        if (print_ISPR6_Fill__Order (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 6)) {
        vname ("concatenation");
        if (print_ISPR6_Concatenation (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if ( (p6 = set_find (pe, PE_CLASS_CONT, 7))
        || (p6 = set_find (pe, PE_CLASS_CONT, 8))
        || (p6 = set_find (pe, PE_CLASS_CONT, 9))
        || (p6 = set_find (pe, PE_CLASS_CONT, 16)) ) {
        vname ("new-layout-object");
        vpush ();
        switch (PE_ID (p6 -> pe_class, p6 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 7):	/* to-layout-object-class */
                {
                    vname ("to-layout-object-class");
                    if (print_ISPR3_Object__or__Class__Identifier (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 8):	/* to-layout-category */
                {
                    vname ("to-layout-category");
                    if (print_ISPR3_Layout__Category__Name (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 9):	/* to-layout-object-type */
                {
                    vname ("to-layout-object-type");
                    if (print_ISPR4_Layout__Object__Type (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 16):	/* null */
                {
                    vname ("null");
                    vprint ("NULL");
                }
                break;

            default:
                advise (NULLCP, "new-layout-object has unknown choice: %s/%d/0x%x",
                        pe_classlist[p6 -> pe_class], p6 -> pe_form, p6 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 10)) {
        vname ("same-layout-object");
        if (print_ISPR6_Same__Layout__Object (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 11)) {
        vname ("layout-object-class");
        if (print_ISPR3_Object__or__Class__Identifier (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 12)) {
        vname ("layout-category");
        if (print_ISPR3_Layout__Category__Name (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if ( (p6 = set_find (pe, PE_CLASS_CONT, 13))
        || (p6 = set_find (pe, PE_CLASS_CONT, 17))
        || (p6 = set_find (pe, PE_CLASS_CONT, 18)) ) {
        vname ("synchronization");
        vpush ();
        switch (PE_ID (p6 -> pe_class, p6 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 13):
                {
                    if (print_ISPR3_Object__or__Class__Identifier (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 17):
                {
                    register PE p7 = p6;

                    {	/* member TAG PULLUP */
                        register PE p8;

                        if ((p8 = prim2set (p7)) == NULLPE) {
                            advise (NULLCP, "member bad member: %s",
                                    pe_error (p7 -> pe_errno));
                            return NOTOK;
                        }
                        if (p8 -> pe_cardinal != 1) {
                            advise (NULLCP, "member too many elements for tagged member: %d",
                                    p8 -> pe_cardinal);
                            return NOTOK;
                        }
                        p7 = first_member (p8);
                    }
                    {
                        if (print_ISPR3_Object__Id__Expression (p7, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 18):
                {
                    vprint ("NULL");
                }
                break;

            default:
                advise (NULLCP, "synchronization has unknown choice: %s/%d/0x%x",
                        pe_classlist[p6 -> pe_class], p6 -> pe_form, p6 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p6_count ++;
    }
    if (p6 = set_find (pe, PE_CLASS_CONT, 14)) {
        vname ("block-alignment");
        if (print_ISPR6_Block__Alignment (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p6_count ++;
    }
    if (p6_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Separation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p9_count = 0;
    register PE p9;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Separation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Separation bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p9 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Separation bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p9;

    vpush ();
    if (p9 = set_find (pe, PE_CLASS_CONT, 0)) {
        register int p10;

        vname ("leading");
        if ((p10 = prim2num (p9)) == NOTOK
                && p9 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "leading bad integer: %s",
                    pe_error (p9 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p10);
        p9_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p9 = set_find (pe, PE_CLASS_CONT, 1)) {
        register int p11;

        vname ("trailing");
        if ((p11 = prim2num (p9)) == NOTOK
                && p9 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "trailing bad integer: %s",
                    pe_error (p9 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p11);
        p9_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p9 = set_find (pe, PE_CLASS_CONT, 2)) {
        register int p12;

        vname ("centre");
        if ((p12 = prim2num (p9)) == NOTOK
                && p9 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "centre bad integer: %s",
                    pe_error (p9 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p12);
        p9_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p9_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Offset (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p13_count = 0;
    register PE p13;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Offset bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Offset bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p13 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Offset bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p13;

    vpush ();
    if (p13 = set_find (pe, PE_CLASS_CONT, 0)) {
        register int p14;

        vname ("right-hand");
        if ((p14 = prim2num (p13)) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "right-hand bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p14);
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13 = set_find (pe, PE_CLASS_CONT, 1)) {
        register int p15;

        vname ("left-hand");
        if ((p15 = prim2num (p13)) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "left-hand bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p15);
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13 = set_find (pe, PE_CLASS_CONT, 2)) {
        register int p16;

        vname ("trailing");
        if ((p16 = prim2num (p13)) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "trailing bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p16);
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13 = set_find (pe, PE_CLASS_CONT, 3)) {
        register int p17;

        vname ("leading");
        if ((p17 = prim2num (p13)) == NOTOK
                && p13 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "leading bad integer: %s",
                    pe_error (p13 -> pe_errno));
            return NOTOK;
        }
        vprint ("%d", p17);
        p13_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p13_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Fill__Order (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p18;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Fill-Order bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Fill-Order bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p18 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Fill-Order bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p18;
    switch (p18) {
        case 0:	/* normal */
            vprint ("normal");
            break;
        case 1:	/* reverse */
            vprint ("reverse");
            break;
        default:
            advise (NULLCP, "Fill-Order has unknown component: %d", p18);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Concatenation (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p19;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Concatenation bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Concatenation bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p19 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Concatenation bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p19;
    switch (p19) {
        case 0:	/* non-concatenated */
            vprint ("non-concatenated");
            break;
        case 1:	/* concatenated */
            vprint ("concatenated");
            break;
        default:
            advise (NULLCP, "Concatenation has unknown component: %d", p19);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Same__Layout__Object (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p20_count = 0;
    register PE p20;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Same-Layout-Object bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Same-Layout-Object bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p20 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Same-Layout-Object bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p20;

    vpush ();
    if ( (p20 = set_find (pe, PE_CLASS_CONT, 0))
        || (p20 = set_find (pe, PE_CLASS_CONT, 4))
        || (p20 = set_find (pe, PE_CLASS_CONT, 5)) ) {
        vname ("to-logical-object");
        vpush ();
        switch (PE_ID (p20 -> pe_class, p20 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):
                {
                    if (print_ISPR3_Object__or__Class__Identifier (p20, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 4):
                {
                    register PE p21 = p20;

                    {	/* member TAG PULLUP */
                        register PE p22;

                        if ((p22 = prim2set (p21)) == NULLPE) {
                            advise (NULLCP, "member bad member: %s",
                                    pe_error (p21 -> pe_errno));
                            return NOTOK;
                        }
                        if (p22 -> pe_cardinal != 1) {
                            advise (NULLCP, "member too many elements for tagged member: %d",
                                    p22 -> pe_cardinal);
                            return NOTOK;
                        }
                        p21 = first_member (p22);
                    }
                    {
                        if (print_ISPR3_Object__Id__Expression (p21, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 5):
                {
                    vprint ("NULL");
                }
                break;

            default:
                advise (NULLCP, "to-logical-object has unknown choice: %s/%d/0x%x",
                        pe_classlist[p20 -> pe_class], p20 -> pe_form, p20 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p20_count ++;
    }
    else {
        advise (NULLCP, "to-logical-object missing to-logical-object member");
        return NOTOK;
    }

    if ( (p20 = set_find (pe, PE_CLASS_CONT, 1))
        || (p20 = set_find (pe, PE_CLASS_CONT, 2))
        || (p20 = set_find (pe, PE_CLASS_CONT, 3)) ) {
        vpush ();
        switch (PE_ID (p20 -> pe_class, p20 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 1):	/* to-layout-object-class */
                {
                    vname ("to-layout-object-class");
                    if (print_ISPR3_Object__or__Class__Identifier (p20, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 2):	/* to-layout-category */
                {
                    vname ("to-layout-category");
                    if (print_ISPR3_Layout__Category__Name (p20, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 3):	/* to-layout-object-type */
                {
                    vname ("to-layout-object-type");
                    if (print_ISPR4_Layout__Object__Type (p20, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;

            default:
                advise (NULLCP, "member has unknown choice: %s/%d/0x%x",
                        pe_classlist[p20 -> pe_class], p20 -> pe_form, p20 -> pe_id);
                return NOTOK;
        }
        vpop ();
        p20_count ++;
    }
    if (p20_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");
    vpop ();

    return OK;
}

/* ARGSUSED */

int	print_ISPR6_Block__Alignment (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register int p23;

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_PRIM
                || pe -> pe_id != PE_PRIM_INT) {
            advise (NULLCP, "Block-Alignment bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_PRIM) {
            advise (NULLCP, "Block-Alignment bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p23 = prim2num (pe)) == NOTOK
            && pe -> pe_errno != PE_ERR_NONE) {
        advise (NULLCP, "Block-Alignment bad integer: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p23;
    switch (p23) {
        case 0:	/* right-hand */
            vprint ("right-hand");
            break;
        case 1:	/* left-hand */
            vprint ("left-hand");
            break;
        case 2:	/* centred */
            vprint ("centred");
            break;
        case 3:	/* null */
            vprint ("null");
            break;
        default:
            advise (NULLCP, "Block-Alignment has unknown component: %d", p23);
            return NOTOK;
    }

    return OK;
}
