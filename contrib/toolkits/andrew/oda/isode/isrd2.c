/* automatically generated by pepy 5.0 #1 (mss.andrew.cmu.edu), do not edit! */

#include <psap.h>

static char *pepyid = "pepy 5.0 #1 (mss.andrew.cmu.edu) of Mon May 22 20:44:32 EDT 1989";

#define	advise	PY_advise

void	advise ();

/* Generated from module ISRD2 */
# line 5 "isrd2.py"


/*
 *
 * (C) Copyright 1989 by Carnegie Mellon University
 *
 * Permission to use, copy, modify, and distribute these programs
 * and their documentation for any purpose and without fee is
 * hereby granted, provided that this copyright and permission
 * notice appear on all copies and supporting documentation, and
 * that the name of Carnegie Mellon University not be used in
 * advertising or publicity pertaining to distribution of the
 * programs without specific prior permission and notice be given
 * in supporting documentation that copying and distribution is
 * by permission of Carnegie Mellon University.
 *
 * Carnegie Mellon University makes no representations about the
 * suitability of this software for any purpose.  It is provided
 * as is, without express or implied warranty.
 *
 * Software by Ann Marks and James T. Lui,
 * Information Technology Center, Carnegie Mellon University,
 * except where noted.
 *
 */

#include <odatk.h>

#define TK_IMPL_ISRD

#include <isrd.h>

#undef TK_IMPL_ISRD

#define PEPYPARM struct isode2toolkit_t *


#ifndef PEPYPARM
#define PEPYPARM char *
#endif /* PEPYPARM */
extern PEPYPARM NullParm;

/* ARGSUSED */

int	parse_ISRD2_Document__Profile__Descriptor (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p0_count = 0;
    register PE p0;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Profile-Descriptor");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Document-Profile-Descriptor bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Document-Profile-Descriptor bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p0 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Document-Profile-Descriptor bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p0;

    if (p0 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p0, "generic-layout-structure");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p0, "specific-layout-structure");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p0, "generic-logical-structure");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p0, "specific-logical-structure");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p0, "presentation-styles");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p0, "layout-styles");
#endif

        if (parse_UNIV_NumericString (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 9)) {
        register PE p1 = p0;

        {	/* external-document-class TAG PULLUP */
            register PE p2;

            if ((p2 = prim2set (p1)) == NULLPE) {
                advise (NULLCP, "external-document-class bad external-document-class: %s",
                        pe_error (p1 -> pe_errno));
                return NOTOK;
            }
            if (p2 -> pe_cardinal != 1) {
                advise (NULLCP, "external-document-class too many elements for tagged external-document-class: %d",
                        p2 -> pe_cardinal);
                return NOTOK;
            }
            p1 = first_member (p2);
        }
        {
#ifdef DEBUG
            (void) testdebug (p1, "external-document-class");
#endif

            if (parse_ISRD2_Document__Reference (p1, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 10)) {
        register PE p3 = p0;

        {	/* resource-document TAG PULLUP */
            register PE p4;

            if ((p4 = prim2set (p3)) == NULLPE) {
                advise (NULLCP, "resource-document bad resource-document: %s",
                        pe_error (p3 -> pe_errno));
                return NOTOK;
            }
            if (p4 -> pe_cardinal != 1) {
                advise (NULLCP, "resource-document too many elements for tagged resource-document: %d",
                        p4 -> pe_cardinal);
                return NOTOK;
            }
            p3 = first_member (p4);
        }
        {
#ifdef DEBUG
            (void) testdebug (p3, "resource-document");
#endif

            if (parse_ISRD2_Document__Reference (p3, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 11)) {
        register PE p5;

#ifdef DEBUG
        (void) testdebug (p0, "resources");
#endif

        if ((p5 = prim2set (p0)) == NULLPE) {
            advise (NULLCP, "resources bad set: %s",
                    pe_error (p0 -> pe_errno));
            return NOTOK;
        }
        p0 = p5;

        for (p5 = first_member (p0); p5; p5 = next_member (p0, p5)) {
            int p6_count = 0;
            register PE p6;

#ifdef DEBUG
            (void) testdebug (p5, "member");
#endif

            if (p5 -> pe_class != PE_CLASS_UNIV
                    || p5 -> pe_form != PE_FORM_CONS
                    || p5 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p5 -> pe_class], p5 -> pe_form, p5 -> pe_id);
                return NOTOK;
            }

            if ((p6 = prim2set (p5)) == NULLPE) {
                advise (NULLCP, "member bad set: %s",
                        pe_error (p5 -> pe_errno));
                return NOTOK;
            }
            p5 = p6;

            if (p6 = set_find (p5, PE_CLASS_UNIV, 19)) {
#ifdef DEBUG
                (void) testdebug (p6, "resource-identifier");
#endif

                if (parse_ISRD3_Resource__Name (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p6_count ++;
            }
            else {
                advise (NULLCP, "resource-identifier missing resource-identifier member");
                return NOTOK;
            }

            if (p6 = set_find (p5, PE_CLASS_APPL, 1)) {
#ifdef DEBUG
                (void) testdebug (p6, "object-class-identifier");
#endif

                if (parse_ISRD3_Object__or__Class__Identifier (p6, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p6_count ++;
            }
            else {
                advise (NULLCP, "object-class-identifier missing object-class-identifier member");
                return NOTOK;
            }

            if (p6_count != p5 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p0, "document-characteristics");
#endif

        if (parse_ISRD2_Document__Characteristics (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p0, "document-management-attributes");
#endif

        if (parse_ISRD2_Document__Management__Attributes (p0, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p0_count ++;
    }
    if (p0_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Document__Characteristics (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p7_count = 0;
    register PE p7;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Characteristics");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Document-Characteristics bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Document-Characteristics bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p7 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Document-Characteristics bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p7;

    if ( (p7 = set_find (pe, PE_CLASS_CONT, 0))
        || (p7 = set_find (pe, PE_CLASS_CONT, 4)) ) {
#ifdef DEBUG
        (void) testdebug (p7, "document-application-profile");
#endif

        switch (PE_ID (p7 -> pe_class, p7 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):
                {
                    register int p8;

#ifdef DEBUG
                    (void) testdebug (p7, "member");
#endif

                    if ((p8 = prim2num (p7)) == NOTOK
                            && p7 -> pe_errno != PE_ERR_NONE) {
                        advise (NULLCP, "member bad integer: %s",
                                pe_error (p7 -> pe_errno));
                        return NOTOK;
                    }
                    switch (p8) {
                        case 2:	/* group-4-facsimile */
                            break;
                        default:
                            advise (NULLCP, "member has unknown component: %d", p8);
                            return NOTOK;
                    }
                }
                break;
            case PE_ID (PE_CLASS_CONT, 4):
                {
#ifdef DEBUG
                    (void) testdebug (p7, "member");
#endif

                    if (prim2oid (p7) == NULLOID) {
                        advise (NULLCP, "member bad object identifier: %s",
                                pe_error (p7 -> pe_errno));
                        return NOTOK;
                    }
                }
                break;

            default:
                advise (NULLCP, "document-application-profile has unknown choice: %s/%d/0x%x",
                        pe_classlist[p7 -> pe_class], p7 -> pe_form, p7 -> pe_id);
                return NOTOK;
        }
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 10)) {
#ifdef DEBUG
        (void) testdebug (p7, "doc-appl-profile-defaults");
#endif

        if (parse_ISRD2_Doc__Appl__Profile__Defaults (p7, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 1)) {
        register int p9;

#ifdef DEBUG
        (void) testdebug (p7, "document-architecture-class");
#endif

        if ((p9 = prim2num (p7)) == NOTOK
                && p7 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "document-architecture-class bad integer: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        switch (p9) {
            case 0:	/* formatted */
                break;
            case 1:	/* processable */
                break;
            case 2:	/* formatted-processable */
                break;
            default:
                advise (NULLCP, "document-architecture-class has unknown component: %d", p9);
                return NOTOK;
        }
        p7_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p7 = set_find (pe, PE_CLASS_CONT, 5)) {
        register PE p10;

#ifdef DEBUG
        (void) testdebug (p7, "content-architecture-classes");
#endif

        if ((p10 = prim2set (p7)) == NULLPE) {
            advise (NULLCP, "content-architecture-classes bad set: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        p7 = p10;

        for (p10 = first_member (p7); p10; p10 = next_member (p7, p10)) {
#ifdef DEBUG
            (void) testdebug (p10, "member");
#endif

            if (p10 -> pe_class != PE_CLASS_UNIV
                    || p10 -> pe_form != PE_FORM_PRIM
                    || p10 -> pe_id != PE_PRIM_OID) {
                advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p10 -> pe_class], p10 -> pe_form, p10 -> pe_id);
                return NOTOK;
            }

            if (prim2oid (p10) == NULLOID) {
                advise (NULLCP, "member bad object identifier: %s",
                        pe_error (p10 -> pe_errno));
                return NOTOK;
            }
        }
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 6)) {
        register int p11;

#ifdef DEBUG
        (void) testdebug (p7, "interchange-format-class");
#endif

        if ((p11 = prim2num (p7)) == NOTOK
                && p7 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "interchange-format-class bad integer: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        switch (p11) {
            case 0:	/* if-a */
                break;
            case 1:	/* if-b */
                break;
            default:
                advise (NULLCP, "interchange-format-class has unknown component: %d", p11);
                return NOTOK;
        }
        p7_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p7 = set_find (pe, PE_CLASS_CONT, 8)) {
        register PE p12;

#ifdef DEBUG
        (void) testdebug (p7, "oda-version");
#endif

        if ((p12 = prim2seq (p7)) == NULLPE) {
            advise (NULLCP, "oda-version bad sequence: %s",
                    pe_error (p7 -> pe_errno));
            return NOTOK;
        }
        p7 = p12;

        {
            register PE p13;

            if ((p13 = first_member (p7)) != NULLPE) {
                p12 = p13;

                {	/* standard-or-recommendation */
#ifdef DEBUG
                    (void) testdebug (p13, "standard-or-recommendation");
#endif

                    if (parse_ISRD2_Character__Data (p13, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
            else {
                advise (NULLCP, "oda-version missing standard-or-recommendation element");
                return NOTOK;
            }

        }

        {
            register PE p14;

            if ((p14 = (p7 != p12 ? next_member (p7, p12) : first_member (p7))) != NULLPE) {
                p12 = p14;

                {	/* publication-date */
#ifdef DEBUG
                    (void) testdebug (p14, "publication-date");
#endif

                    if (parse_ISRD2_Date__and__Time (p14, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
            }
            else {
                advise (NULLCP, "oda-version missing publication-date element");
                return NOTOK;
            }

        }


        if (p7 -> pe_cardinal > 2) {
            advise (NULLCP, "oda-version has too many elements(2): %d",
                    p7 -> pe_cardinal);
            return NOTOK;
        }
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p7, "non-basic-doc-characteristics");
#endif

        if (parse_ISRD2_Non__Basic__Doc__Characteristics (p7, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p7, "non-basic-struc-characteristics");
#endif

        if (parse_ISRD2_Non__Basic__Struc__Characteristics (p7, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p7_count ++;
    }
    if (p7 = set_find (pe, PE_CLASS_CONT, 9)) {
#ifdef DEBUG
        (void) testdebug (p7, "additional-doc-characteristics");
#endif

        if (parse_ISRD2_Additional__Doc__Characteristics (p7, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p7_count ++;
    }
    if (p7_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Doc__Appl__Profile__Defaults (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p15_count = 0;
    register PE p15;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Doc-Appl-Profile-Defaults");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Doc-Appl-Profile-Defaults bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Doc-Appl-Profile-Defaults bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p15 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Doc-Appl-Profile-Defaults bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p15;

    if (p15 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p15, "document-architecture-defaults");
#endif

        if (parse_ISRD2_Document__Architecture__Defaults (p15, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p15_count ++;
    }
    if (p15 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p15, "character-content-defaults");
#endif

        if (parse_ISRD11_Character__Content__Defaults (p15, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p15_count ++;
    }
    if (p15 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p15, "raster-gr-content-defaults");
#endif

        if (parse_ISRD14_Raster__Gr__Content__Defaults (p15, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p15_count ++;
    }
    if (p15 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p15, "geo-gr-content-defaults");
#endif

        if (parse_ISRD17_Geo__Gr__Content__Defaults (p15, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p15_count ++;
    }
    if (p15 = set_find (pe, PE_CLASS_CONT, 7)) {
        register PE p16;

#ifdef DEBUG
        (void) testdebug (p15, "external-content-architecture-defaults");
#endif

        if ((p16 = prim2seq (p15)) == NULLPE) {
            advise (NULLCP, "external-content-architecture-defaults bad sequence: %s",
                    pe_error (p15 -> pe_errno));
            return NOTOK;
        }
        p15 = p16;

        for (p16 = first_member (p15); p16; p16 = next_member (p15, p16)) {
#ifdef DEBUG
            (void) testdebug (p16, "element");
#endif

            if (parse_UNIV_EXTERNAL (p16, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p15_count ++;
    }
    if (p15_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Document__Architecture__Defaults (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p17_count = 0;
    register PE p17;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Architecture-Defaults");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Document-Architecture-Defaults bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Document-Architecture-Defaults bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p17 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Document-Architecture-Defaults bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p17;

    if (p17 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p17, "content-architecture-class");
#endif

        if (parse_ISRD6_Content__Architecture__Class (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p17, "content-type");
#endif

        if (parse_ISRD6_Content__Type (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p17, "page-dimensions");
#endif

        if (parse_ISRD4_Measure__Pair (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p17, "transparency");
#endif

        if (parse_ISRD4_Transparency (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p17, "colour");
#endif

        if (parse_ISRD4_Colour (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p17, "layout-path");
#endif

        if (parse_ISRD4_One__Of__Four__Angles (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p17, "medium-type");
#endif

        if (parse_ISRD4_Medium__Type (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p17, "block-alignment");
#endif

        if (parse_ISRD6_Block__Alignment (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 8)) {
#ifdef DEBUG
        (void) testdebug (p17, "border");
#endif

        if (parse_ISRD4_Border (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 9)) {
#ifdef DEBUG
        (void) testdebug (p17, "page-position");
#endif

        if (parse_ISRD4_Measure__Pair (p17, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p17_count ++;
    }
    if (p17 = set_find (pe, PE_CLASS_CONT, 10)) {
        register PE p18 = p17;

        {	/* type-of-coding TAG PULLUP */
            register PE p19;

            if ((p19 = prim2set (p18)) == NULLPE) {
                advise (NULLCP, "type-of-coding bad type-of-coding: %s",
                        pe_error (p18 -> pe_errno));
                return NOTOK;
            }
            if (p19 -> pe_cardinal != 1) {
                advise (NULLCP, "type-of-coding too many elements for tagged type-of-coding: %d",
                        p19 -> pe_cardinal);
                return NOTOK;
            }
            p18 = first_member (p19);
        }
        {
#ifdef DEBUG
            (void) testdebug (p18, "type-of-coding");
#endif

            if (parse_ISRD8_Type__of__Coding (p18, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p17_count ++;
    }
    if (p17_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Non__Basic__Doc__Characteristics (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p20_count = 0;
    register PE p20;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Non-Basic-Doc-Characteristics");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Non-Basic-Doc-Characteristics bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Non-Basic-Doc-Characteristics bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p20 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Non-Basic-Doc-Characteristics bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p20;

    if (p20 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p20, "profile-character-sets");
#endif

        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p20, "comments-character-sets");
#endif

        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p20, "alternative-reper-char-sets");
#endif

        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 2)) {
        register PE p21;

#ifdef DEBUG
        (void) testdebug (p20, "page-dimensions");
#endif

        if ((p21 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "page-dimensions bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p21;

        for (p21 = first_member (p20); p21; p21 = next_member (p20, p21)) {
#ifdef DEBUG
            (void) testdebug (p21, "member");
#endif

            if (parse_ISRD4_Measure__Pair (p21, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 8)) {
        register PE p22;

#ifdef DEBUG
        (void) testdebug (p20, "medium-types");
#endif

        if ((p22 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "medium-types bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p22;

        for (p22 = first_member (p20); p22; p22 = next_member (p20, p22)) {
#ifdef DEBUG
            (void) testdebug (p22, "member");
#endif

            if (parse_ISRD4_Medium__Type (p22, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 21)) {
        register PE p23;

#ifdef DEBUG
        (void) testdebug (p20, "layout-paths");
#endif

        if ((p23 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "layout-paths bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p23;

        for (p23 = first_member (p20); p23; p23 = next_member (p20, p23)) {
#ifdef DEBUG
            (void) testdebug (p23, "member");
#endif

            if (parse_ISRD4_One__Of__Four__Angles (p23, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 22)) {
        register PE p24;

#ifdef DEBUG
        (void) testdebug (p20, "transparencies");
#endif

        if ((p24 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "transparencies bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p24;

        for (p24 = first_member (p20); p24; p24 = next_member (p20, p24)) {
#ifdef DEBUG
            (void) testdebug (p24, "member");
#endif

            if (parse_ISRD4_Transparency (p24, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 23)) {
        register PE p25;

#ifdef DEBUG
        (void) testdebug (p20, "protections");
#endif

        if ((p25 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "protections bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p25;

        for (p25 = first_member (p20); p25; p25 = next_member (p20, p25)) {
#ifdef DEBUG
            (void) testdebug (p25, "member");
#endif

            if (parse_ISRD5_Protection (p25, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 24)) {
        register PE p26;

#ifdef DEBUG
        (void) testdebug (p20, "block-alignments");
#endif

        if ((p26 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "block-alignments bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p26;

        for (p26 = first_member (p20); p26; p26 = next_member (p20, p26)) {
#ifdef DEBUG
            (void) testdebug (p26, "member");
#endif

            if (parse_ISRD6_Block__Alignment (p26, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 25)) {
        register PE p27;

#ifdef DEBUG
        (void) testdebug (p20, "fill-orders");
#endif

        if ((p27 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "fill-orders bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p27;

        for (p27 = first_member (p20); p27; p27 = next_member (p20, p27)) {
#ifdef DEBUG
            (void) testdebug (p27, "member");
#endif

            if (parse_ISRD6_Fill__Order (p27, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 26)) {
        register PE p28;

#ifdef DEBUG
        (void) testdebug (p20, "colours");
#endif

        if ((p28 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "colours bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p28;

        for (p28 = first_member (p20); p28; p28 = next_member (p20, p28)) {
#ifdef DEBUG
            (void) testdebug (p28, "member");
#endif

            if (parse_ISRD4_Colour (p28, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 27)) {
        register PE p29;

#ifdef DEBUG
        (void) testdebug (p20, "borders");
#endif

        if ((p29 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "borders bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p29;

        for (p29 = first_member (p20); p29; p29 = next_member (p20, p29)) {
#ifdef DEBUG
            (void) testdebug (p29, "member");
#endif

            if (parse_ISRD4_Border (p29, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 28)) {
        register PE p30;

#ifdef DEBUG
        (void) testdebug (p20, "page-positions");
#endif

        if ((p30 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "page-positions bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p30;

        for (p30 = first_member (p20); p30; p30 = next_member (p20, p30)) {
#ifdef DEBUG
            (void) testdebug (p30, "member");
#endif

            if (parse_ISRD4_Measure__Pair (p30, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 29)) {
        register PE p31;

#ifdef DEBUG
        (void) testdebug (p20, "types-of-coding");
#endif

        if ((p31 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "types-of-coding bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p31;

        for (p31 = first_member (p20); p31; p31 = next_member (p20, p31)) {
#ifdef DEBUG
            (void) testdebug (p31, "member");
#endif

            if (parse_ISRD8_Type__of__Coding (p31, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 9)) {
        register PE p32;

#ifdef DEBUG
        (void) testdebug (p20, "char-presentation-features");
#endif

        if ((p32 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "char-presentation-features bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p32;

        for (p32 = first_member (p20); p32; p32 = next_member (p20, p32)) {
#ifdef DEBUG
            (void) testdebug (p32, "member");
#endif

            if (parse_ISRD11_Char__Presentation__Features (p32, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 4)) {
        register PE p33;

#ifdef DEBUG
        (void) testdebug (p20, "ra-gr-presentation-features");
#endif

        if ((p33 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "ra-gr-presentation-features bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p33;

        for (p33 = first_member (p20); p33; p33 = next_member (p20, p33)) {
#ifdef DEBUG
            (void) testdebug (p33, "member");
#endif

            if (parse_ISRD14_Ra__Gr__Presentation__Features (p33, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 12)) {
        register PE p34;

#ifdef DEBUG
        (void) testdebug (p20, "geo-gr-presentation-features");
#endif

        if ((p34 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "geo-gr-presentation-features bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p34;

        for (p34 = first_member (p20); p34; p34 = next_member (p20, p34)) {
#ifdef DEBUG
            (void) testdebug (p34, "member");
#endif

            if (parse_ISRD17_Geo__Gr__Presentation__Features (p34, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 16)) {
        register PE p35;

#ifdef DEBUG
        (void) testdebug (p20, "character-coding-attributes");
#endif

        if ((p35 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "character-coding-attributes bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p35;

        for (p35 = first_member (p20); p35; p35 = next_member (p20, p35)) {
#ifdef DEBUG
            (void) testdebug (p35, "member");
#endif

            if (parse_ISRD10_Character__Coding__Attributes (p35, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 3)) {
        register PE p36;

#ifdef DEBUG
        (void) testdebug (p20, "ra-gr-coding-attributes");
#endif

        if ((p36 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "ra-gr-coding-attributes bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p36;

        for (p36 = first_member (p20); p36; p36 = next_member (p20, p36)) {
#ifdef DEBUG
            (void) testdebug (p36, "member");
#endif

            if (parse_ISRD13_Raster__Gr__Coding__Attributes (p36, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 17)) {
        register PE p37;

#ifdef DEBUG
        (void) testdebug (p20, "geo-gr-coding-attributes");
#endif

        if ((p37 = prim2set (p20)) == NULLPE) {
            advise (NULLCP, "geo-gr-coding-attributes bad set: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p37;

        for (p37 = first_member (p20); p37; p37 = next_member (p20, p37)) {
#ifdef DEBUG
            (void) testdebug (p37, "member");
#endif

            if (parse_ISRD16_Geo__Gr__Coding__Attributes (p37, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 10)) {
        register PE p38;

#ifdef DEBUG
        (void) testdebug (p20, "ext-non-basic-pres-features");
#endif

        if ((p38 = prim2seq (p20)) == NULLPE) {
            advise (NULLCP, "ext-non-basic-pres-features bad sequence: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p38;

        for (p38 = first_member (p20); p38; p38 = next_member (p20, p38)) {
#ifdef DEBUG
            (void) testdebug (p38, "element");
#endif

            if (parse_UNIV_EXTERNAL (p38, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20 = set_find (pe, PE_CLASS_CONT, 11)) {
        register PE p39;

#ifdef DEBUG
        (void) testdebug (p20, "ext-non-basic-coding-attributes");
#endif

        if ((p39 = prim2seq (p20)) == NULLPE) {
            advise (NULLCP, "ext-non-basic-coding-attributes bad sequence: %s",
                    pe_error (p20 -> pe_errno));
            return NOTOK;
        }
        p20 = p39;

        for (p39 = first_member (p20); p39; p39 = next_member (p20, p39)) {
#ifdef DEBUG
            (void) testdebug (p39, "element");
#endif

            if (parse_UNIV_EXTERNAL (p39, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p20_count ++;
    }
    if (p20_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Non__Basic__Struc__Characteristics (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p40_count = 0;
    register PE p40;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Non-Basic-Struc-Characteristics");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Non-Basic-Struc-Characteristics bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Non-Basic-Struc-Characteristics bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p40 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Non-Basic-Struc-Characteristics bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p40;

    if (p40 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p40, "number-of-objects-per-page");
#endif

        if (prim2num (p40) == NOTOK
                && p40 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "number-of-objects-per-page bad integer: %s",
                    pe_error (p40 -> pe_errno));
            return NOTOK;
        }
        p40_count ++;
    }
    if (p40_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Additional__Doc__Characteristics (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p41_count = 0;
    register PE p41;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Additional-Doc-Characteristics");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Additional-Doc-Characteristics bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Additional-Doc-Characteristics bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p41 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Additional-Doc-Characteristics bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p41;

    if (p41 = set_find (pe, PE_CLASS_CONT, 3)) {
        register PE p42;

#ifdef DEBUG
        (void) testdebug (p41, "unit-scaling");
#endif

        if ((p42 = prim2seq (p41)) == NULLPE) {
            advise (NULLCP, "unit-scaling bad sequence: %s",
                    pe_error (p41 -> pe_errno));
            return NOTOK;
        }
        p41 = p42;

        {
            register PE p43;

            if ((p43 = first_member (p41)) != NULLPE) {
                p42 = p43;

                {
#ifdef DEBUG
                    (void) testdebug (p43, "element");
#endif

                    if (p43 -> pe_class != PE_CLASS_UNIV
                            || p43 -> pe_form != PE_FORM_PRIM
                            || p43 -> pe_id != PE_PRIM_INT) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p43 -> pe_class], p43 -> pe_form, p43 -> pe_id);
                        return NOTOK;
                    }

                    if (prim2num (p43) == NOTOK
                            && p43 -> pe_errno != PE_ERR_NONE) {
                        advise (NULLCP, "element bad integer: %s",
                                pe_error (p43 -> pe_errno));
                        return NOTOK;
                    }
                }
            }
            else {
                advise (NULLCP, "unit-scaling missing element");
                return NOTOK;
            }

        }

        {
            register PE p44;

            if ((p44 = (p41 != p42 ? next_member (p41, p42) : first_member (p41))) != NULLPE) {
                p42 = p44;

                {
#ifdef DEBUG
                    (void) testdebug (p44, "element");
#endif

                    if (p44 -> pe_class != PE_CLASS_UNIV
                            || p44 -> pe_form != PE_FORM_PRIM
                            || p44 -> pe_id != PE_PRIM_INT) {
                        advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p44 -> pe_class], p44 -> pe_form, p44 -> pe_id);
                        return NOTOK;
                    }

                    if (prim2num (p44) == NOTOK
                            && p44 -> pe_errno != PE_ERR_NONE) {
                        advise (NULLCP, "element bad integer: %s",
                                pe_error (p44 -> pe_errno));
                        return NOTOK;
                    }
                }
            }
            else {
                advise (NULLCP, "unit-scaling missing element");
                return NOTOK;
            }

        }


        if (p41 -> pe_cardinal > 2) {
            advise (NULLCP, "unit-scaling has too many elements(2): %d",
                    p41 -> pe_cardinal);
            return NOTOK;
        }
        p41_count ++;
    }
    if (p41 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p41, "fonts-list");
#endif

        if (parse_ISRD2_Fonts__List (p41, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p41_count ++;
    }
    if (p41_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Fonts__List (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p45;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Fonts-List");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Fonts-List bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Fonts-List bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p45 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Fonts-List bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p45;

    for (p45 = first_member (pe); p45; p45 = next_member (pe, p45)) {
#ifdef DEBUG
        (void) testdebug (p45, "member");
#endif

        if (parse_ISRD2_Fonts__List__Prime (p45, 1, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Fonts__List__Prime (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p46_count = 0;
    register PE p46;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Fonts-List-Prime");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Fonts-List-Prime bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Fonts-List-Prime bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p46 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Fonts-List-Prime bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p46;

    if (p46 = set_find (pe, PE_CLASS_UNIV, 2)) {
#ifdef DEBUG
        (void) testdebug (p46, "font-identifier");
#endif

        if (prim2num (p46) == NOTOK
                && p46 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "font-identifier bad integer: %s",
                    pe_error (p46 -> pe_errno));
            return NOTOK;
        }
        p46_count ++;
    }
    else {
        advise (NULLCP, "font-identifier missing font-identifier member");
        return NOTOK;
    }

    if (p46 = set_find (pe, PE_CLASS_UNIV, 16)) {
#ifdef DEBUG
        (void) testdebug (p46, "font-reference");
#endif

        if (parse_ISRD18_Font__Reference (p46, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p46_count ++;
    }
    else {
        advise (NULLCP, "font-reference missing font-reference member");
        return NOTOK;
    }

    if (p46_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Document__Management__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p47_count = 0;
    register PE p47;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Management-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Document-Management-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Document-Management-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p47 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Document-Management-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p47;

    if (p47 = set_find (pe, PE_CLASS_CONT, 7)) {
#ifdef DEBUG
        (void) testdebug (p47, "document-description");
#endif

        if (parse_ISRD2_Document__Description (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p47, "dates-and-times");
#endif

        if (parse_ISRD2_Dates__and__Times (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p47, "originators");
#endif

        if (parse_ISRD2_Originators (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p47, "other-user-information");
#endif

        if (parse_ISRD2_Other__User__Information (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p47, "external-references");
#endif

        if (parse_ISRD2_External__References (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p47, "local-file-refernces");
#endif

        if (parse_ISRD2_Local__File__References (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p47, "content-attributes");
#endif

        if (parse_ISRD2_Content__Attributes (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p47, "security-information");
#endif

        if (parse_ISRD2_Security__Information (p47, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p47_count ++;
    }
    if (p47_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Document__Description (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p48_count = 0;
    register PE p48;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Description");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Document-Description bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Document-Description bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p48 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Document-Description bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p48;

    if (p48 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p48, "title");
#endif

        if (parse_ISRD2_Character__Data (p48, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p48_count ++;
    }
    if (p48 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p48, "subject");
#endif

        if (parse_ISRD2_Character__Data (p48, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p48_count ++;
    }
    if (p48 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p48, "document-type");
#endif

        if (parse_ISRD2_Character__Data (p48, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p48_count ++;
    }
    if (p48 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p48, "abstract");
#endif

        if (parse_ISRD2_Character__Data (p48, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p48_count ++;
    }
    if (p48 = set_find (pe, PE_CLASS_CONT, 4)) {
        register PE p49;

#ifdef DEBUG
        (void) testdebug (p48, "keywords");
#endif

        if ((p49 = prim2set (p48)) == NULLPE) {
            advise (NULLCP, "keywords bad set: %s",
                    pe_error (p48 -> pe_errno));
            return NOTOK;
        }
        p48 = p49;

        for (p49 = first_member (p48); p49; p49 = next_member (p48, p49)) {
#ifdef DEBUG
            (void) testdebug (p49, "member");
#endif

            if (parse_ISRD2_Character__Data (p49, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p48_count ++;
    }
    if (p48 = set_find (pe, PE_CLASS_CONT, 5)) {
        register PE p50 = p48;

        {	/* document-reference TAG PULLUP */
            register PE p51;

            if ((p51 = prim2set (p50)) == NULLPE) {
                advise (NULLCP, "document-reference bad document-reference: %s",
                        pe_error (p50 -> pe_errno));
                return NOTOK;
            }
            if (p51 -> pe_cardinal != 1) {
                advise (NULLCP, "document-reference too many elements for tagged document-reference: %d",
                        p51 -> pe_cardinal);
                return NOTOK;
            }
            p50 = first_member (p51);
        }
        {
#ifdef DEBUG
            (void) testdebug (p50, "document-reference");
#endif

            if (parse_ISRD2_Document__Reference (p50, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p48_count ++;
    }
    if (p48_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Character__Data (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register char *p52;
    int p52_len;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Character-Data");
#endif

    if (explicit
            && PE_ID (pe -> pe_class, pe -> pe_id)
                    != PE_ID (PE_CLASS_APPL, 3)) {
        advise (NULLCP, "Character-Data bad class/id: %s/0x%x", 
                pe_classlist[pe -> pe_class], pe -> pe_id);
        return NOTOK;
    }
    if ((p52 = prim2str (pe, &p52_len)) == NULLCP) {
        advise (NULLCP, "Character-Data bad octetstring: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    if (len)
        *len = p52_len;
    if (buffer)
        *buffer = p52;
    else
        if (p52)
            free (p52);

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Document__Reference (pe, explicit, len, buffer, parm)
PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Document-Reference");
#endif

    switch (PE_ID (pe -> pe_class, pe -> pe_id)) {
        case PE_ID (PE_CLASS_UNIV, 6):	/* unique-reference */
            {
#ifdef DEBUG
                (void) testdebug (pe, "unique-reference");
#endif

                if (prim2oid (pe) == NULLOID) {
                    advise (NULLCP, "unique-reference bad object identifier: %s",
                            pe_error (pe -> pe_errno));
                    return NOTOK;
                }
            }
            break;
        case PE_ID (PE_CLASS_APPL, 3):	/* descriptive-reference */
            {
#ifdef DEBUG
                (void) testdebug (pe, "descriptive-reference");
#endif

                if (parse_ISRD2_Character__Data (pe, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
            }
            break;

        default:
            advise (NULLCP, "Document-Reference has unknown choice: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Dates__and__Times (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p53_count = 0;
    register PE p53;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Dates-and-Times");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Dates-and-Times bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Dates-and-Times bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p53 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Dates-and-Times bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p53;

    if (p53 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p53, "document-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p53, "creation-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 2)) {
        register PE p54;

#ifdef DEBUG
        (void) testdebug (p53, "local-filing-date-and-time");
#endif

        if ((p54 = prim2seq (p53)) == NULLPE) {
            advise (NULLCP, "local-filing-date-and-time bad sequence: %s",
                    pe_error (p53 -> pe_errno));
            return NOTOK;
        }
        p53 = p54;

        for (p54 = first_member (p53); p54; p54 = next_member (p53, p54)) {
#ifdef DEBUG
            (void) testdebug (p54, "element");
#endif

            if (parse_ISRD2_Date__and__Time (p54, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p53, "expiry-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
        (void) testdebug (p53, "start-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 5)) {
#ifdef DEBUG
        (void) testdebug (p53, "purge-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 6)) {
#ifdef DEBUG
        (void) testdebug (p53, "release-date-and-time");
#endif

        if (parse_ISRD2_Date__and__Time (p53, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p53_count ++;
    }
    if (p53 = set_find (pe, PE_CLASS_CONT, 7)) {
        register PE p55;

#ifdef DEBUG
        (void) testdebug (p53, "revision-history");
#endif

        if ((p55 = prim2seq (p53)) == NULLPE) {
            advise (NULLCP, "revision-history bad sequence: %s",
                    pe_error (p53 -> pe_errno));
            return NOTOK;
        }
        p53 = p55;

        for (p55 = first_member (p53); p55; p55 = next_member (p53, p55)) {
            int p56_count = 0;
            register PE p56;

#ifdef DEBUG
            (void) testdebug (p55, "element");
#endif

            if (p55 -> pe_class != PE_CLASS_UNIV
                    || p55 -> pe_form != PE_FORM_CONS
                    || p55 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p55 -> pe_class], p55 -> pe_form, p55 -> pe_id);
                return NOTOK;
            }

            if ((p56 = prim2set (p55)) == NULLPE) {
                advise (NULLCP, "element bad set: %s",
                        pe_error (p55 -> pe_errno));
                return NOTOK;
            }
            p55 = p56;

            if (p56 = set_find (p55, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
                (void) testdebug (p56, "revision-date-and-time");
#endif

                if (parse_ISRD2_Date__and__Time (p56, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p56_count ++;
            }
            if (p56 = set_find (p55, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                (void) testdebug (p56, "version-number");
#endif

                if (parse_UNIV_NumericString (p56, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p56_count ++;
            }
            if (p56 = set_find (p55, PE_CLASS_CONT, 2)) {
                register PE p57;

#ifdef DEBUG
                (void) testdebug (p56, "revisors");
#endif

                if ((p57 = prim2set (p56)) == NULLPE) {
                    advise (NULLCP, "revisors bad set: %s",
                            pe_error (p56 -> pe_errno));
                    return NOTOK;
                }
                p56 = p57;

                for (p57 = first_member (p56); p57; p57 = next_member (p56, p57)) {
                    int p58_count = 0;
                    register PE p58;

#ifdef DEBUG
                    (void) testdebug (p57, "member");
#endif

                    if (p57 -> pe_class != PE_CLASS_UNIV
                            || p57 -> pe_form != PE_FORM_CONS
                            || p57 -> pe_id != PE_CONS_SET) {
                        advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                                pe_classlist[p57 -> pe_class], p57 -> pe_form, p57 -> pe_id);
                        return NOTOK;
                    }

                    if ((p58 = prim2set (p57)) == NULLPE) {
                        advise (NULLCP, "member bad set: %s",
                                pe_error (p57 -> pe_errno));
                        return NOTOK;
                    }
                    p57 = p58;

                    if (p58 = set_find (p57, PE_CLASS_CONT, 0)) {
                        register PE p59;

#ifdef DEBUG
                        (void) testdebug (p58, "names");
#endif

                        if ((p59 = prim2set (p58)) == NULLPE) {
                            advise (NULLCP, "names bad set: %s",
                                    pe_error (p58 -> pe_errno));
                            return NOTOK;
                        }
                        p58 = p59;

                        for (p59 = first_member (p58); p59; p59 = next_member (p58, p59)) {
#ifdef DEBUG
                            (void) testdebug (p59, "member");
#endif

                            if (parse_ISRD2_Personal__Name (p59, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                                return NOTOK;
                        }
                        p58_count ++;
                    }
                    if (p58 = set_find (p57, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                        (void) testdebug (p58, "position");
#endif

                        if (parse_ISRD2_Character__Data (p58, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                        p58_count ++;
                    }
                    if (p58 = set_find (p57, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
                        (void) testdebug (p58, "organization");
#endif

                        if (parse_ISRD2_Character__Data (p58, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                            return NOTOK;
                        p58_count ++;
                    }
                    if (p58_count != p57 -> pe_cardinal)
                        advise (NULLCP, "warning: extra or duplicate members present in SET");
                }
                p56_count ++;
            }
            if (p56 = set_find (p55, PE_CLASS_CONT, 3)) {
                register PE p60 = p56;

                {	/* version-reference TAG PULLUP */
                    register PE p61;

                    if ((p61 = prim2set (p60)) == NULLPE) {
                        advise (NULLCP, "version-reference bad version-reference: %s",
                                pe_error (p60 -> pe_errno));
                        return NOTOK;
                    }
                    if (p61 -> pe_cardinal != 1) {
                        advise (NULLCP, "version-reference too many elements for tagged version-reference: %d",
                                p61 -> pe_cardinal);
                        return NOTOK;
                    }
                    p60 = first_member (p61);
                }
                {
#ifdef DEBUG
                    (void) testdebug (p60, "version-reference");
#endif

                    if (parse_ISRD2_Document__Reference (p60, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                p56_count ++;
            }
            if (p56 = set_find (p55, PE_CLASS_CONT, 4)) {
#ifdef DEBUG
                (void) testdebug (p56, "user-comments");
#endif

                if (parse_ISRD2_Character__Data (p56, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p56_count ++;
            }
            if (p56_count != p55 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p53_count ++;
    }
    if (p53_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Date__and__Time (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Date-and-Time");
#endif

    if (explicit
            && PE_ID (pe -> pe_class, pe -> pe_id)
                    != PE_ID (PE_CLASS_APPL, 4)) {
        advise (NULLCP, "Date-and-Time bad class/id: %s/0x%x", 
                pe_classlist[pe -> pe_class], pe -> pe_id);
        return NOTOK;
    }
    if (parse_UNIV_PrintableString (pe, 0, len, buffer, NullParm) == NOTOK)
        return NOTOK;

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Originators (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p62_count = 0;
    register PE p62;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Originators");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Originators bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Originators bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p62 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Originators bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p62;

    if (p62 = set_find (pe, PE_CLASS_CONT, 0)) {
        register PE p63;

#ifdef DEBUG
        (void) testdebug (p62, "organizations");
#endif

        if ((p63 = prim2set (p62)) == NULLPE) {
            advise (NULLCP, "organizations bad set: %s",
                    pe_error (p62 -> pe_errno));
            return NOTOK;
        }
        p62 = p63;

        for (p63 = first_member (p62); p63; p63 = next_member (p62, p63)) {
#ifdef DEBUG
            (void) testdebug (p63, "member");
#endif

            if (parse_ISRD2_Character__Data (p63, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p62_count ++;
    }
    if (p62 = set_find (pe, PE_CLASS_CONT, 1)) {
        register PE p64;

#ifdef DEBUG
        (void) testdebug (p62, "preparers");
#endif

        if ((p64 = prim2seq (p62)) == NULLPE) {
            advise (NULLCP, "preparers bad sequence: %s",
                    pe_error (p62 -> pe_errno));
            return NOTOK;
        }
        p62 = p64;

        for (p64 = first_member (p62); p64; p64 = next_member (p62, p64)) {
            int p65_count = 0;
            register PE p65;

#ifdef DEBUG
            (void) testdebug (p64, "element");
#endif

            if (p64 -> pe_class != PE_CLASS_UNIV
                    || p64 -> pe_form != PE_FORM_CONS
                    || p64 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p64 -> pe_class], p64 -> pe_form, p64 -> pe_id);
                return NOTOK;
            }

            if ((p65 = prim2set (p64)) == NULLPE) {
                advise (NULLCP, "element bad set: %s",
                        pe_error (p64 -> pe_errno));
                return NOTOK;
            }
            p64 = p65;

            if (p65 = set_find (p64, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
                (void) testdebug (p65, "personal-name");
#endif

                if (parse_ISRD2_Personal__Name (p65, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p65_count ++;
            }
            if (p65 = set_find (p64, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                (void) testdebug (p65, "organization");
#endif

                if (parse_ISRD2_Character__Data (p65, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p65_count ++;
            }
            if (p65_count != p64 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p62_count ++;
    }
    if (p62 = set_find (pe, PE_CLASS_CONT, 2)) {
        register PE p66;

#ifdef DEBUG
        (void) testdebug (p62, "owners");
#endif

        if ((p66 = prim2seq (p62)) == NULLPE) {
            advise (NULLCP, "owners bad sequence: %s",
                    pe_error (p62 -> pe_errno));
            return NOTOK;
        }
        p62 = p66;

        for (p66 = first_member (p62); p66; p66 = next_member (p62, p66)) {
            int p67_count = 0;
            register PE p67;

#ifdef DEBUG
            (void) testdebug (p66, "element");
#endif

            if (p66 -> pe_class != PE_CLASS_UNIV
                    || p66 -> pe_form != PE_FORM_CONS
                    || p66 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p66 -> pe_class], p66 -> pe_form, p66 -> pe_id);
                return NOTOK;
            }

            if ((p67 = prim2set (p66)) == NULLPE) {
                advise (NULLCP, "element bad set: %s",
                        pe_error (p66 -> pe_errno));
                return NOTOK;
            }
            p66 = p67;

            if (p67 = set_find (p66, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
                (void) testdebug (p67, "personal-name");
#endif

                if (parse_ISRD2_Personal__Name (p67, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p67_count ++;
            }
            if (p67 = set_find (p66, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                (void) testdebug (p67, "organization");
#endif

                if (parse_ISRD2_Character__Data (p67, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p67_count ++;
            }
            if (p67_count != p66 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p62_count ++;
    }
    if (p62 = set_find (pe, PE_CLASS_CONT, 3)) {
        register PE p68;

#ifdef DEBUG
        (void) testdebug (p62, "authors");
#endif

        if ((p68 = prim2seq (p62)) == NULLPE) {
            advise (NULLCP, "authors bad sequence: %s",
                    pe_error (p62 -> pe_errno));
            return NOTOK;
        }
        p62 = p68;

        for (p68 = first_member (p62); p68; p68 = next_member (p62, p68)) {
            int p69_count = 0;
            register PE p69;

#ifdef DEBUG
            (void) testdebug (p68, "element");
#endif

            if (p68 -> pe_class != PE_CLASS_UNIV
                    || p68 -> pe_form != PE_FORM_CONS
                    || p68 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p68 -> pe_class], p68 -> pe_form, p68 -> pe_id);
                return NOTOK;
            }

            if ((p69 = prim2set (p68)) == NULLPE) {
                advise (NULLCP, "element bad set: %s",
                        pe_error (p68 -> pe_errno));
                return NOTOK;
            }
            p68 = p69;

            if (p69 = set_find (p68, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
                (void) testdebug (p69, "personal-name");
#endif

                if (parse_ISRD2_Personal__Name (p69, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p69_count ++;
            }
            if (p69 = set_find (p68, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                (void) testdebug (p69, "organization");
#endif

                if (parse_ISRD2_Character__Data (p69, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p69_count ++;
            }
            if (p69_count != p68 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p62_count ++;
    }
    if (p62_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Personal__Name (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p70_count = 0;
    register PE p70;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Personal-Name");
#endif

    if (explicit
            && PE_ID (pe -> pe_class, pe -> pe_id)
                    != PE_ID (PE_CLASS_APPL, 6)) {
        advise (NULLCP, "Personal-Name bad class/id: %s/0x%x", 
                pe_classlist[pe -> pe_class], pe -> pe_id);
        return NOTOK;
    }
    if ((p70 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Personal-Name bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p70;

    if (p70 = set_find (pe, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
        (void) testdebug (p70, "surname");
#endif

        if (parse_ISRD2_Character__Data (p70, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p70_count ++;
    }
    else {
        advise (NULLCP, "surname missing surname member");
        return NOTOK;
    }

    if (p70 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p70, "givenname");
#endif

        if (parse_ISRD2_Character__Data (p70, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p70_count ++;
    }
    if (p70 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p70, "initials");
#endif

        if (parse_ISRD2_Character__Data (p70, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p70_count ++;
    }
    if (p70 = set_find (pe, PE_CLASS_CONT, 3)) {
#ifdef DEBUG
        (void) testdebug (p70, "title");
#endif

        if (parse_ISRD2_Character__Data (p70, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p70_count ++;
    }
    if (p70_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Other__User__Information (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p71_count = 0;
    register PE p71;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Other-User-Information");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Other-User-Information bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Other-User-Information bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p71 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Other-User-Information bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p71;

    if (p71 = set_find (pe, PE_CLASS_CONT, 0)) {
        register PE p72;

#ifdef DEBUG
        (void) testdebug (p71, "copyright");
#endif

        if ((p72 = prim2set (p71)) == NULLPE) {
            advise (NULLCP, "copyright bad set: %s",
                    pe_error (p71 -> pe_errno));
            return NOTOK;
        }
        p71 = p72;

        for (p72 = first_member (p71); p72; p72 = next_member (p71, p72)) {
            int p73_count = 0;
            register PE p73;

#ifdef DEBUG
            (void) testdebug (p72, "member");
#endif

            if (p72 -> pe_class != PE_CLASS_UNIV
                    || p72 -> pe_form != PE_FORM_CONS
                    || p72 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p72 -> pe_class], p72 -> pe_form, p72 -> pe_id);
                return NOTOK;
            }

            if ((p73 = prim2set (p72)) == NULLPE) {
                advise (NULLCP, "member bad set: %s",
                        pe_error (p72 -> pe_errno));
                return NOTOK;
            }
            p72 = p73;

            if (p73 = set_find (p72, PE_CLASS_CONT, 0)) {
                register PE p74;

#ifdef DEBUG
                (void) testdebug (p73, "copyright-information");
#endif

                if ((p74 = prim2set (p73)) == NULLPE) {
                    advise (NULLCP, "copyright-information bad set: %s",
                            pe_error (p73 -> pe_errno));
                    return NOTOK;
                }
                p73 = p74;

                for (p74 = first_member (p73); p74; p74 = next_member (p73, p74)) {
#ifdef DEBUG
                    (void) testdebug (p74, "member");
#endif

                    if (parse_ISRD2_Character__Data (p74, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                p73_count ++;
            }
            if (p73 = set_find (p72, PE_CLASS_CONT, 1)) {
                register PE p75;

#ifdef DEBUG
                (void) testdebug (p73, "copyright-dates");
#endif

                if ((p75 = prim2set (p73)) == NULLPE) {
                    advise (NULLCP, "copyright-dates bad set: %s",
                            pe_error (p73 -> pe_errno));
                    return NOTOK;
                }
                p73 = p75;

                for (p75 = first_member (p73); p75; p75 = next_member (p73, p75)) {
#ifdef DEBUG
                    (void) testdebug (p75, "member");
#endif

                    if (parse_ISRD2_Character__Data (p75, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                p73_count ++;
            }
            if (p73_count != p72 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p71_count ++;
    }
    if (p71 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p71, "status");
#endif

        if (parse_ISRD2_Character__Data (p71, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p71_count ++;
    }
    if (p71 = set_find (pe, PE_CLASS_CONT, 2)) {
        register PE p76;

#ifdef DEBUG
        (void) testdebug (p71, "user-specific-codes");
#endif

        if ((p76 = prim2set (p71)) == NULLPE) {
            advise (NULLCP, "user-specific-codes bad set: %s",
                    pe_error (p71 -> pe_errno));
            return NOTOK;
        }
        p71 = p76;

        for (p76 = first_member (p71); p76; p76 = next_member (p71, p76)) {
#ifdef DEBUG
            (void) testdebug (p76, "member");
#endif

            if (parse_ISRD2_Character__Data (p76, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p71_count ++;
    }
    if (p71 = set_find (pe, PE_CLASS_CONT, 3)) {
        register PE p77;

#ifdef DEBUG
        (void) testdebug (p71, "distribution-list");
#endif

        if ((p77 = prim2seq (p71)) == NULLPE) {
            advise (NULLCP, "distribution-list bad sequence: %s",
                    pe_error (p71 -> pe_errno));
            return NOTOK;
        }
        p71 = p77;

        for (p77 = first_member (p71); p77; p77 = next_member (p71, p77)) {
            int p78_count = 0;
            register PE p78;

#ifdef DEBUG
            (void) testdebug (p77, "element");
#endif

            if (p77 -> pe_class != PE_CLASS_UNIV
                    || p77 -> pe_form != PE_FORM_CONS
                    || p77 -> pe_id != PE_CONS_SET) {
                advise (NULLCP, "element bad class/form/id: %s/%d/0x%x",
                        pe_classlist[p77 -> pe_class], p77 -> pe_form, p77 -> pe_id);
                return NOTOK;
            }

            if ((p78 = prim2set (p77)) == NULLPE) {
                advise (NULLCP, "element bad set: %s",
                        pe_error (p77 -> pe_errno));
                return NOTOK;
            }
            p77 = p78;

            if (p78 = set_find (p77, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
                (void) testdebug (p78, "personal-name");
#endif

                if (parse_ISRD2_Personal__Name (p78, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p78_count ++;
            }
            if (p78 = set_find (p77, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
                (void) testdebug (p78, "organization");
#endif

                if (parse_ISRD2_Character__Data (p78, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                    return NOTOK;
                p78_count ++;
            }
            if (p78_count != p77 -> pe_cardinal)
                advise (NULLCP, "warning: extra or duplicate members present in SET");
        }
        p71_count ++;
    }
    if (p71 = set_find (pe, PE_CLASS_CONT, 5)) {
        register PE p79 = p71;

        {	/* additional-information TAG PULLUP */
            register PE p80;

            if ((p80 = prim2set (p79)) == NULLPE) {
                advise (NULLCP, "additional-information bad additional-information: %s",
                        pe_error (p79 -> pe_errno));
                return NOTOK;
            }
            if (p80 -> pe_cardinal != 1) {
                advise (NULLCP, "additional-information too many elements for tagged additional-information: %d",
                        p80 -> pe_cardinal);
                return NOTOK;
            }
            p79 = first_member (p80);
        }
        {
#ifdef DEBUG
            (void) testdebug (p79, "additional-information");
#endif

        }
        p71_count ++;
    }
    if (p71_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_External__References (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p81_count = 0;
    register PE p81;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.External-References");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "External-References bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "External-References bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p81 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "External-References bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p81;

    if (p81 = set_find (pe, PE_CLASS_CONT, 0)) {
        register PE p82;

#ifdef DEBUG
        (void) testdebug (p81, "references-to-other-documents");
#endif

        if ((p82 = prim2set (p81)) == NULLPE) {
            advise (NULLCP, "references-to-other-documents bad set: %s",
                    pe_error (p81 -> pe_errno));
            return NOTOK;
        }
        p81 = p82;

        for (p82 = first_member (p81); p82; p82 = next_member (p81, p82)) {
#ifdef DEBUG
            (void) testdebug (p82, "member");
#endif

            if (parse_ISRD2_Document__Reference (p82, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p81_count ++;
    }
    if (p81 = set_find (pe, PE_CLASS_CONT, 1)) {
        register PE p83;

#ifdef DEBUG
        (void) testdebug (p81, "superseded-documents");
#endif

        if ((p83 = prim2set (p81)) == NULLPE) {
            advise (NULLCP, "superseded-documents bad set: %s",
                    pe_error (p81 -> pe_errno));
            return NOTOK;
        }
        p81 = p83;

        for (p83 = first_member (p81); p83; p83 = next_member (p81, p83)) {
#ifdef DEBUG
            (void) testdebug (p83, "member");
#endif

            if (parse_ISRD2_Document__Reference (p83, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p81_count ++;
    }
    if (p81_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Local__File__References (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    register PE p84;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Local-File-References");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Local-File-References bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Local-File-References bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p84 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Local-File-References bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p84;

    for (p84 = first_member (pe); p84; p84 = next_member (pe, p84)) {
        int p85_count = 0;
        register PE p85;

#ifdef DEBUG
        (void) testdebug (p84, "member");
#endif

        if (p84 -> pe_class != PE_CLASS_UNIV
                || p84 -> pe_form != PE_FORM_CONS
                || p84 -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "member bad class/form/id: %s/%d/0x%x",
                    pe_classlist[p84 -> pe_class], p84 -> pe_form, p84 -> pe_id);
            return NOTOK;
        }

        if ((p85 = prim2set (p84)) == NULLPE) {
            advise (NULLCP, "member bad set: %s",
                    pe_error (p84 -> pe_errno));
            return NOTOK;
        }
        p84 = p85;

        if (p85 = set_find (p84, PE_CLASS_CONT, 0)) {
#ifdef DEBUG
            (void) testdebug (p85, "filename");
#endif

            if (parse_ISRD2_Character__Data (p85, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
            p85_count ++;
        }
        if (p85 = set_find (p84, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
            (void) testdebug (p85, "location");
#endif

            if (parse_ISRD2_Character__Data (p85, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
            p85_count ++;
        }
        if (p85 = set_find (p84, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
            (void) testdebug (p85, "user-comments");
#endif

            if (parse_ISRD2_Character__Data (p85, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
            p85_count ++;
        }
        if (p85_count != p84 -> pe_cardinal)
            advise (NULLCP, "warning: extra or duplicate members present in SET");
    }

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Content__Attributes (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p86_count = 0;
    register PE p86;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Content-Attributes");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Content-Attributes bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Content-Attributes bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p86 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Content-Attributes bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p86;

    if (p86 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p86, "document-size");
#endif

        if (prim2num (p86) == NOTOK
                && p86 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "document-size bad integer: %s",
                    pe_error (p86 -> pe_errno));
            return NOTOK;
        }
        p86_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p86 = set_find (pe, PE_CLASS_CONT, 2)) {
#ifdef DEBUG
        (void) testdebug (p86, "number-of-pages");
#endif

        if (prim2num (p86) == NOTOK
                && p86 -> pe_errno != PE_ERR_NONE) {
            advise (NULLCP, "number-of-pages bad integer: %s",
                    pe_error (p86 -> pe_errno));
            return NOTOK;
        }
        p86_count ++;
    }
    else {
        /* set default here using yp -> yp_default */
    }

    if (p86 = set_find (pe, PE_CLASS_CONT, 4)) {
        register PE p87;

#ifdef DEBUG
        (void) testdebug (p86, "languages");
#endif

        if ((p87 = prim2set (p86)) == NULLPE) {
            advise (NULLCP, "languages bad set: %s",
                    pe_error (p86 -> pe_errno));
            return NOTOK;
        }
        p86 = p87;

        for (p87 = first_member (p86); p87; p87 = next_member (p86, p87)) {
#ifdef DEBUG
            (void) testdebug (p87, "member");
#endif

            if (parse_ISRD2_Character__Data (p87, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p86_count ++;
    }
    if (p86_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}

/* ARGSUSED */

int	parse_ISRD2_Security__Information (pe, explicit, len, buffer, parm)
register PE	pe;
int	explicit;
int    *len;
char  **buffer;
PEPYPARM parm;
{
    int p88_count = 0;
    register PE p88;

#ifdef DEBUG
    (void) testdebug (pe, "ISRD2.Security-Information");
#endif

    if (explicit) {
        if (pe -> pe_class != PE_CLASS_UNIV
                || pe -> pe_form != PE_FORM_CONS
                || pe -> pe_id != PE_CONS_SET) {
            advise (NULLCP, "Security-Information bad class/form/id: %s/%d/0x%x",
                    pe_classlist[pe -> pe_class], pe -> pe_form, pe -> pe_id);
            return NOTOK;
        }
    }
    else
        if (pe -> pe_form != PE_FORM_CONS) {
            advise (NULLCP, "Security-Information bad form: %d", pe -> pe_form);
            return NOTOK;
        }

    if ((p88 = prim2set (pe)) == NULLPE) {
        advise (NULLCP, "Security-Information bad set: %s",
                pe_error (pe -> pe_errno));
        return NOTOK;
    }
    pe = p88;

    if ( (p88 = set_find (pe, PE_CLASS_CONT, 0))
        || (p88 = set_find (pe, PE_CLASS_CONT, 4)) ) {
#ifdef DEBUG
        (void) testdebug (p88, "authorization");
#endif

        switch (PE_ID (p88 -> pe_class, p88 -> pe_id)) {
            case PE_ID (PE_CLASS_CONT, 0):	/* person */
                {
#ifdef DEBUG
                    (void) testdebug (p88, "person");
#endif

                    if (parse_ISRD2_Personal__Name (p88, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;
            case PE_ID (PE_CLASS_CONT, 4):	/* organization */
                {
#ifdef DEBUG
                    (void) testdebug (p88, "organization");
#endif

                    if (parse_ISRD2_Character__Data (p88, 0, NULLIP, NULLVP, NullParm) == NOTOK)
                        return NOTOK;
                }
                break;

            default:
                advise (NULLCP, "authorization has unknown choice: %s/%d/0x%x",
                        pe_classlist[p88 -> pe_class], p88 -> pe_form, p88 -> pe_id);
                return NOTOK;
        }
        p88_count ++;
    }
    if (p88 = set_find (pe, PE_CLASS_CONT, 1)) {
#ifdef DEBUG
        (void) testdebug (p88, "security-classification");
#endif

        if (parse_ISRD2_Character__Data (p88, 0, NULLIP, NULLVP, NullParm) == NOTOK)
            return NOTOK;
        p88_count ++;
    }
    if (p88 = set_find (pe, PE_CLASS_CONT, 2)) {
        register PE p89;

#ifdef DEBUG
        (void) testdebug (p88, "access-rights");
#endif

        if ((p89 = prim2set (p88)) == NULLPE) {
            advise (NULLCP, "access-rights bad set: %s",
                    pe_error (p88 -> pe_errno));
            return NOTOK;
        }
        p88 = p89;

        for (p89 = first_member (p88); p89; p89 = next_member (p88, p89)) {
#ifdef DEBUG
            (void) testdebug (p89, "member");
#endif

            if (parse_ISRD2_Character__Data (p89, 1, NULLIP, NULLVP, NullParm) == NOTOK)
                return NOTOK;
        }
        p88_count ++;
    }
    if (p88_count != pe -> pe_cardinal)
        advise (NULLCP, "warning: extra or duplicate members present in SET");

    return OK;
}
